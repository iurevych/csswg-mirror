<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>CSS Image Values and Replaced Content Module Level 3</title>
  <link rel="stylesheet" type="text/css" href="../default.css">
  <link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/W3C-ED">
  <style>
  p { margin: .5em 0; }
  </style>
</head>

<body>

<div class="head">
<!--logo-->

<h1>CSS Image Values and Replaced Content Module Level 3</h1>

<h2 class="no-num no-toc">[LONGSTATUS] [DATE]</h2>
<dl>
  <dt>This version:</dt>
    <!-- <dd><a href="http://www.w3.org/TR/[YEAR]/CR-css3-images-[CDATE]/">http://www.w3.org/TR/[YEAR]/CR-css3-images-[CDATE]/</a></dd> -->
    <dd><a href="http://dev.w3.org/csswg/css3-images/">http://dev.w3.org/csswg/css3-images/</a>
  <!-- <dt>Latest version:</dt>
    <dd><a href="http://www.w3.org/TR/css3-images/">http://www.w3.org/TR/css3-images/</a></dd>
  <dt>Previous version:</dt>
    <dd><a href="http://www.w3.org/TR/2008/CR-css3-namespace-20080523/">http://www.w3.org/TR/2008/CR-css3-namespace-20080523/</a></dd> -->
  <dt>Editor:</dt>
    <dd><a href="http://fantasai.inkedblade.net/contact">Elika J. Etemad</a></dd>
    <dd><a href="http://www.xanthir.com/contact">Tab Atkins Jr.</a></dd>
</dl>
<!--begin-copyright-->
<p>[Here will be included the file "../copyright.inc"]</p>
<!--end-copyright-->

<hr title="Separator for header">
</div>

<h2 class="no-num no-toc" id="abstract">Abstract</h2>

  <p>This CSS Image Values and Replaced Content module has two parts:
    First, it defines the syntax for &lt;image&gt; values in CSS.
    &lt;image&gt; values can be a single URI to an image, a list of
    URIs denoting a series of fallbacks, or
    gradients. Second, it defines properties used to control the
    interaction of replaced content and the CSS layout algorithms.
    These properties can affect the used image resolution for bitmaps,
    the replaced object's orientation, and whether and how to preserve
    the object's aspect ratio.</p>

<h2 class="no-num no-toc" id="status">Status of this document</h2>
<!--status-->

<h2 class="no-num no-toc" id="contents">Table of contents</h2>
<!--toc-->

<div>
  <h2 id="intro">Introduction</h2>

  <p><em>This section is non-normative.</em></p>

  <p>In CSS Levels 1 and 2, image values, such as those used in the
    'background-image' property, could only be given by a single URI
    value. This module introduces additional notations that allow a
    2D image to be given as a list of URIs denoting fallbacks, as a
    slice of a larger image (sprite), and as a gradient.</p>
</div>

<div>
  <h2 id="conformance">Conformance</h2>

  <p>A document or implementation cannot conform to CSS Image Values Level 3
    alone, but can claim conformance to CSS Image Values Level 3 if it satisfies
    the conformance requirements in this specification when implementing CSS or
    another host language that normatively references this specification.</p>

  <p>Conformance to CSS Namespaces is defined for two classes:
  <dl>
    <dt><dfn>style sheet</dfn></dt>
      <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS style
        sheet</a> (or a complete unit of another host language that normatively
        references CSS Namespaces).
    <dt><dfn>interpreter</dfn></dt>
      <dd>Someone or something that interprets the semantics of a style sheet.
        (CSS <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">user
        agents</a> fall under this category.)</dd>
  </dl>

  <p>The conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification. All of the text of this specification is
    normative except sections explicitly marked as non-normative, examples,
    and notes. [[!RFC2119]]</p>

  <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

  <div class="example">
    <p>This is an example of an informative example.</p>
  </div>

  <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this:

  <p class="note">Note, this is an informative note.</p>
</div>

<div>
  <h2>Resolution Units: the &lt;resolution&gt; value type</h2>

  <p>This specification defines the following units as part of the
    <dfn>&lt;resolution&gt;</dfn> value type:

  <dl>
    <dt>dpi <dd>dots per inch

    <dt>dpcm <dd>dots per centimeter

    <dt>dppx <dd>dots per ''px'' unit
  </dl>

  <p class="note">The default resolution of raster images in CSS is ''1dppx''.</p>
</div>

<div>
  <h2 id="image">Image Values: the &lt;image&gt; value type</h2>

  <p>The &lt;image&gt; value type denotes a 2D image. It is defined as

  <pre class="prod"><dfn>&lt;image&gt;</dfn> = &lt;url&gt; | &lt;image-list&gt; | &lt;gradient&gt;</pre>

  <p>Image values can be used in many CSS properties, including the
    'background-image', 'list-style-image', 'cursor' properties [[!CSS21]].

<div>
  <h3 id="url">Image References and Image Slices: the ''url()'' notation</h3>

  <p>The simplest way to indicate an image is to reference an image file
  by URI. This is done with the
  <a href="http://www.w3.org/TR/CSS21/syndata.html#uri">''url()'' notation</a>,
  defined in [[!CSS21]].

  <div class="example">
    <p>In the example below, a background image is specified with ''url()''
    syntax:</p>
    <pre>background-image: url(wavy.png);</pre>
  </div>

  <p>A portion of an image may be referenced (clipped out and used as a
  standalone image) by use of fragment identifiers.
  <span class='issue'>Need a spec to reference here. Expecting to get one from
    <a href="http://www.w3.org/2008/WebVideo/Fragments/">Media Fragments WG</a>.</span>

  <div class="example">
    <p>For example,</p>
    <pre>background-image: url('logos.png#xywh=10,30,60,20')</pre>
    <p>uses the 60 pixel by 20 pixel rectangle of <code>logos.png</code> beginning
    at the point 10 pixels in from the left, 30 pixels down from the top.

    <p class="note">Note that quotation marks are required here, because
    unquoted commas are not allowed in ''url()'' syntax.</p>
  </div>
</div>

<div>
  <h3 id="image-notation">Image Fallbacks: the ''image()'' notation</h3>

  <p>The ''image()'' notation allows an author to specify multiple images,
  each one a fallback for the previous. The UA must use only the first image
  that it can load and display. The syntax for ''image()'' is defined as

  <pre class="prod"><dfn>&lt;image-list&gt;</dfn> = <!--
     -->image( [ &lt;image-decl&gt; , ]* [ &lt;image-decl&gt; | &lt;color> | &lt;gradient> ] )</pre>

  <p>where &lt;image-decl&gt; is given by

  <pre class="prod"><dfn>&lt;image-decl&gt;</dfn> = <!--
    -->[ &lt;string&gt; | &lt;url-token&gt; ] [ snap? &amp;&amp; &lt;resolution&gt; ]?</pre>

  <p>&lt;url-token&gt; is given as <code>[!#$%&amp;*-~]|{nonascii}|{escape}</code>
  (i.e. the contents of ''url()'') using the productions in the
  <a href="http://www.w3.org/TR/CSS21/syndata.html#tokenization">CSS2.1 tokenization</a>.
  <strong>The &lt;url-token&gt; must not contain unescaped brackets, commas,
  white space characters, single quotes (&#39;) or double quotes (&quot;);
  if it does the ''image()'' containing it is invalid.</strong>

  <p>Each string or url-token represents the URI of an image. If a resolution
  is given, then the image must be rendered at the specified resolution. If the
  ''snap'' keyword is also specified, and the image is a raster image, then the
  image must be rendered at the resolution closest to the specified resolution
  that would result in no pixel rounding. <span class="issue">I don't think
  "no pixel rounding" is the right terminology here... basically we want to
  avoid blurry images.</span></p>

  <p>The optional color at the end of the list is the <dfn>fallback color</dfn>.
  It is used if, and only if, none of the images can be loaded and displayed
  (e.g. because they are in unsupported formats, or cannot be found, or are
  corrupted in some way, or because image loading is disabled in the UA). It
  is treated as a single-color image with no intrinsic dimensions.

  <div class="example">
    <p>For example, the rule below would tell the UA to load ''wavy.svg'' if
      it can; failing that to load ''wavy.png'' and display it at 150dpi;
      failing that to display ''wavy.gif''; and finally, if none of the images
      can be loaded and displayed, to use the color ''blue'' to create a
      dimensionless background image.
      <pre>background-image: image(wavy.svg, 'wavy.png' 150dpi, "wavy.gif", blue);</pre>
    <p>The 'background-image' property specifies that dimensionless images
       must stretch to cover the entire background positioning area
       [[CSS3BG]], so if none of the specified images can be displayed
       the background will be painted blue. As with any image, this fallback
       will be painted over the 'background-color' (if any).
  </div>

  <p>If the URL for the image ends in a file extension (a period followed by
  letters) of four ascii letters ([a-zA-Z]) or less, then the UA <em>may</em>
  skip trying to load images whose file extension matches an image format it
  knows it does not support. For example, a UA that knows it supports JPEG and
  GIF, but expects to encounter many PNG and SVG images may choose to skip over
  images with filenames ending in '.png' or '.svg' without loading them to
  check their MIME type. However it must not skip over images with filenames
  ending in extensions it doesn't recognize.
</div>
</div>

<div>
	<h2 id="gradients">Gradients</h2>
	<p>A gradient is an image that smoothly fades from one color to another.  These are commonly used for subtle shading in background images, buttons, and many other things.  The two functions described in this section allow an author to specify such an image in a terse syntax, so that the UA can generate the image automatically when rendering the page.  Gradients are a type of image, and can be used anywhere an image can, such as in the <code>background-image</code> or <code>list-style-image</code> properties.  For official purposes, the syntax of a <code>&lt;gradient></code> is: </p>
	<pre class=prod><dfn>&lt;gradient></dfn> = [ &lt;linear-gradient> | &lt;radial-gradient> ]</pre>
	<p>where <code>&lt;linear-gradient></code> and <code>&lt;radial-gradient></code> are defined in their applicable sections below.</p>
	<div class=example>
		<p>As with the other &lt;image&gt; types defined in this specification, gradients can be used in any property that accepts images.  For example:</p>
		<ul>
			<li><code>background: linear-gradient(white, gray);</code></li>
			<li><code>list-style-image: radial-gradient(circle, #006, #00a 90%, #0000af 100%, white 100%)</code></li>
		</ul>
	</div>
	<p class=note>In many places this section references a box, such as "the box's top-left corner" or "the box's right side".  In all of these circumstances, the "box" refers to the 'CSS View Box' (see the "View Boxes" section of this spec for clarification).  A gradient's 'Image View Box' has no intrinsic dimensions.  This means that, for example, if you use a gradient in a background-image, the "box" will simply be the size of the background area.  If you use a gradient in a list-style-image, the "box" will be a 1em square.</p>

	<div>
		<h3 id=linear-gradients>Linear Gradients</h3>
		<p>A linear gradient is created by specifying a gradient-line and then several colors placed along that line.  The image is constructed by creating an infinite canvas and painting it with lines perdendicular to the gradient-line, with the color of the painted line being the color of the gradient-line where the two intersect.  This produces a smooth fade from each color to the next, progressing in the specified direction.</p>
		<div>
			<h4 class=no-toc><code>linear-gradient()</code> syntax</h4>
			<pre class=prod><code><dfn>&lt;linear-gradient></dfn> = linear-gradient(
	[ 
		[ [top | bottom] || [left | right] ] 
		|| 
		&lt;angle>
	,]? 
	&lt;color-stop&gt;[, &lt;color-stop&gt;]+
);</code></pre>
			<p>The first argument to the function specifies the <strong>gradient-line</strong>, which gives the gradient a direction and determines how color-stops are positioned.  It may be omitted; if so, it defaults to "<code>top</code>".</p>
			<p>The gradient-line may be specified in two different ways.  The first is by specifying the angle the gradient-line should assume; this uses the standard algebraic notation for angles where 0deg points to the right, 90deg points up, and positive angles go counterclockwise.  The starting-point and ending-point of the gradient-line are determined by extending a line in both direction from the center of the box at the angle specified.  In the direction of the angle, the ending-point is the point on the gradient-line line where a line drawn perpendicular to the gradient-line would intersect the corner of the box in that direction.  The starting-point is determined identically, except in the opposite direction of the angle.</p>
			<p>The second way is to simply provide a side or corner of the box that the gradient should start at; the gradient will then automatically angle itself to extend from the specified side or corner to the opposite side or corner in a straight line.  To be precise, the gradient is converted to the angle form described in the previous paragraph at used-value time.  If a <code>left</code>, <code>bottom</code>, <code>right</code>, or <code>top</code> is given, the used value of the gradient is 0deg, 90deg, 180deg, or 270 deg, respectively.  If a corner is given, the used value of the gradient is the angle necessary to place the starting-point of the gradient in that corner of the box.</p>
			<div class=example>
				<div style="overflow: hidden">
					<img style="float: right; margin-left: 1em;" src='gradient-diagram.png' alt="[An image showing a box with a background shading gradually from white in the bottom-left corner to black in the top-right corner.  There is a line, illustrating the gradient-line, angled at 45 degrees and passing through the center of the box.  The starting-point and ending-point of the gradient-line are indicated by the intersection of the gradient-line with two additional lines that pass through the bottom-left and top-right corners of the box.]">
					<p>This example illustrates visually how to calculate the gradient-line from the rules above.  This shows the starting and ending-point of the gradient-line, along with the actual gradient, produced by an element with ''background: linear-gradient(45deg, white, black);''.</p>
					<p>Notice how, though the starting-point and ending-point are outside of the box, they're positioned precisely right so that the gradient is pure white <em>exactly</em> at the corner, and pure black <em>exactly</em> at the opposite corner.  That's intentional, and will always be true for linear gradients.</p>
				</div>
			</div>
			<p>The gradient's color stops are typically placed between the starting-point and ending-point on the gradient-line, but this isn't required - the gradient-line extends infinitely in both directions.  The starting-point and ending-point are merely arbitrary distance markers - the starting-point defines where 0%, 0px, etc are located when specifying color-stops, and the ending-point defines where 100% is located.  Color stops are allowed to have positions before 0% or after 100%.</p>
		</div>
	
		<h4 class=no-toc>Linear Gradient Examples</h4>
	
		<p>All of the following <code>linear-gradient()</code> examples are presumed to be backgrounds applied to a box that is 200px wide and 100px tall.</p>
		<div class=example>	
			<p>Below are various ways of specifying a basic vertical gradient:</p>
		
			<pre><code>linear-gradient(yellow, blue);
linear-gradient(top, yellow, blue);
linear-gradient(bottom, blue, yellow);
linear-gradient(-90deg, yellow, blue);
linear-gradient(270deg, yellow, blue);
linear-gradient(top, yellow 0%, blue 100%);</code></pre>
			<p><img src="linear1.png" alt="" ></p>
		</div>
		<div class=example>	
			<p>This gradient goes from the upper-left to the lower-right corner.</p>
		
			<pre><code>linear-gradient(top left, yellow, blue);</code></pre>
			<p><img src="linear2.png" alt="" ></p>
		</div>
		<div class=example>	
			<p>This demonstrates the use of an angle in the gradient.  Compare this image with the previous example.  In both gradients, the top-left of the box is pure yellow, and the bottom-right of the box is pure blue.  The difference is in the angle that the gradient follows.</p>
		
			<pre><code>linear-gradient(-45deg, yellow, blue);
linear-gradient(315deg, yellow, blue);</code></pre>
			<p><img src="linear3.png" alt="" ></p>
		</div>
		<div class=example>	
			<p>This demonstrates a 3-color gradient, and how to specify the location of a stop explicitly:</p>
		
			<pre><code>linear-gradient(yellow, blue 20%, #0f0);</code></pre>
			<p><img src="linear4.png" alt="" ></p>
		</div>
	</div>

	<div>
		<h3 id=radial-gradients>Radial Gradients</h3>
		<p>In a radial gradient, rather than colors smoothly fading from one side of the box to the other as with linear gradients, they instead emerge from a single point and smoothly spread outward in a circular or elliptical shape.</p>
		<p>A radial gradient is specified by first pinpointing the center of the gradient, where the 0% ellipse will be, then specifying the size and shape of the 100% ellipse, ending with a list of color-stops just like a linear-gradient.  Between the center and the ending-ellipse, and past the ending-ellipse, concentric ellipses are drawn and colored according to the specified color-stops.</p>

		<h4 class=no-toc><code>radial-gradient()</code> Syntax</h4>
		<pre class=prod><code><dfn>&lt;radial-gradient></dfn> = radial-gradient(
	[&lt;bg-position&gt;,]? 
	[
		[&lt;shape&gt; || &lt;size&gt;]
		|
		[&lt;length> | &lt;percentage>]{2}
	,]? 
	&lt;color-stop&gt;[, &lt;color-stop&gt;]+
)</code></pre>
		<p>The first argument to the function specifies the center of the ellipse.  <code>&lt;bg-position&gt;</code> is taken from the Backgrounds and Borders Module, and has the same definition.  It specifies the center of the gradient.  If omitted, it defaults to <code>center</code>.  Color-stop positions are measured along an imaginary line extending from the center of the gradient to the right.</p>
		<p>The second argument to the function specifies the size and shape of the ending-ellipse.  This can be specified in two ways, with different characteristics:</p>
		<dl>
			<dt>Implicitly</dt>
			<dd>
				<p>The size and shape of the ending-ellipse can be defined <em>implicitly</em> with a size and shape keyword.  The <code>&lt;shape></code> is defined as </p>
				<pre><code><dfn>&lt;shape></dfn> = [ circle | ellipse ]</code></pre>
				<p><code>circle</code> indicates that the ending-ellipse will be a circle with a constant radius.  <code>ellipse</code> indicates that the gradient-shape will be an axis-aligned ellipse (that is, its major and minor radiuses will be horizontal and vertical, not necessarily in that order).</p>
				<p>The <code>&lt;size></code>keyword is defined as </p>
				<pre><code><dfn>&lt;size></dfn> = [ closest-side | closest-corner | farthest-side | farthest-corner | contain | cover ]</code></pre>
				<p>If <code>&lt;shape&gt;</code> is <code>circle</code> and <code>&lt;size&gt;</code> is <code>closest-side</code>, the ending-shape is a circle sized so that it exactly meets the side of the box closest to its center.  For example, if the box was 100px wide and 200px tall, and the starting-point of the gradient-line was <code>'10% 10%'</code>, then the closest side is the left side of the box (it is 10px from the starting-point, while the top is 20px from it, and the right and bottom sides are much further).  The gradient-shape would be a circle with a radius of 10px.  If <code>&lt;shape&gt;</code> is <code>ellipse</code> and <code>&lt;size&gt;</code> is <code>closest-side</code>, the gradient-shape is an ellipse sized so that it exactly meets the vertical and horizontal sides of the box closest to its center.  Using the same box and starting-point as the previous example, the gradient-shape would be an ellipse with a 20px vertical radius and a 10px horizontal radius.  (If necessary, such as if the starting-point is outside of the box, extend the sides of the box so that there is a line the ellipse can meet.)</p>
				<p><code>farthest-side</code> is identical to <code>closest-side</code>, except that the gradient-shape is sized to meet the side of the box that is farthest from its center (or the farthest vertical and horizontal sides, in the case of <code>ellipse</code>).  <code>closest-corner</code> and <code>farthest-corner</code> size the gradient-shape so that it exactly meets the closest or farthest corner of the box from its center, respectively.  If <code>&lt;shape&gt;</code> is <code>ellipse</code>, the gradient-shape has the same ratio of width to height that it would if <code>closest-side</code> or <code>farthest-side</code> were specified, as appropriate.  <code>contain</code> is a synonym for <code>closest-side</code>, and <code>cover</code> is a synonym for <code>farthest-corner</code>.</p>
				<p>If this implicit form is used, then it is converted to an equivalent explicit form (described below) at used-value time.</p>
			</dd>
			<dt>Explicitly</dt>
			<dd>
				<p>Alternately, the ending-shape's size and shape can be defined explicitly, by providing two lengths or percentages.  These measure the length of the horizontal and vertical axes of the ellipse, respectively.  (The axis length is the length from the center of the ellipse to the edge, similar to the radius of a circle, not the diameter.)</p>
				<p>Percentages used in the first value are relative to the width of the box, while percentages used in the second value are relative to the height of the box.</p>
				<p>Both of the values must be positive - specifying either as zero or negative is a syntax error.</p>
			</dd>
		</dt>
		<p>If this argument is omitted, it defaults to <code>ellipse cover</code>.</p>
		<p>In certain circumstances the given parameters may define a degenerate shape - a circle or ellipse with a radius of 0. In these instances the gradient image is just a solid color equal to the color of the last color-stop in the rule.  The following combinations of values will trigger this: <code>closest-side</code> if the starting-point is on a box edge, <code>closest-corner</code> if the starting-point is on a box corner, and <code>ellipse</code> and <code>closest-corner</code> if the starting-point is on a box edge.</p>
		<p>The ending-point of the gradient-line is determined by extending a line from the starting-point in the direction specified by the <code>&lt;angle&gt;</code> in the first argument.  The ending-point is where this line intersects the gradient-shape.</p>
		<p><code>&lt;color-stop&gt;</code> is defined identically to its treatment in <code>linear-gradient()</code>.  Color-stops are placed on an imaginary line extending from the center of the gradient, with the 0% point at the center of the gradient, and 100% at the point where the line intersects the ending-ellipse.  The color of each ellipse is equal to the color of the line where the ellipse intersects it.  Distances past 100% can be specified, and simply indicate a color-stop placed on the line a corresponding distance from the center.  Negative distances are allowed in a radial gradient and work the same as in linear gradients with respect to setting the color of the gradient-line, but colors before the starting-point of the gradient-line are not displayed.  For example, <code>radial-gradient(red -50px, yellow 100px)</code> would produce an elliptical gradient which starts with a reddish-orange color in the center (the color 1/3 between red and yellow) and transitions to yellow at 100px wide.</p>
	
		<h4 class=no-toc>Radial Gradient Examples</h4>
	
		<p>All of the following examples are applied to a box that is 200px wide and 100px tall.</p>
		<div class=example>	
			<p>These examples demonstrate the basic syntax for radial gradients:</p>
		
			<pre><code>radial-gradient(yellow, green);
radial-gradient(center, ellipse cover, yellow 0%, green 100%);
radial-gradient(50% 50%, farthest-corner, yellow, green);</code></pre>
			<p><img src="radial1.png" alt="" ></p>
		
			<pre><code>radial-gradient(circle, yellow, green);</code></pre>
			<p><img src="radial2.png" alt="" ></p>
		
			<pre><code>radial-gradient(red, yellow, green);</code></pre>
			<p><img src="radial3.png" alt="" ></p>
		</div>
		<div class=example>	
			<p>This image shows a gradient originating from somewhere other than the center of the box:</p>
		
			<pre><code>radial-gradient(bottom left, farthest-side, red, yellow 50px, green);</code></pre>
			<p><img src="radial4.png" alt="" ></p>
		</div>
		<div class=example>	
			<p>Here we illustrate a 'contain' gradient.</p>
		
			<pre><code>radial-gradient(20px 30px, contain, red, yellow, green);
radial-gradient(20px 30px, 20px 30px, red, yellow, green);</code></pre>
			<p><img src="radial6.png" alt="" ></p>
		
			<pre><code>radial-gradient(20px 30px, circle contain, red, yellow, green);
radial-gradient(20px 30px, 20px 20px, red, yellow, green);</code></pre>
			<p><img src="radial7.png" alt="" ></p>
		</div>
	</div>
<!-- Removed for lack of a use-case; we'll just leave it as a vendor-prefix for now.
		<div>
		<h3>Repeating Gradients</h3>
	
		<p>In addition to the <code>linear-gradient()</code> and <code>radial-gradient()</code> functions, this specification defines <code>repeating-linear-gradient()</code> and <code>repeating-radial-gradient()</code> functions.  These two functions take the same values and are interpreted the same as their respective non-repeating siblings defined previously.  However, the color-stops are repeated infinitely in both directions, with their positions shifted by multiples of the difference between the last color-stop's position and the first color-stop's position.  For example, <code>repeating-linear-gradient(red 10px, blue 50px)</code> is equivalent to <code>linear-gradient(..., red -30px, blue 10px, red 10px, blue 50px, red 50px, blue 90px, ...)</code>.  Note that the last color-stop and first color-stop will always coincide at the boundaries of each group, which may produce sharp transitions if the gradient does not start and end with the same color.</p>

		<div class=example>
			<p>Repeating gradient syntax is basically identical to that of non-repeating gradients:</p>

			<pre><code>repeating-linear-gradient(red, blue 20px, red 40px)</code></pre>
			<p><img src="repeating1.png" alt=""></p>

			<pre><code>repeating-radial-gradient(red, blue 20px, red 40px)</code></pre>
			<p><img src="repeating2.png" alt=""></p>

			<pre><code>repeating-radial-gradient(20px 30px, circle contain, red, yellow, green 100%, yellow 150%, red 200%)</code></pre>
			<p><img src="repeating3.png" alt=""></p>
		</div>

		<p>If the difference in the first and last color-stops is 0 (for example, in the rule <code>linear-gradient(red 10px, blue 10px)</code>), the gradient defines a solid-color image with the color of the last color-stop in the rule (in this case, then, it would simply define a blue image).</p>
	</div>
-->


	<div>
		<h3 id=color-stop-syntax><code>color-stop</code> Syntax</h3>
		<p>The <dfn><code>&lt;color-stop&gt;</code></dfn> stands for:</p>
		<pre class=prod><code>&lt;color&gt; [ &lt;percentage&gt; | &lt;length&gt; ]?</code></pre>
		<p>Color-stops are points placed along the line defined by the gradient-line at the beginning of the rule.  Color-stops must be specified in order.  Percentages refer to the length of the gradient-line, with 0% being at the starting point and 100% being at the ending point.  Lengths are measured from the starting-point in the direction of the ending-point.  Color-stops are usually placed between the starting-point and ending-point, but that's not required; the gradient-line extends infinitely in both directions, and a color-stop can be placed at any position on the line.</p>
		<p>At each color-stop, the line is the color of the color-stop.  Between two color-stops, the line's color is linearly interpolated between the colors of the two color-stops, with the interpolation taking place in premultiplied RGBA space.  Before the first color-stop, the line is the color of the first color-stop.  After the last color-stop, the line is the color of the last color-stop.</p>
		<p>The following steps must be applied <em>in order</em> to process the list of color-stops.  After applying these rules, all color-stops will have a definite position and they will be in ascending order:</p>
		<ol>
			<li>If the first color-stop does not have a position, its position defaults to 0%. If the last color-stop does not have a position, its position defaults to 100%.</li>
			<li>If a color-stop has a position that is less than the specified position of any color-stop before it in the list, its position is changed to be equal to the largest specified position of any color-stop before it.</li>
			<li>If any color-stop still does not have a position, then, for each run of adjacent color-stops without positions, set their positions so that they are evenly spaced between the preceding and following color-stops with positions.</li>
		</ol>
		<p>If multiple color-stops have the same position, they produce an infinitesimal transition from the one specified first in the rule to the one specified last.  In effect, the color suddenly changes at that position rather than smoothly transitioning.</p>
		<p class=note>It is recommended that authors not mix different types of units, such as px, em, or %, in a single rule, as this can cause a color-stop to unintentionally try to move before an earlier one.  For example, the rule <code>background-image: linear-gradient(red, yellow 100px, blue 50%)</code> would work as expected as long as the background area is at least 200px tall.  If it was 150px tall, however, the blue color-stop's position would be equivalent to "75px", which precedes the yellow color-stop, and would be corrected to a position of 100px.</p>
	</div>

	<div>
		<h3 id="interpolating-gradients">Interpolating Gradients</h3>
		<p>Gradient images can be interpolated directly in CSS transitions and animations, smoothly animating from one gradient to another.  There are only a few restrictions on what gradients are allowed to be interpolated:</p>
		<ol>
			<li>Both the starting and ending gradient must be of the same type; either both linear gradients or both radial gradients.</li>
			<li>Both the starting and ending gradient must have the same number of color-stops.  (Remember, you can always pad a gradient with additional color-stops placed atop each other if you need to play with the number of color-stops.)
		</ol>
		<p>If the two gradients satisfy both of those constraints, they must be interpolated as described below.  If not, they must be interpolated the same as images in general.</p>
		<p>To interpolate two gradients, first convert each to their used value.  This ensures that linear gradients have their direction specified as an angle, and radial gradients have their size and shape specified as two lengths.  Then, interpolate each component of the gradient independently as specified by the interpolation function being used.  For linear gradients, the angle and the color-stops are the only components.  For radial gradients, the components are the horizontal position of the center, the vertical position of the center, the horizontal axis length, the vertical axis length, and the color-stops.  Interpolating color-stops is described in the next paragraph; all the other components already have defined interpolation rules given in the CSS Transitions spec.</p>
		<p>To interpolate color-stops, first match up each color-stop in the starting gradient to its corresponding color-stop in the ending gradient (as color stops are guaranteed to be ordered, this matching is unique and well-defined).  Then, interpolate the position and color of each color-stop independently as specified by the interpolationg function being used.</p>
</div>

<div>
	<h2 id="sizing">Sizing Images and Objects in CSS</h2>

	<p>Images used in CSS may come from a number of sources, from defined image formats (such as gif, jpeg, etc), dedicated markup formats (such as SVG), and CSS-specific formats (such as the linear-gradient() value type defined in this specification).  As well, a document may contain many other types of objects, such as video, plugins, or nested documents.  These images and objects (just "objects" hereafter) may offer many types of sizing information to CSS, or none at all.  This section defines generically the size negotiation model between the image or replaced content object and the CSS layout algorithms.</p>

	<p>In order to define this handling, we must define a few terms, to make it easier to refer to various concepts:</p>
	<dl>
		<dt><dfn>intrinsic dimensions</dfn></dt>
		<dd>The intrinsic dimensions are defined are the object's preferred, natural size or aspect ratio, if any. There can be an <dfn>intrinsic height</dfn> and <dfn>intrinsic width</dfn>, defining a definite rectangle. (Most bitmap images fall into this category.) There can be an <dfn>intrinsic aspect ratio</dfn> defining the relation of the width to the height, but no definite size. (SVG images designed to scale may fall into this category.) There can be just an intrinsic height or width. Or there can be no intrinsic dimensions at all, implying that the object has no preferred size or aspect ratio. (Embedded documents are often assumed to have no intrinsic size, as are CSS gradients, defined in this specification.)
<p>If an object (such as an icon) has multiple sizes, then the largest size is used. If it has multiple aspect ratios of that size (or of no size), then the aspect ratio closest to the aspect ratio of the default image sizing area is use <span class="issue">This is pretty arbitrary</span>.</p></dd>
		<dt><dfn>specified size</dfn></dt>
		<dd>The specified size of an object is given by CSS, such as through the `object-fit` or `background-size` properties. The specified size can be a definite width and height, a set of constraints, or a combination thereof.</dd>
		<dt><dfn>CSS View Box</dfn></dt>
		<dd>The CSS View Box is the result of transforming the intrinsic dimensions into a concrete size, based on the specified size and the default image sizing area.  A CSS View Box always has a definite height and width.</dd>
		<dt><dfn>default image sizing area</dfn></dt>
		<dd>The default image sizing area is a rectangle with a definite height and width used to determine the size of the CSS View Box when both the intrinsic dimensions and specified size are missing dimensions.</dd>
	</dl>

	<p>Images and objects in CSS are sized as follows:</p>
	<ol>
		<li>When an image or object is specified in a document, such as through url() value in a background-image property or a @src attribute on an &lt;img> element, CSS queries the object for its intrinsic size.</li>
		<li>Using the intrinsic dimensions and the specified size, CSS then computes a CSS View Box that defines the size of the region the object will render in, as follows:
			<ol>
				<li>If the specified size is just a definite width and height, the CSS View Box must be that width and height.</li>
				<li>If the specified size is just a definite width or just a definite height, then the CSS View Box must have the same width or height, as appropriate.  The other dimension is calculated as follows:
					<ol>
						<li>If the object has an intrinsic aspect ratio, the CSS View Box must have the same aspect ratio..</li>
						<li>Otherwise, if the object has an an intrinsic height or intrinsic width (whichever is missing from the specified size), then the CSS View Box must have that height or width.</li>
						<li>Otherwise, the CSS View Box must have the same width or height (whichever is missing from the specified size) as the default image sizing area.</li>
					</ol>
				</li>
				<li>If the specified size is neither a definite width nor height, and has no additional contraints, the dimensions of the CSS View Box must be computed as follows:
					<ol>
						<li>If the object has an intrinsic width and an intrinsic height, the CSS View Box must have that same height and width.</li>
						<li>If the object has only an intrinsic width or intrinsic height, and no intrinsic aspect ratio, the CSS View Box must have that height or width, and the width or height (whichever is missing from the intrinsic dimensions) of the default image sizing area.</li>
						<li>If the object has only an intrinsic aspect ratio, the CSS View Box must have that aspect ratio, and additionally be as large as possible without either its height or width exceeding the height or width of the default image sizing area.</li>
						<li>Otherwise, the CSS View Box must be the size of the default image sizing area.</li>
					</ol>
				</li>
				<li>If the specified size has additional constraints, the CSS View Box must be sized to satisfy those constraints.  (For example, object-fit:contain specifies slightly more complex handling for sizing replaced elements, and background-repeat:round can adjust the size specified in background-size so that the image fits an even number of times into the background positioning area.)</li>
			</ol>
		</li>
	</ol>
	<p>After determining the size of the CSS View Box, CSS positions it within the appropriate area according to any relevant properties, such as object-position or background-position, and asks the object to render itself using the dimensions of the CSS View Box.  CSS does not define how objects render when the dimensions of the CSS View Box are different than the object's intrinsic dimensions.  The object may adjust itself to match the dimensions of the CSS View Box in some way, or even render itself larger or smaller than the CSS View Box to satisfy sizing constraints of its own.</p>

<!-- copied from GCPM -->
<h3 id="image-resolution">Overriding Image Resolutions: the 'image-resolution' property</h3>

<p>The <dfn>image resolution</dfn> is defined as the number of image
pixels per unit length, e.g., pixels per inch. Some image formats can
record information about the resolution of images. This information
can be helpful when determining the actual size of the image in the
formatting process. However, the information can also be wrong, in
which case it should be ignored. By default, CSS assumes a resolution
of one image pixel per CSS ''px'' unit; however, the 'image-resolution'
property allows using some other resolution.

<table class="propdef">
  <tr>
    <th>Name:
    <td><dfn>image-resolution</dfn>
  <tr>
    <th>Value:
    <td>from-image || &lt;dpi>
  <tr>
    <th>Initial:
    <td>''1dppx''
  <tr>
    <th>Applies to:
    <td>replaced elements <span class=issue>and background images?</span>
  <tr>
    <th>Inherited:
    <td>yes
  <tr>
    <th>Percentages:
    <td>N/A
  <tr>
    <th>Media:
    <td>visual
  <tr>
    <th>Computed&nbsp;value:
    <td>as specified
</table>

<p>The 'image-resolution' property specifies the resolution of images.
  Values have the following meanings:

<dl>
  <dt><dfn>&lt;resolution></dfn>
  <dd>The value sets the resolution of the image. In combination with
    ''from-image'', the specified resolution is only used if the image
    does not have a resolution.
  <dt><dfn>from-image</dfn>
  <dd>The UA must look for the resolution in the image itself. If the
    image does not have a resolution, the specified &lt;resolution>
    value is used, or ''1dppx'' if none is given.
</dl>

<div class="example">
  <p>This rule specifies that the UA should use the image resolution
    found in the image itself, falling back to 1 image pixel per CSS
    ''px'' unit
  <pre>
  img { image-resolution: from-image }
  </pre>
</div>

<div class="example">
  <p>Using this rule, the image resolution is set to 300dpi and the
    resolution in the image, if any, is ignored.
  <pre>
  img { image-resolution: 300dpi }
  </pre>
</div>


<div class="example">
  <p>These rules both specify that the UA should use the image resolution
    found in the image itself. If the image has no resolution, the
    resolution is set to 300dpi.
  <pre>
  img { image-resolution: from-image 300dpi }
  img { image-resolution: 300dpi from-image }
  </pre>
</div>

<h3 id="image-orientation">Orienting an Image on the Page: the 'image-orientation' property</h3>

<p>Images from camera phones, digital cameras or scanners may be encoded sideways.
For example, the first row of image data may represent the leftmost or
rightmost column of image pixels. Furthermore, often such devices have limited
resources, and do not have the capability to rotate the image into an upright
orientation. However, this type of device may have internal knowledge or can
accept input from its user as to the rotational correction to perform.</p>

<p>The image-orientation property provides a way to specify an "out-of-band"
rotation to be applied to image source data. This facility is not intended to
specify layout transformations such as arbitrary rotation or flipping the image
in the horizontal or vertical direction. It is not needed to correctly orient
an image when printing in landscape versus portrait orientation, as that
rotation is done as part of layout. It should only be used to correct
incorrectly-oriented images.</p>

<table class="propdef" summary="image-orientation property definition">
  <tr>
    <th>Name:
    <td><dfn id="propdef-img-orient">image-orientation</dfn>
  <tr>
    <th>Value:
    <td>&lt;angle&gt;
  <tr>
    <th>Initial:
    <td>0deg
  <tr>
    <th>Applies to:
    <td>images
  <tr>
    <th>Inherited:
    <td>N/A
  <tr>
    <th>Percentages:
    <td>N/A
  <tr>
    <th>Media:
    <td>visual
  <tr>
    <th>Computed value:
    <td>normalized angle (''0deg'', ''90deg'', ''180deg'', or ''270deg'')
</table>

<p>'image-orientation' specifies an orthogonal rotation to be applied to an image
before it is laid out. CSS layout processing applies to the image after
rotation. This implies, for example:</p>

<ul>
<li>The intrinsic height and width are derived from the rotated rather than the
original image dimensions;</li>
<li>The height (width) property applies to the vertical (horizontal) dimension
of the image, <em>after</em> rotation.</li>
</ul>

<p>The following values for the <span class="property">'image-orientation'</span>
property apply to an image:</p>

<dl>
<dt>&lt;angle&gt;</dt>
<dd>Positive values cause the image to be rotated to the right (in a clockwise
direction), while negative values cause a rotation to the left. The angular
value in degrees, radians or grads is rounded to the nearest cardinal angle.
Values half way between cardinal angles, such as 45deg, round forward, in the
direction of rotation. Values greater than 360deg or less than -360deg are
moduloed to produce a value between 0deg and 360deg. Analogous rules apply for
rad and grad unit values.</dd>
</dl>

<div class="example">
  <p>The following example rotates the image 90 degrees clockwise:</p>
  <pre>
  img.ninety     { image-orientation: 90deg }
  ...
  &lt;img class="ninety" src=... /&gt;
  </pre>
</div>

<h3 id="object-fit">The 'object-fit' Property</h3>

<table class="propdef">
  <tr>
    <th>Name:
    <td><dfn>object-fit</dfn>
  <tr>
    <th>Value:
    <td>fill | contain | cover
  <tr>
    <th>Initial:
    <td>fill
  <tr>
    <th>Applies to:
    <td>replaced elements
  <tr>
    <th>Inherited:
    <td>yes
  <tr>
    <th>Percentages:
    <td>N/A
  <tr>
    <th>Media:
    <td>visual
  <tr>
    <th>Computed value:
    <td>specified value
</table>

<p>The 'object-fit' property specifies how the contents of a replaced element
should be scaled relative to the box established by its used height and width.
It also enables scaling a replaced element's contents up to a specified maximum
size or down to a specified minimum size while preserving its aspect ratio.</p>

<p>Not all replaced elements can be scaled, but images typically can.</p>

<p>The contents of a replaced element with an intrinsic aspect ratio (which may be
derived from intrinsic dimensions) are scaled as follows:</p>

<dl>

<dt>fill</dt>
<dd>Determine the used 'height' and 'width' <a href="/TR/CSS21/visudet.html">as
usual</a>. Scale the content height and width independently so that the edges
of the content just meet the edges of the box established by the used 'height'
and 'width'.</dd>

<dt>contain</dt>
<dd>Determine the used 'height' and 'width' <a href="/TR/CSS21/visudet.html">as
usual</a>, except if both 'height' and 'width' are 'auto', and the used value
of at least one of 'max-width' and 'max-height' is not 'none', then compute the
element's used width and used height as though the intrinsic dimensions of the
contents were infinitely large numbers whose ratio is the actual intrinsic
ratio of the contents.</dd>
<dd>Scale the contents of the element, preserving their aspect ratio, to the
largest size such that the width of the contents is less than or equal to the
used width of the box and the height of the contents is less than or equal to
the used height of the box.</dd>

<dt>cover</dt>
<dd>Determine the used 'height' and 'width' <a href="/TR/CSS21/visudet.html">as
usual</a>, except if both 'height' and 'width' are 'auto', and the used value
of at least one of 'min-width' and 'min-height' is not '0', then compute the
used width and used height of the element as though the intrinsic dimensions of
the contents were infinitesimally small numbers whose ratio is the actual
intrinsic ratio of the contents.</dd>
<dd>Scale the contents of the element, preserving their aspect ratio, to the
smallest size such that the width of the contents is greater than or equal to
the used width of the box and the height of the contents is greater than or
equal to the height of the box.</dd>
</dl>

<p>The 'overflow' property determines how to render parts of the replaced
element's content that extend beyond the edges of its box. See the
'image-position' property for positioning the object with respect to the
element's box.</p>

<p>UAs may support 'image-fit' as an alias for 'object-fit' when parsing
CSS declarations if they need to accommodate existing content that uses
the 'image-fit' property name.</p>

<p class="note">Note: the 'object-fit' property has similar semantics to
the fit attribute in [[SMIL10]].</p>

<div class="figure">
  <p><img src="img_scale.png" style="width: 70%; border: thin solid black;"
          alt="Illustration of the four values"></p>
  <p class="caption">
  An example showing how each of the four values of 'object-fit' causes the
  replaced element (blue figure) to be scaled to fit its height/width box (shown
  with a green background), with overflow 'visible' and 'hidden', using the
  initial value for 'object-position'.</p>
</div>

<h3 id="object-position">The 'object-position' Property</h3>

<table class="propdef">
  <tr>
    <th>Name:
    <td><dfn>object-position</dfn>
  <tr>
    <th>Value:
    <td>[ [ <a class="noxref" href="/TR/CSS21/syndata.html#value-def-percentage"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | <a class="noxref" href="/TR/CSS21/syndata.html#value-def-length"><span class="value-inst-length">&lt;length&gt;</span></a> | left | center | right ] [
    <a class="noxref" href="/TR/CSS21/syndata.html#value-def-percentage"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | <a class="noxref" href="/TR/CSS21/syndata.html#value-def-length"><span class="value-inst-length">&lt;length&gt;</span></a> | top | center | bottom ]? ] | [
    [ left | center | right ] || [ top | center | bottom ] ]
  <tr>
    <th>Initial:
    <td>50% 50%
  <tr>
    <th>Applies to:
    <td>replaced elements
  <tr>
    <th>Inherited:
    <td>yes
  <tr>
    <th>Percentages:
    <td>refer to width and height of box itself
  <tr>
    <th>Media:
    <td>visual
  <tr>
    <th>Computed value:
    <td>specified value
</table>

<p>The 'object-position' property determines the alignment of the replaced
element inside its box. The values have the same meaning as the values for
the <a href="/TR/CSS21/colors.html#propdef-background-position">'background-position'</a>
property, using the image as the image and the content box as the positioning
area. [[!CSS21]]</p>

<p class="note">Note that areas of the box not covered by the replaced
element will show the element's background.</p>

<p>UAs may support 'image-fit' as an alias for 'object-fit' when parsing
CSS declarations if they need to accommodate existing content that uses
the 'image-fit' property name.</p>

</div>

<div>
	<h2>Serialization</h2>
	<p>This section describes the serialization of all new properties and value types introduced in this specification.</p>

	<div>
		<h3 id="serializing-gradients">Serializing Gradients</h3>
		<p>To serialize a linear gradient, let s initially be the empty string, run these steps, and then return s:</p>
		<ol>
			<li>Append "linear-gradient(" to s.</li>
			<li>
				<ul>
					<li>If the first argument to the gradient function was a single keyword, serialize the keyword and append it to s.</li>
					<li>Otherwise, if the first argument to the gradient function was two keywords, serialize both keywords.  Append them, separated by a space " ", to s.</li>
					<li>Otherwise, if the first argument to the gradient function was an &lt;angle>, serialize the &lt;angle> and append it to s.</li>
					<li>Otherwise, append "top" to s.</li>
				</ul>
			</li>
			<li>If the first argument to the gradient function was not a color-stop, append a comma and a space ", " to s.</li>
			<li>For each color-stop in the gradient, do the following:
				<ol>
					<li>Serialize the &lt;color>, and append it to s.</li>
					<li>If a &lt;length> or &lt;percentage> was specified, append a space " " to s, then serialize the &lt;length> or &lt;percentage> and append it to s.</li>
					<li>If this is not the final color-stop, append a comma and a space ", " to s.</li>
				</ol>
			</li>
			<li>Append a close parenthesis ")" to s.</li>
		</ol>
		<p>To serialize a radial gradient, let s initially be the empty string, run these steps, and then return s:</p>
		<ol>
			<li>Append "radial-gradient(" to s.</li>
			<li>If a &lt;bg-position> was specified in the first argument to the gradient function, serialize it and append it to s.  Otherwise, append "center" to s.</li>
			<li>Append a comma and a space ", " to s.</li>
			<li>
				<ul>
					<li>If a &lt;shape> and/or &lt;size> was specified in the second argument to the gradient function:
						<ol>
							<li>If a &lt;shape> was specified, serialize it as a keyword and append it to s.  Otherwise, append "ellipse" to s.</li>
							<li>Append a space " " to s.</li>
							<li>If a &lt;size> was specified, serialize it as a keyword and append it to s.  Otherwise, append "cover" to s.</li>
						</ol>
					</li>
					<li>Otherwise, if two &lt;length>s or &lt;percentage>s were specified in the second argument to the gradient function:
						<ol>
							<li>Serialize the first &lt;length> or &lt;percentage> and append it to s.</li>
							<li>Append a space " " to s.</li>
							<li>Serialize the second &lt;length> or &lt;percentage> and append it to s.</li>
						</ol>
					</li>
					<li>Otherwise, append "ellipse cover" to s.</li>
				</ul>
			</li>
			<li>Append a comma and a space ", " to s.</li>
			<li>For each color-stop in the gradient, do the following:
				<ol>
					<li>Serialize the &lt;color>, and append it to s.</li>
					<li>If a &lt;length> or &lt;percentage> was specified, append a space " " to s, then serialize the &lt;length> or &lt;percentage> and append it to s.</li>
					<li>If this is not the final color-stop, append a comma and a space ", " to s.</li>
				</ol>
			</li>
			<li>Append a close parenthesis ")" to s.</li>
		</ol>
	</div>
</div>

<h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

<h2 class="no-num" id="references">References</h2>
<h3 class="no-num" id="normative-references">Normative references</h3>
<!--normative-->
<h3 class="no-num" id="informative-references">Informative references</h3>
<!--informative-->

</body>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
