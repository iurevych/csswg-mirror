<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html dir="ltr" lang="en">
<head profile="http://www.w3.org/2006/03/hcard">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <title>CSS Regions Module</title>
    <link href="http://dev.w3.org/csswg/default.css" rel="stylesheet" type=
    "text/css">
    <link href="http://www.w3.org/StyleSheets/TR/W3C-ED.css" rel="Stylesheet"
    type="text/css">
    <link id="st" href="alternate-spec-style.css" rel="stylesheet" type=
    "text/css" title="additional spec styles">
    <script type="text/javascript" src="style-toggle.js">
</script>
    <script src='http://test.csswg.org/harness/annotate.js#CSS3-REGIONS_DEV' type=
    'text/javascript'>
</script>
</head>

<body>
    <div class="head" id="div-head">
        <!--begin-logo-->

        <p><a href="http://www.w3.org/"><img alt="W3C" height="48" src=
        "http://www.w3.org/Icons/w3c_home" width="72"></a> <!--end-logo--></p>

        <h1 id="css-regions-module">CSS Regions Module</h1>

        <h2 class="no-num no-toc" id="longstatus-date">Editor's Draft
        [DATE]</h2>

        <dl>
            <dt>This version:</dt>

            <dd><a href=
            "[VERSION]">http://www.w3.org/csswg/css3-regions</a></dd>

            <dt>Latest version:</dt>

            <dd><a href=
            "http://www.w3.org/TR/css3-regions">http://www.w3.org/csswg/css3-regions</a></dd>

            <dt>Previous version:</dt>

            <dd>none</dd>

            <dt>Editors:</dt>

            <dd class="vcard"><span class="fn">Vincent Hardy</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">vhardy@adobe.com</span></dd>
            <dd class="vcard"><span class="fn">Alex Mogilevsky</span>,
            <span class="org">Microsoft</span>, <span class=
            "email">alexmog@microsoft.com</span></dd>

            <dt>Authors and Former Editors:</dt>

            <dd class="vcard"><span class="fn">Stephen Zilles</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">szilles@adobe.com</span></dd>

            <dd class="vcard"><span class="fn">Alexandru Chiculita</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">achicu@adobe.com</span></dd>

            <dd class="vcard"><span class="fn">Andrei Bucur</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">abucur@adobe.com</span></dd>

            <dd class="vcard"><span class="fn">Mihnea Ovidenie</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">mihnea@adobe.com</span></dd>

            <dd class="vcard"><span class="fn">Peter Sorotokin</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">psorotok@adobe.com</span></dd>

            <dd class="vcard"><span class="fn">Virgil Palanciuc</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">virgilp@adobe.com</span></dd>

            <dd class="vcard"><span class="fn">Arno Gourdol</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">agourdol@adobe.com</span></dd>
        </dl><!--begin-copyright--><!--end-copyright-->
        <hr title="Separator for header">
    </div>

    <h2 class="no-num no-toc" id="abstract">Abstract</h2>

    <p>The CSS Regions module allows content to flow across multiple areas
    called regions. The regions do not necessarily follow the document order.
    The CSS Regions module provides an advanced content flow mechanism, which
    can be combined with positioning schemes as defined by other CSS modules
    such as the Multi-Column Module [[CSS3COL]] or the Grid Layout Module
    [[CSS3-GRID-LAYOUT]] to position the regions where content flows.</p>

    <h2 class="no-num no-toc" id="status-of-this-document">Status of this
    document</h2><!--begin-status-->

    <p><em>This section describes the status of this document at the time of
    its publication. Other documents may supersede this document. A list of
    current W3C publications and the latest revision of this technical report
    can be found in the <a href="http://www.w3.org/TR/">W3C technical reports
    index at http://www.w3.org/TR/.</a></em></p>

    <p>This is a public copy of the editors' draft. It is provided for
    discussion only and may change at any moment. Its publication here does not
    imply endorsement of its contents by W3C. Don't cite this document other
    than as work in progress.</p>

    <p>The archived public mailing list www-style@w3.org is preferred for
    discussion of this specification. When sending e-mail, please put the text
    "css3-regions" in the subject, preferably like this: "[css3-regions]
    …summary of comment…"</p>

    <p>This draft is related to the drafts about Multi-column Layout <a href=
    '#CSSMULTICOL'>[CSSMULTICOL]</a>, Grid Layout <a href=
    '#CSS3GRID'>[CSS3GRID]</a>, Flexible Box Layout <a href=
    '#CSS3FLEXBOX'>[CSS3FLEXBOX]</a>, and Template Layout <a href=
    '#CSSTEMPLATELAYOUT'>[CSSTEMPLATELAYOUT]</a>.</p><!--end-status-->

    <h2 class="no-num no-toc" id="table-of-contents">Table of contents</h2>
    <!--begin-toc--><!--end-toc-->

    <h2 id="introduction">Introduction</h2>

    <p><em>This section is non-normative.</em></p>

    <p>Capturing the complex layouts of a typical magazine, newspaper, or
    textbook requires capabilities beyond those available in existing CSS
    modules. This is the purpose of the CSS Regions module.</p>

    <p>&nbsp;</p>

    <p>The CSS Regions module can be seen as an extension of the concept of
    multi-column elements. With CSS Multi-column layout [[CSS3COL]], columns
    share the same dimensions and define column boxes organized in rows.
    Content flows from one column to the next.</p>

    <p>&nbsp;</p>

    <p>The multi-column model is an example of flowing content from one area to
    another, where the areas are the multi-column element's column boxes and
    the flow is made of the multi-column element's children.</p>

    <p>&nbsp;</p>

    <p>However, for more complex layouts, content needs to flow from one area
    of the page to the next without limitation of the areas' sizes and
    positions. These arbitrary areas are the target of specific content flows.
    In this document these areas are called regions, and the content flows are
    called named flows. Regions are based on the rectangular geometry of the
    CSS box model. Elements in a named flow are taken out of the normal visual
    formatting and rendered in a chain of regions.</p>

    <h3 id="named-flows-and-regions">Named flows and regions</h3>

    <p>Consider the layout illustrated in figure 1.</p>

    <div class="figure">
        <img src="images/regions-intro.svg" width="400" alt=
        "multiple chained regions which should receive content from a flow">

        <p class="caption">Layout requiring sophisticated content flow</p>
    </div>

    <p>The designer's intent is to position an image in region 'A' and to flow
    an article's text from region '1', to region '2', '3' and '4'.</p>

    <p>The following code snippet shows the content to flow between the regions
    1, 2, 3 and 4.</p>
    <pre>
&lt;div <em>id="article"</em>&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
    &lt;p&gt;This is an example ...&lt;/p&gt;
    
&lt;h1&gt;More Details&lt;/h1&gt;
    &lt;p&gt;This illustrates ...&lt;/p&gt;
    &lt;p&gt;Then, the example ...&lt;/p&gt;
    &lt;p&gt;Finally, this ...&lt;/p&gt;
&lt;/div&gt;
        
</pre>

    <p>CSS layout facilities can position and size regions as needed. However,
    there is no existing mechanism to associate the content with the regions so
    that content flows as intended. Figure 2 shows an example of the intended
    visual rendering of the content.</p>

    <div class="figure">
        <img src="images/regions-intro-rendering.png" width="450" alt=
        "Sample rendering showing a single thread of text flowing through a chain of regions">

        <p class="caption">Sample rendering for desired layout</p>
    </div>

    <p>Since the CSS Regions module is independent of the layout of regions and
    the mechanism used to create them, the following assumes there is a CSS
    selector for the regions and, for the purpose of the example, the selectors
    for regions 1, 2, 3 and 4 show as ''&lt;region1_sel&gt;'',
    ''&lt;region2_sel&gt;'', ''&lt;region3_sel&gt;'' and
    ''&lt;region4_sel&gt;'' respectively. Such a selector could be an id
    selector (e.g., ''#region_1'') or a grid cell selector (e.g.,
    ''#myGrid::grid-cell([cell-name])'') if using the CSS Grid Layout module,
    for example.</p>

    <div class="example">
        <pre>
&lt;style&gt;

#article {
    <strong>flow-into: article_flow;</strong>
}

&lt;region1_sel&gt;, &lt;region2_sel&gt;, 
&lt;region3_sel&gt;, &lt;region4_sel&gt; {
    <strong>content: flow-from(article_flow);</strong>
}
&lt;/style&gt;
</pre>
    </div>

    <p>The above stylesheet directs the ''#article'' element to a named flow
    called 'article_flow' by setting the 'flow-into' property. Then, content is
    "poured" from that named flow into the desired regions by setting the
    regions' 'content' property to ''flow-from(article_flow)''.</p>

    <h3 id="region-styling">Regions Styling</h3>

    <p>Region styling allows content to be styled depending on the region it
    flows into. It is a form of context-based styling, similar to <a href=
    "#CSSMEDIAQUERIES">Media Queries</a> [[MEDIAQ]] which enable or disable
    selectors depending on the rendering context. With region styling,
    additional selectors may apply depending on the region into which content
    flows.</p>

    <p>In our example, the designer wants to make text flowing into region 1
    larger, bold and dark blue. In addition, <code class=
    "html">&lt;h1&gt;</code> headers should be run-ins and crimson.</p>

    <p>This design can be expressed with region styling as shown below.</p>

    <div class="example">
        <pre>
&lt;style&gt;
/*
 * Default article styling.
 */
#article {
    color:#777;
    text-align: justify;
}

#article h1 {
    border-left: 1px solid #777;
    padding-left: 2ex;
}

/*
 * Additional styling to apply to content when it falls into 
 * region_1
 */
<strong>@region &lt;region1_sel&gt; {</strong>
    #article::region-lines {
        font-weight: bold;
        color: #0C3D5F;
        font-size: larger;
    }

    #article h1 {
        color: crimson;
        display: run-in;
        border: none;
        padding: 0px;
    }
<strong>}</strong>
&lt;/style&gt;
</pre>
    </div>

    <p>The '@region' rule for region 1 limits its selectors to content flowing
    into region 1. The following figure shows how the rendering changes if we
    do not increase the font size nor make it bold for content flowing into
    region 1. As more content can be fitted, more content is subject to the
    contextual selectors, resulting in more dark blue text into region 1.</p>

    <p>The ''::region-lines'' pseudo-element is described later in this
    specification.</p>

    <div class="figure">
        <img src="images/region-styling.png" width="450" alt=
        "Illustrate how changing region styling affects the flow of content.">

        <p class="caption">Different rendering with a different region
        styling</p>
    </div>

    <h2 id="css-regions-model">CSS Regions Model</h2>

    <h3 id="named-flows">Named flows</h3>

    <p>In the <a href="http://www.w3.org/TR/CSS21/visuren.html">CSS formatting
    model</a>, elements can be in the <em>normal flow</em> or out of the
    <em>(normal) flow</em>. Boxes generated by elements in the normal flow are
    subject to their container box's normal layout scheme. Boxes generated by
    elements out of the normal flow are subject to a different layout scheme.
    For example, absolutely positioned elements are subject to absolute
    positioning into their <a href=
    "http://www.w3.org/TR/CSS21/visudet.html#containing-block-details">containing
    block</a>. This can be described by saying that the absolutely positioned
    elements are part of a special flow (called <span title=
    "positioned-flow">positioned flow</span>) which is subject to a special
    layout by its container box (i.e., its container box positions it into the
    containing block's box).</p>

    <p>&nbsp;</p>

    <p>In both cases, there is a notion of flow containing a sequence of
    elements and there is a notion of <a href=
    "http://www.w3.org/Style/Group/css2-src/visuren.html#block-boxes">(block)
    container box</a> into which the elements flow.</p>

    <p>&nbsp;</p>

    <p>The CSS Regions module generalizes the concept of flow by adding the
    concept of a <em>named flow</em>. This module lets authors explicitly place
    elements into a <em>named flow</em>.</p>

    <p>&nbsp;</p>

    <p>With this model, all elements are moved to a flow as part of the visual
    formatting. That flow may be the normal flow, a named flow or a positioned
    flow, for example. A flow gets formatted visually when associated with one
    or several elements' container box(es). When an flow is associated with
    container boxes, the boxes generated by the flow's elements are laid out
    according to the container box's layout scheme and the flow is subject to
    the <a href='#flow-breaking-rules'>'flow breaking rules'</a> described
    below.</p>

    <p>A container's layout scheme is the strategy used by a container to
    position the boxes generated by its children and itself. Examples are the
    normal layout (block and inline formatting) ([[CSS21]]), table layout
    ([[CSS21]]), the multi-column layout ([[CSS3COL]]) or the grid layout
    ([[CSS3-GRID-LAYOUT]]).</p>

    <h3 id="regions">Regions</h3>

    <p class="index" title="region" id="region">A region is an element that
    generates a <a href=
    "http://www.w3.org/TR/CSS21/visuren.html#block-boxes">block container
    box</a> and has an associated <em>named flow</em> (see the 'content'
    property).</p>

    <p>A <span title="region">region</span>'s intrinsic width is zero.</p>
    
    <div class="issue">
        There was a recent discussion on intrinsic sizing of regions which 
        <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0629.html">has not been resolved</a>.
    </div>

    <h3 id="flow-breaking-rules">Flow breaking rules</h3>

    <p>Breaking a named flow across multiple regions is similar to breaking a
    document's content across multiple pages. One important difference is that
    page boxes are generated based on the available content whereas regions are
    a predefined set of recipients for the named flow content.</p>

    <h4 id="breaking-a-named-flow-and-determining-the-current-flow-region">
    Breaking a named flow and determining the current flow region</h4>

    <p>The 'content-order' property defines how <span title=
    "region">regions</span> are organized in to a <span title=
    "region-chain">region chain</span>.</p>

    <p>Each region in turn consumes content from its associated <span title=
    "named-flow">named flow</span>. This means that the named flow content is
    positioned in the <dfn title="current-region">current region</dfn> until a
    region break occurs, at which point the <span title=
    "current-region">current region</span> becomes the next one in the
    <span title="region-chain">region chain</span>. If there is no more
    <span>region</span> in the region chain and there is still content in the
    flow, the positioning of the remaining content is controlled by the
    'region-overflow' property on the last <span>region</span> in the
    chain.</p>

    <p>The following sections define where region breaks may happen when
    positioning a named flow across <span title="region">regions</span> in a
    <span title="region-chain">region chain</span>.</p>

    <div class="issue">
        <p>The sections on "Allowed region breaks", "Forced region breaks" and
        ""Best" region breaks" are adapted from the [[!CSS21]] specification.
        There is an updated version of these paragraphs in [[CSS3PAGE]] as
        well.</p>

        <p>In addition, the CSS Multi-column Layout Module [[CSS3COL]] defines
        unified breaking properties (which this specification extends).</p>

        <p>It seems that we should:</p>

        <ol>
            <li>Define a common set of rules for breaking content that accounts
            for pages, columns and regions.</li>

            <li>Define the properties for breaking content in a single
            specification as well.</li>

            <li>Specify how column, page and region breaks interact.</li>
        </ol>
    </div>

    <h4 id="allowed-region-breaks">Allowed region breaks</h4>

    <p>In a named flow, region breaks can occur at the following places:</p>

    <ol>
        <li>In the vertical margin between block-level boxes. When an unforced
        region break occurs here, the <a href="cascade.html#used-value">used
        values</a> of the relevant <a href="box.html#propdef-margin-top" class=
        "noxref"><span class="propinst-margin-top">'margin-top'</span></a> and
        <a href="box.html#propdef-margin-bottom" class="noxref"><span class=
        "propinst-margin-bottom">'margin-bottom'</span></a> properties are set
        to '0'. When a forced region break occurs here, the used value of the
        relevant <a href="box.html#propdef-margin-bottom" class=
        "noxref"><span class=
        "propinst-margin-bottom">'margin-bottom'</span></a> property is set to
        '0'; the relevant <a href="box.html#propdef-margin-top" class=
        "noxref"><span class="propinst-margin-top">'margin-top'</span></a> used
        value may either be set to '0' or retained.</li>

        <li>Between <a href="visuren.html#line-box">line boxes</a> inside a
        <a href="visuren.html#block-boxes">block container</a> box.</li>

        <li>Between the content edge of a block container box and the outer
        edges of its child content (margin edges of block-level children or
        line box edges for inline-level children) if there is a (non-zero) gap
        between them.</li>
    </ol>

    <p>These breaks are subject to the following rules:</p>

    <ul>
        <li><strong>Rule A:</strong> Breaking at (1) is allowed only if the
        'break-after' 'break-before' properties of all the elements generating
        boxes that meet at this margin allow it, which is when at least one of
        them has the value 'always', 'left', or 'right', or when all of them
        are 'auto'.</li>

        <li><strong>Rule B:</strong> However, if all of them are 'auto' and a
        common ancestor of all the elements has a 'break-inside' value of
        'avoid-region', then breaking here is not allowed.</li>

        <li><strong>Rule C:</strong> Breaking at (2) is allowed only if the
        number of <a href="visuren.html#line-box">line boxes</a> between the
        break and the start of the enclosing block box is the value of
        'orphans' or more, and the number of line boxes between the break and
        the end of the box is the value of 'widows' or more.</li>

        <li><strong>Rule D:</strong> In addition, breaking at (2) or (3) is
        allowed only if the 'break-inside' property of the element and all its
        ancestors is 'auto'.</li>
    </ul>

    <p>If the above does not provide enough break points to keep content from
    overflowing the region boxes, then rules A, B and D are dropped in order to
    find additional breakpoints.</p>

    <p>If that still does not lead to sufficient break points, rule C is
    dropped as well, to find still more break points.</p>

    <h4 id="forced-region-breaks">Forced region breaks</h4>

    <p>A region break <em>must</em> occur at (1) if, among the 'break-after'
    and 'break-before' properties of all the elements generating boxes that
    meet at this margin, there is at least one with the value 'always', 'left',
    or 'right'.</p>

    <h4 id="best-region-breaks">"Best" region breaks</h4>

    <p>CSS&nbsp;2.1 does <em>not</em> define which of a set of allowed region
    breaks must be used; CSS&nbsp;2.1 does not forbid a user agent from
    breaking at every possible break point, or not to break at all. But
    CSS&nbsp;2.1 does recommend that user agents observe the following
    heuristics (while recognizing that they are sometimes contradictory):</p>

    <ul>
        <li>Break as few times as possible.</li>

        <li>Avoid breaking inside a replaced element.</li>
    </ul>

    <div class="example">
        <p style="display:none">Example(s):</p>

        <p>Suppose, for example, that the style sheet contains 'orphans: 4',
        'widows: 2', and there are 20 lines (<a href=
        "visuren.html#line-box">line boxes</a>) available at the bottom of the
        current region:</p>

        <ul>
            <li>If a paragraph at the end of the current region contains 20
            lines or fewer, it should be placed on the current region.</li>

            <li>If the paragraph contains 21 or 22 lines, the second part of
            the paragraph must not violate the <a href=
            "page.html#propdef-widows" class="noxref"><span class=
            "propinst-widows">'widows'</span></a> constraint, and so the second
            part must contain exactly two lines</li>

            <li>If the paragraph contains 23 lines or more, the first part
            should contain 20 lines and the second part the remaining
            lines.</li>
        </ul>

        <p>Now suppose that <a href="page.html#propdef-orphans" class=
        "noxref"><span class="propinst-orphans">'orphans'</span></a> is '10',
        <a href="page.html#propdef-widows" class="noxref"><span class=
        "propinst-widows">'widows'</span></a> is '20', and there are 8 lines
        available at the bottom of the current region:</p>

        <ul>
            <li>If a paragraph at the end of the current region contains 8
            lines or fewer, it should be placed on the current region.</li>

            <li>If the paragraph contains 9 lines or more, it cannot be split
            (that would violate the orphan constraint), so it should move as a
            block to the next region.</li>
        </ul>
    </div>

    <h3 id="the-visual-formatting-model-and-flows">The Visual Formatting Model
    and Flows</h3>

    <p>This section describes the flows to which elements formatted according
    to the CSS <a href="http://www.w3.org/TR/CSS21/visuren.html">Visual
    Formatting Model</a> and other layout modules (such as Multi-Column Layout
    [[CSS3COL]]) belong to.</p>

    <p>In particular, this section describes the 'generated flow' where
    generated content of pseudo-elements is placed and several <dfn id=
    "auto-flow" title="auto flows">'auto flows'</dfn> where children of content
    elements are automatically placed.</p>

    <h4 id="normal-flow">Normal flow</h4>

    <p>In the CSS formatting model, elements are by default placed in the
    <dfn id="normal-flow-def">normal flow</dfn> of their container. Also by
    default, a container element gets its content from its <em>normal
    flow</em>. This means that by default, a container element will visually
    format its children elements and will be the only container associated with
    its normal flow.</p>

    <p>Note that floats and relatively positioned elements, in this model, are
    part of the same flow of content and flow into the same container but are
    positioned in different ways.</p>

    <p>The <em>normal flow</em> is one of the <em>auto flows</em>.</p>

    <h4 id="positioned-flow">Positioned flow</h4>

    <p>An absolutely positioned element is placed into the <dfn title=
    "positioned-flow">positioned flow</dfn> of its container. The container
    positions this element into its <em>containing block</em>.</p>

    <p>If a container has children in the <em>normal flow</em> and in the
    <em>positioned flow</em>, it applies different positioning schemes to each
    flow.</p>

    <p>The <em>positioned flow</em> is one of the <em>auto flows</em>.</p>

    <h4 id="column-flow">Column flow</h4>

    <p>Children of the multi-column element are placed in the element's
    <dfn id="column-flow-def">column flow</dfn>. The column boxes are then
    implicitly associated with the element's 'column flow'. In this model,
    multiple regions (column boxes) get their content from a single flow (the
    element's 'column flow', which is the content of the element).</p>

    <p>The <em>column flow</em> is one of the <em>auto flows</em>.</p>

    <div class="issue">
        Need to add a <dfn id="grid-cell-flow">grid cell flow</dfn> section.
    </div>

    <div class="issue">
        Need to add examples for the different flow types.
    </div>

    <h4 id="generated-flow">Generated flow</h4>

    <p>In the CSS formatting model, when the ''::before'' or ''::after''
    pseudo-elements have their content property set to one of
    ''&lt;string&gt;'', ''&lt;uri&gt;'', ''&lt;counter&gt;'',
    ''attr(&lt;identifier&gt;)'', ''open-quote'', ''close-quote'',
    ''no-open-quote'' or ''no-close-quote'', they create a <dfn id=
    "generated-flow-def">generated flow</dfn> which they format visually.</p>

    <h3 id="relation-to-document-events">Relation to document events</h3>
    
    <p><em>This section is non-normative.</em></p>

    <p>The CSS Region module does not alter in any way the normal processing of
    events in the document tree. In particular, if an event occurs on an
    element that is part of a named flow, the <a href=
    "http://www.w3.org/TR/DOM-Level-3-Events/#dom-event-architecture">event's
    bubble and capture phases</a> happen following the document tree order.</p>

    <h2 id="properties-and-rules">Properties and Rules</h2>

    <p>The main CSS Regions module properties are the ‘flow’ and 'content'
    properties. The ‘flow’ property places an element into a specific named
    flow or lets the <a href="auto-flows">automatic flow assignment</a> take
    place. The ‘content’ property binds a region with a flow. When multiple
    regions are bound to the same flow, the 'content-order' property determines
    the order in which content flows into the sequence of regions. This
    sequences of regions is called a <dfn>region chain</dfn>.</p>

    <p>&nbsp;</p>

    <p>The way in which the content is broken into segments that fit in a
    region can be controlled by the “break” properties. Finally, styling that
    is unique to the region can be specified by ‘region-style’ rules.</p>

    <h3 id="the-flow-into-property">The 'flow-into' property</h3>

    <p>The ‘flow’ property places an element into a named flow or automatically
    places it in the appropriate flow (see the <a href=
    "#formatting-model-considerations">Visual Formatting Model and Flows</a>
    section). Elements that belong to the same flow are laid out in the regions
    associated with that flow.</p>

    <table class="propdef" summary="flow property definition">
        <tr>
            <th>Name:</th>

            <td><dfn id="flow2">flow</dfn></td>
        </tr>

        <tr>
            <th>Value:</th>

            <td>&lt;ident&gt;</td>
        </tr>

        <tr>
            <th>Initial:</th>

            <td>auto</td>
        </tr>

        <tr>
            <th>Applies to:</th>

            <td>any element</td>
        </tr>

        <tr>
            <th>Inherited:</th>

            <td>no</td>
        </tr>

        <tr>
            <th>Percentages:</th>

            <td>N/A</td>
        </tr>

        <tr>
            <th>Media:</th>

            <td>visual</td>
        </tr>

        <tr>
            <th>Computed&nbsp;value:</th>

            <td>as specified</td>
        </tr>
    </table>

    <dl>
        <dt>auto</dt>

        <dd>The element is automatically moved to the appropriate flow
        according to the <a href="#formatting_model_considerations">Visual
        Formatting Model and Flows</a> definitions.</dd>

        <dt><a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a></dt>

        <dd>The element is placed (appended) to the flow with that name. The
        element is said to have a <dfn id="specified-flow">specified
        flow</dfn>. The values 'none', 'inherit', 'default' and 'initial' and invalid flow
        names.</dd>
    </dl>

    <p>A named flow needs to be associated with one or more regions for its
    elements to be visually formatted. If no region is associated with a given
    named flow, the elements in the named flow are not rendered: they do not
    generate boxes and are not displayed.</p>

    <p>The children of an element with a specified flow may themselves have a
    specified flow.</p>

    <p>If an element has a the same specified flow value as one of its
    ancestors, it is moved out of its parent's normal flow and becomes a
    sibling of it's ancestor for the purpose of layout in the regions taking
    content from this flow.</p>

    <p>The 'flow-into' property does not affect the CSS cascade and inheritance for
    the elements on which it is specified. The flow property affects the visual
    formatting of elements associated to a named flow and of regions getting
    their content from a named flow.</p>

    <p>The containing block for absolutely positioned descendants of an element
    with a specified flow is the region into which the element is rendered.</p>

    <p>All the elements participating inside a named flow are rendered as
    children of an anonymous block that spans across all the regions associated
    with the specified named flow. The elements flowed inside the same named
    flow are taken in document order.</p>

    <p><span title="region">Regions</span> create a new stacking context, but
    inherit the floats that are already defined by the parent context.</p>

    <div class="example">
        <p>In the following example, the inline content coming from the
        <code class="html">content</code> <span title="named-flow">named
        flow</span> wraps around the <code class="html">#float</code> box.</p>
        <pre>
&lt;style&gt;
#float {
    float: left;
    width: 100px;
    height: 300px;
}

#region1, #region2 {
    width: 200px;
    height: 200px;
    content: flow-from(body_text);
}

#content {
    flow-into: body_text;
}
&lt;/style&gt;

&lt;div id="float"&gt;&lt;/div&gt;

&lt;div id="region1"&gt;&lt;/div&gt;
&lt;div id="region2"&gt;&lt;/div&gt;

&lt;div id="content"&gt;&lt;/div&gt; 
</pre>
    </div>
    

    <p>
        If ‘flow’ property is specified on an
        <code class=
        "html">&lt;iframe&gt;</code>, an <code class=
        "html">&lt;object&gt;</code> or a <code class=
        "html">&lt;embed&gt;</code> element, the 
        ‘display’ property is computed to ‘none’ and the referenced document within the element is used as the named flow. 
        In the case of the object element if fallback occurs and the fallback element has a referenced document then that 
        document is used as the named flow, otherwise the fallback element itself is added to the named flow.
    </p>
    <p>
        Any properties set on the iframe/object/embed elements (including margin, border, padding, background) have no effect. 
        This redirection of content does not change representation of the elements in document tree, just as for any other 
        source of named flow; in this case iframe still provides security checks for script in content (and sandbox if required), 
        events and CSS cascading work the same way as in a documents hosted in regular iframes.
    </p>
    <p>
        Region styling applies to content coming from iframe/object/embed sources exactly the same way as to any other flow content.
    </p>

    <h3 id="the-content-property">The 'content' property</h3>

    <p>This specification extends the definition of the 'content' property and
    makes it applicable to all block elements and pseudo-elements.</p>

    <table class="propdef" summary="content property definition">
        <tr>
            <th>Name:</th>

            <td><dfn id="content-from">content</dfn></td>
        </tr>

        <tr>
            <th>Value:</th>

            <td>normal | none | flow-from(&lt;ident&gt;)| [ &lt;string&gt; |
            &lt;uri&gt; | &lt;counter&gt; | attr(&lt;identifier&gt;) |
            open-quote | close-quote | no-open-quote | no-close-quote ]+ |
            inherit</td>
        </tr>

        <tr>
            <th>Initial:</th>

            <td>normal</td>
        </tr>

        <tr>
            <th>Applies to:</th>

            <td>non-replaced block elements and the ::before and ::after
            pseudo-elements</td>
        </tr>

        <tr>
            <th>Inherited:</th>

            <td>no</td>
        </tr>

        <tr>
            <th>Percentages:</th>

            <td>N/A</td>
        </tr>

        <tr>
            <th>Media:</th>

            <td>visual</td>
        </tr>

        <tr>
            <th>Computed&nbsp;value:</th>

            <td>as specified</td>
        </tr>
    </table>

    <dl>
        <dt><a name="x9" id="x9"><span class="index-inst" title=
        "none"><strong>none</strong></span></a></dt>

        <dd>For ''::before'' and ''::after'' pseudo-elements, the
        pseudo-element is not generated. For other elements, the element will
        not get any content for its visual formatting. If the children of the
        element are not directed to a flow referenced by another region, then
        they are not visually formatted. An element with its value set to
        'none' is said to be <dfn>disconnected</dfn></dd>

        <dt><strong>normal</strong></dt>

        <dd>Computes to 'none' for the ''::before'' and ''::after''
        pseudo-elements. For other elements, the element uses the flow assigned
        to its children following the <a href="auto-flows">automatic flow
        assignment for the Visual Formatting Model..</a></dd>

        <dt><strong>&lt;string&gt;</strong></dt>

        <dd>Text content (see the section on <a href=
        "syndata.html#strings">strings</a>).</dd>

        <dt><strong>&lt;uri&gt;</strong></dt>

        <dd>The value is a URI that designates an external resource (such as an
        image). If the user agent cannot display the resource it must either
        leave it out as if it were not specified or display some indication
        that the resource cannot be displayed.</dd>

        <dt><strong>&lt;counter&gt;</strong></dt>

        <dd><a href="syndata.html#counter">Counters</a> may be specified with
        two different functions: 'counter()' or 'counters()'. The former has
        two forms: 'counter(<var>name</var>)' or 'counter(<var>name</var>,
        <var>style</var>)'. The generated text is the value of the innermost
        counter of the given name in scope at this pseudo-element; it is
        formatted in the indicated <a href="#counter-styles">style</a>
        ('decimal' by default). The latter function also has two forms:
        'counters(<var>name</var>, <var>string</var>)' or
        'counters(<var>name</var>, <var>string</var>, <var>style</var>)'. The
        generated text is the value of all counters with the given name in
        scope at this pseudo-element, from outermost to innermost separated by
        the specified string. The counters are rendered in the indicated
        <a href="#counter-styles">style</a> ('decimal' by default). See the
        section on <a href="#counters">automatic counters and numbering</a> for
        more information. The name must not be 'none', 'inherit' or 'initial'.
        Such a name causes the declaration to be ignored.</dd>

        <dt><strong>open-quote</strong> and <strong>close-quote</strong></dt>

        <dd>These values are replaced by the appropriate string from the
        <a href="http://www.w3.org/TR/CSS21/generate.html#propdef-quotes"
        class="noxref"><span class=
        "propinst-quotes"><strong>'quotes'</strong></span></a> property.</dd>

        <dt><strong>no-open-quote</strong> and
        <strong>no-close-quote</strong></dt>

        <dd>Introduces no content, but increments (decrements) the level of
        nesting for quotes.</dd>

        <dt><strong>attr(X)</strong></dt>

        <dd>This function returns as a string the value of attribute X for the
        subject of the selector. The string is not parsed by the CSS processor.
        If the subject of the selector does not have an attribute X, an empty
        string is returned. The case-sensitivity of attribute names depends on
        the document language.</dd>

        <dt><dfn id="flow-from-name">flow-from(&lt;ident&gt;)</dfn></dt>

        <dd>The element will visually format the available elements in the
        named flow with name <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a>. If there is no flow with name
        &lt;ident&gt;, then the element is disconnected and does not format
        any children visually. Multiple elements may be associated with the
        same named flow. See the 'content-order' property description to
        understand how content segments are associated with different
        regions.
        <br />
        If the element is not a <a href="http://www.w3.org/TR/CSS21/visuren.html#block-boxes">block container box</a>, the value evaluates to 'normal'. This might be expanded in future versions of the specification
        to allow other types of containers to receive flow content.
        </dd>
    </dl>

    <div class="note">
        <p>The 'content' property applies to block-level elements and the
        '::before' and '::after' pseudo elements. User agents may apply the
        content property to inline elements. The behavior is undefined in that
        case, but is generally expected to be similar to that of inline
        '::before' and '::after' pseudo-elements.</p>

        <p>In particular, note that the behavior of a '::before' or '::after'
        pseudo-element with a 'display' value that makes it an inline element
        combined with a 'content' value set to 'flow-from(&lt;ident&gt;)' is
        undefined.</p>
    </div>

    <div class="issue resolved">
        <p><a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">Third resolution on
            Regions at the Seattle Face to Face meeting, July 2011</a>
            
        <p><strong>content: flow-from(&lt;flow-name&gt;) v.s. flow-from: &lt;flow-name&gt;</strong></p>

        <p><a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0413.html">WG Conference Call, CSSWG Minutes and Resolutions 2011-06-15</a>.</p>
        
        <p>See <a href="http://wiki.csswg.org/spec/css3-regions#contentflow-flow-from-name-vs-flow-fromflow-name">issue</a></p>
    </div>
    <div class="issue">
        <p>Should we consider adding the ability to do the following:</p>

        <ul>
            <li>Support repeatable content. For example, have a repeatable
            heading at the start of each region where content flows.</li>

            <li>Support flow breaking marks. It might be very useful to support
            a <em>mark</em> (such as "<code class="html">...</code>") at the
            region breaking points to indicate that content has been broken out
            and is continuing on a different region.</li><!--
            <li>Support "atomic pull-outs". For example, we could have a named
            flow made of a set of atomic quotes that should be placed, one by
            one, in discrete regions. In that use case, we would need a
            property to specify that content should be taken atomically from
            the flow. May be something like the following.
                <pre class="code">
&lt;div id="quote_1" class="quote"&gt;...&lt;/div&gt;
...
&lt;div id="quote_n" class="quote"&gt;...&lt;/div&gt;

&lt;div id="pull-out-1" class="pull-out"&gt;&lt;/div&gt;
...
&lt;div id="pull-out-n" class="pull-out"&gt;&lt;/div&gt;

&lt;style&gt;
.quote {
    flow-into: "quotes";
}

.pull-out {
    content: flow-from(quotes);
    content-consume: atomic;
}
&lt;/style&gt;
                    
</pre>
            </li>
            -->
        </ul>
    </div>

    <div class="issue resolved">
        <p><a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">First resolution on
            Regions at the Seattle Face to Face meeting, July 2011</a>
            
        <p><a href=
        "http://lists.w3.org/Archives/Public/www-style/2011May/0521.html">Mailing
        list comment</a></p>

        <p>''content: flow-from(&lt;ident&gt;)'' moves an element to a named
        flow. Should we allow the content to be copied to a flow instead of
        moved to a flow. For example:</p>

        <div class="code">
            #quote_A { flow-into: "quotes"; content: contents; }
        </div>

        <p>would keep ''#quote_A'' in the normal flow but also copy its content
        to the ''quotes'' flow. This essentially clones the node and raises
        questions regarding DOM access, CSSOM View and the computed style.</p>
    </div>

    <h3 id="the-content-order-property">The 'content-order' property</h3>

    <p>Defines the ordering of the chain of regions into which content flows.
    If region A and region B are in the same chain of regions and the
    ‘content-order’ of region A is lower than that of region B, then region A
    will precede region B in that chain: content will flow into region A before
    it flows into region B.</p>

    <table class="propdef" summary="content-order property definition">
        <tr>
            <th>Name:</th>

            <td><dfn id="content-order">content-order</dfn></td>
        </tr>

        <tr>
            <th>Value:</th>

            <td>&lt;integer&gt;</td>
        </tr>

        <tr>
            <th>Initial:</th>

            <td>0</td>
        </tr>

        <tr>
            <th>Applies to:</th>

            <td>any block container</td>
        </tr>

        <tr>
            <th>Inherited:</th>

            <td>no</td>
        </tr>

        <tr>
            <th>Percentages:</th>

            <td>N/A</td>
        </tr>

        <tr>
            <th>Media:</th>

            <td>visual</td>
        </tr>

        <tr>
            <th>Computed&nbsp;value:</th>

            <td>as specified</td>
        </tr>
    </table>

    <dl>
        <dt>&lt;integer&gt;</dt>

        <dd>Specifies the region's priority in the chain it belongs to, i.e..,
        the chain of regions associated with the same content flow. Negative
        values are allowed.</dd>
    </dl>

    <p>If two or more regions with the same 'flow-from( &lt;ident&gt;)' value
    for their 'content' property, they are first sorted according to their
    'content-order' value. If multiple regions in have the same 'content-order'
    value, they are sorted according to the document order.</p>

    <div class="issue">
        CSS Modules should define the document order for pseudo elements. For
        example, the [CSSGRID] specification should define the document order
        for the '::grid-cell' pseudo elements (e.g., row-major sorting or
        column major sorting of cells).
    </div>

    <h3 id=
    "region-flow-break-properties-break-before-break-after-break-inside">Region
    flow break properties: 'break-before', 'break-after', 'break-inside'</h3>

    <p>When content is laid out in multiple regions, the user agent must
    determine where content breaks occur. The problem of breaking content into
    segments fitting in regions is similar to breaking content into pages or
    columns.</p>

    <p>Each break ends layout in the current region and causes remaining pieces
    of content from the named flow to be visually formatted in the following
    region, in the order defined by the 'content-order' computed values. Note
    that there is no region break in the last region associated with a named
    flow.</p>

    <p>The following extends the 'break-before', 'break-after' and
    'break-inside' properties from the [[!CSS3COL]] specification to account
    for regions. The additional values are described below.</p>

    <table class="propdef" summary="break-before property definition">
        <tr>
            <td><em>Name:</em></td>

            <td><dfn>break-before</dfn></td>
        </tr>

        <tr>
            <td><em>Value:</em></td>

            <td>auto | always | avoid | left | right | page | column | region |
            avoid-page | avoid-column | avoid-region</td>
        </tr>

        <tr>
            <td><em>Initial:</em></td>

            <td>auto</td>
        </tr>

        <tr>
            <td><em>Applies to:</em></td>

            <td>block-level elements</td>
        </tr>

        <tr>
            <td><em>Inherited:</em></td>

            <td>no</td>
        </tr>

        <tr>
            <td><em>Percentages:</em></td>

            <td>N/A</td>
        </tr>

        <tr>
            <td><em>Media:</em></td>

            <td>paged</td>
        </tr>

        <tr>
            <td><em>Computed&nbsp;value:</em></td>

            <td>specified value</td>
        </tr>
    </table>

    <table class="propdef" summary="break-after property definition">
        <tr>
            <td><em>Name:</em></td>

            <td><dfn>break-after</dfn></td>
        </tr>

        <tr>
            <td><em>Value:</em></td>

            <td>auto | always | avoid | left | right | page | column | region |
            avoid-page | avoid-column | avoid-region</td>
        </tr>

        <tr>
            <td><em>Initial:</em></td>

            <td>auto</td>
        </tr>

        <tr>
            <td><em>Applies to:</em></td>

            <td>block-level elements</td>
        </tr>

        <tr>
            <td><em>Inherited:</em></td>

            <td>no</td>
        </tr>

        <tr>
            <td><em>Percentages:</em></td>

            <td>N/A</td>
        </tr>

        <tr>
            <td><em>Media:</em></td>

            <td>paged</td>
        </tr>

        <tr>
            <td><em>Computed&nbsp;value:</em></td>

            <td>specified value</td>
        </tr>
    </table>

    <table class="propdef" summary="break-inside property definition">
        <tr>
            <td><em>Name:</em></td>

            <td><dfn>break-inside</dfn></td>
        </tr>

        <tr>
            <td><em>Value:</em></td>

            <td>auto | avoid | avoid-page | avoid-column | avoid-region</td>
        </tr>

        <tr>
            <td><em>Initial:</em></td>

            <td>auto</td>
        </tr>

        <tr>
            <td><em>Applies to:</em></td>

            <td>block-level elements</td>
        </tr>

        <tr>
            <td><em>Inherited:</em></td>

            <td>no</td>
        </tr>

        <tr>
            <td><em>Percentages:</em></td>

            <td>N/A</td>
        </tr>

        <tr>
            <td><em>Media:</em></td>

            <td>paged</td>
        </tr>

        <tr>
            <td><em>Computed&nbsp;value:</em></td>

            <td>specified value</td>
        </tr>
    </table>

    <p>These properties describe page, column and region break behavior
    before/after/inside the generated box. These values are normatively defined
    in [[!CSS3COL]]:</p>

    <dl>
        <dt>auto</dt>

        <dd>Neither force nor forbid a page/column break before (after, inside)
        the generated box.</dd>

        <dt>always</dt>

        <dd>Always force a page break before (after) the generated box.</dd>

        <dt>avoid</dt>

        <dd>Avoid a page/column break before (after, inside) the generated
        box.</dd>

        <dt>left</dt>

        <dd>Force one or two page breaks before (after) the generated box so
        that the next page is formatted as a left page.</dd>

        <dt>right</dt>

        <dd>Force one or two page breaks before (after) the generated box so
        that the next page is formatted as a right page.</dd>

        <dt>page</dt>

        <dd>Always force a page break before (after) the generated box.</dd>

        <dt>column</dt>

        <dd>Always force a column break before (after) the generated box.</dd>

        <dt>avoid-page</dt>

        <dd>Avoid a page break before (after, inside) the generated box.</dd>

        <dt>avoid-column</dt>

        <dd>Avoid a column break before (after, inside) the generated box.</dd>
    </dl>

    <p>This specification adds the following new values:</p>

    <dl>
        <dt>region</dt>

        <dd>Always force a region break before (after) the generated box.</dd>

        <dt>avoid-region</dt>

        <dd>Avoid a region break before (after, inside) the generated box.</dd>
    </dl>

    <p>When a break splits a box, the box's margins, borders, and padding have
    no visual effect where the split occurs. However, the margin immediately
    after a forced page/column/region break will be preserved. A forced
    page/column/region break is a break that does not occur naturally.</p>

    <p><strong>Note:</strong> When the 'avoid' value is used, regions may
    overflow. In that case the 'overflow' property specified on the region
    element should be used to determine how to render the overflow.</p>

    <h3 id="the-region-overflow-property">The region-overflow property</h3>

    <table class="propdef" summary="break-after property definition">
        <tr>
            <td><em>Name:</em></td>

            <td><dfn>region-overflow</dfn></td>
        </tr>

        <tr>
            <td><em>Value:</em></td>

            <td>auto | break</td>
        </tr>

        <tr>
            <td><em>Initial:</em></td>

            <td>auto</td>
        </tr>

        <tr>
            <td><em>Applies to:</em></td>

            <td><em title="region element">region elements</em></td>
        </tr>

        <tr>
            <td><em>Inherited:</em></td>

            <td>no</td>
        </tr>

        <tr>
            <td><em>Percentages:</em></td>

            <td>N/A</td>
        </tr>

        <tr>
            <td><em>Media:</em></td>

            <td>paged</td>
        </tr>

        <tr>
            <td><em>Computed&nbsp;value:</em></td>

            <td>specified value</td>
        </tr>
    </table>

    <p>The 'region-overflow' property controls the behavior of the <em id=
    "last-region">last region</em> associated with a <span>named
    flow</span>.</p>

    <dl>
        <dt>auto</dt>

        <dd>Content flows as it would in a regular content element. If the
        content exceeds the container box, it is subject to the <a href=
        "http://www.w3.org/TR/CSS21/visufx.html#propdef-overflow">overflow</a>
        property's computed value on the region element. Region breaks must be 
        ignored on the last region.</dd>

        <dt>break</dt>

        <dd>If the content fits within the <em>region element</em>, then this
        property has no effect. If the content does not fit within the
        <em>region element</em>, the content breaks as if flow was going to
        continue in a subsequent region. See the <a href=
        "#breaking-rules">breaking rules</a> section. A forced region break takes precedence over
        a natural break point.</dd>
    </dl>

    <p>The following code sample illustrates the usage of the 'region-overflow'
    property.</p>

    <div class="example">
        <pre>
&lt;style&gt;
#article {
    flow-into: "article";
}

#region_1, #region_2 {
    content: flow-from(article);
    <strong>region-overflow: break;</strong> /* or none */
    <strong>overflow: visible;</strong> /* or hidden */
}

&lt;/style&gt;

&lt;div id="article"&gt;...&lt;/div&gt;

&lt;div id="region_1"&gt;&lt;/div&gt;
&lt;div id="region_2"&gt;&lt;/div&gt;
        
</pre>
    </div>

    <div class="figure">
        <table style="border: 1px solid gray;width: 100%;" summary=
        "Different values for the region-overflow property - Illustration.">
            <tr>
                <td>''flow-into: "article"''</td>

                <td><code class="html">region_1</code> and <code class=
                "html">region_2</code></td>

                <td>''region-overflow: auto''<br>
                ''overflow:visible''</td>
            </tr>

            <tr>
                <td rowspan="3" style="vertical-align: top;"><img src=
                "images/region-overflow-flow.png" alt=
                "regions receiving the flow content"></td>

                <td><img src="images/region-overflow-regions.png" alt=
                "result if region-overflow is set to 'break'"></td>

                <td><img src="images/region-overflow-auto-overflow-visible.png"
                alt="regions receiving the flow content"></td>
            </tr>

            <tr>
                <td>''region-overflow: break''</td>

                <td>''region-overflow: auto''<br>
                ''overflow:hidden''</td>
            </tr>

            <tr>
                <td><img src="images/region-overflow-break.png" alt=
                "result if region-overflow is set to 'break'"></td>

                <td><img src="images/region-overflow-auto-overflow-hidden.png"
                alt="regions receiving the flow content"></td>
            </tr>
        </table>

        <p class="caption">Different values for the region-overflow
        property</p>
    </div>

    <h3 id="the-at-region-style-rule">The @region rule</h3>

    <p>An '@region' rule contains style declarations specific to particular
    regions.</p>

    <p>The '@region' rule consists of the keyword '@region' followed by a
    <a href="http://www.w3.org/TR/css3-selectors/#selector-syntax">selector</a>
    and a declarations block. The '@region' rule and the selector constitute
    the region's 'flow segment' selector. The region's flow segment selector
    specifies which range of elements in the flow are subject to the following
    declaration blocks: it applies to the range (see
    [[DOM-LEVEL-2-TRAVERSAL-RANGE]]) from the region's flow that flow in the
    selected region(s).</p>

    <p>Only elements that are fully in the 'flow segment' may match any of the
    selectors found in the style rule. If an element is split across regions,
    it will not be subject to region styling in any of the regions it is part
    of. However, it's children element or pseudo-elements may be.</p>

    <p>In addition, the ''::region-lines'' pseudo-element can be used to select
    the inline content of an element that falls into a particular region.</p>
    <pre class="code">
<strong>@region &lt;selector&gt; {
    ... CSS styling rules ...
}</strong>          
</pre>

    <div class="example" id="region-style-example">
        <p>In the following example, the named flow 'article_flow' flows
        through 'region_1' and 'region_2'.</p>
        <pre>
&lt;style&gt;
    #div_1 {
        <strong>flow-into: article_flow;</strong>
    }
    
    &lt;region1_sel&gt;, &lt;region2_sel&gt; {
        <strong>content: flow-from(article_flow);</strong>
    }

    /* region style RSA */
    <strong>@region &lt;region1_sel&gt;, &lt;region2_sel&gt;</strong> {
        p<strong>::region-lines</strong> {...}
        div {...}
        p {...}
    }
    
    /* region style RSB */
    <strong>@region &lt;region1_sel&gt;</strong> {
        p {...}
        #p_2::region-lines {...}
    }
        
&lt;/style&gt;

&lt;div id="div_1"&gt;
    &lt;p id="p_1"&gt;...&lt;/p&gt;
    &lt;p id="p_2"&gt;...&lt;/p&gt;
&lt;/div&gt;

        
</pre>

        <div id="region_styling_illustration">
            <img id="region_styling_img_2" src="images/region-styling-2.png"
            alt=
            "Illustration showing how a named flow content fits into regions to illustrate the @region styling."
            name="region_styling_img_2">

            <ul class="swatch-list">
                <li><span class="swatch" style=
                "background:#1C75BC">&nbsp;</span>div div_1</li>

                <li><span class="swatch" style=
                "background:crimson">&nbsp;</span>paragraph p_1</li>

                <li><span class="swatch" style=
                "background:white">&nbsp;</span>paragraph p_2</li>

                <li><span class="swatch" style=
                "background:#E6E7E8">&nbsp;</span>range of flow that fits into
                region_1</li>

                <li><span class="swatch" style=
                "background:#BCBEC0">&nbsp;</span>range of flow that fits into
                region_2</li>
            </ul>
        </div>

        <p>The region style ''RSA'' applies to flow content that fits in either
        'region_1' or 'region_2'.</p>

        <p>The first rule set ''p::region-lines {...}'' uses the
        ''::regions-line'' pseudo-element. Since all the content is fitted in
        either 'region_1' or 'region_2', this rule set applies to all content
        lines.</p>

        <p>The second rule set ''div {...}'' applies to all <code class=
        "html">&lt;div&gt;</code> elements that fit fully into 'region_1' or
        'region_2'. In our example, there is no <code class=
        "html">&lt;div&gt;</code> in the flow that fits fully in a region,
        because <code class="html">div_1</code> is split between 'region_1' and
        'region_2'.</p>

        <p>The third rule set ''p {...}'' applies to all <code class=
        "html">&lt;p&gt;</code> elements that fit fully into 'region_1' or
        'region_2'. In our example, only <code class="html">p_1</code> fully
        fits in a region, 'region_1'.</p>

        <p>The region style ''RSB'' applies to flow content that fits in
        'region_1'.</p>

        <p>The first rule set ''p {...}'' matches <code class="html">p_1</code>
        because that paragraph fully fits in 'region_1'.</p>

        <p>The second rule set ''#p_2::region-lines {...}'' matches lines in
        <code class="html">p_2</code> that flow into 'region_1'. These lines
        will be subject to the additional style.</p>
    </div>

    <div>
        <p>The properties applying to the '::region-lines' pseudo-element is
        limited to the same set as those available on the <a href=
        "http://www.w3.org/TR/css3-selectors/#first-line">'first-line'</a>
        pseudo-element, as listed in the <a href=
        "http://www.w3.org/TR/css3-selectors/#first-formatted-line">First
        formatted line definition in CSS</a> in [[!SELECT]]</p>
    </div>

    <div class="issue">
        Is the proposed restriction that elements are only selected selector in
        a rule set appearing in an @region rule sufficient?
    </div>

    <div class="issue">
        There is <a href=
        "http://lists.w3.org/Archives/Public/www-style/2011May/0518.html">concern</a>
        that the ''first-line'' precedent is underspecified and that more
        specification is needed in addition to referencing the existing
        precedent.
    </div>

    <p>The specificity of the selectors in a '@region' rule is calculated as
    <a href="http://www.w3.org/TR/css3-selectors/#specificity">defined</a> in
    the CSS Selectors module (see [[SELECT]]). In other words, the '@region'
    rule adds an extra condition to the selector's matching, but does not
    change the selector's specificity. This is the same behavior as selectors
    appearing in '@media' rules declaration blocks (see [[MEDIAQ]]), where the
    rule does not influence the selectors' specificity.</p>

    <p>&nbsp;</p>

    <p>Consequently, selectors that match a given element (as describe above),
    participate in the <a href="CSS2.1%20section%206.4.1">CSS Cascading
    order</a> as defined in [[!CSS21]].</p>

    <h2 id="cssom_view_and_css_regions">CSSOM View and CSS Regions</h2>

    <p>Since content may flow into multiple regions, authors need a way to
    determine if there are enough regions to flow all the content from a named
    flow. This is especially important considering that the size of regions may
    change depending on the display context. For example, flowing the same
    content on a mobile phone with a small screen may require more regions than
    on a large desktop display.</p>

    <p>Here is another example where creating more regions might be needed. If
    the user may change the font size of text flowing through regions, new
    regions may be needed to accommodate for the additional space required to
    fit the larger text or some may need to be removed for smaller text.</p>

    <p>The CSS OM View ([[CSSOM-VIEW]]) specification defines extensions to the
    <code class="idl">Element</code> interface that would let an author find
    out if the last region overflows its content boundaries (by comparing its
    'scrollHeight' with its 'contentHeight'). However, this assumes the region
    is a document element, which may not always be the case. For example, as
    described in a later section, a grid cell (see [[CSS3-GRID-LAYOUT]]) may be
    a region, but it is a pseudo-element, not an document element. Therefore,
    it is not possible to access its 'scrollHeight' or 'contentHeight'.</p>

    <div class="note">
        <p>Since an element may be split into multiple regions, invoking
        <code class="idl"><a href=
        "http://www.w3.org/TR/cssom-view/#dom-element-getclientrects">getClientRects</a></code>
        on it must return the list of rectangles for the element in all the
        regions it is part of.</p>
    </div>

    <h3 id="the-namedflow-interface">The NamedFlow interface</h3>

    <p>This specification adds a method to the <a href=
    "http://www.w3.org/TR/DOM-Level-3-Core/core.html#i-Document"><code class=
    "idl">Document</code></a> interface to access the document's <span title=
    "named-flow">named flow</span> instances.</p>
    <pre class="idl">
[Supplemental] interface <a href=
"http://www.w3.org/TR/DOM-Level-3-Core/core.html#i-Document">Document</a> {
  <a href="#dom-namedflow">NamedFlow</a> <a href=
"#dom-document-getflowbyname">getFlowByName(</a><a href=
"http://www.w3.org/TR/DOM-Level-3-Core/core.html#DOMString">DOMString</a> name);
};               
</pre>

    <p>The <dfn id="dom-namedflow"><code class="idl">NamedFlow</code></dfn>
    interface offers a representation of the <span>named flow</span>.</p>
    <pre class="idl">
interface <a href="#dom-namedflow">NamedFlow</a> {
  readonly attribute boolean <a href="dom-namedflow-overflow">overflow</a>;
};    
    
</pre>

    <p>The <dfn id="dom-namedflow-overflow"><code class=
    "idl">overflow</code></dfn> property is true if the named flow does not
    fully fit in the associated regions. Otherwise, it is false. A 
    <code class="idl">NamedFlow</code> object is live.</p>

    <p>With the <a href="#dom-namedflow"><code class="idl">NamedFlow</code></a>
    interface, authors can easily check if all content has been fitted into
    existing regions. If it has, the overflow property would be true.</p>

    <h3 id="extension-to-the-element-interface">Extension to the Element
    interface</h3>

    <p>When an region is an actual <a href=
    "http://www.w3.org/TR/DOM-Level-3-Core/glossary.html#dt-element">element</a>,
    it is convenient to easily find out if content fully fits into the
    <span>region</span> or not. The supplemental interface on <a href=
    "http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-745549614"><code class=
    "idl">Element</code></a> provides that functionality.</p>
    <pre class="idl">
[Supplemental] interface <a href=
"http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-745549614">Element</a> {
    readonly attribute <a href=
"http://www.w3.org/TR/DOM-Level-3-Core/core.html#DOMString">DOMString</a> <a href="#dom-element-regionoverflow">regionOverflow</a>;
    getter <a href="#">Range</a>[] <a href=
"#dom-element-getregionflowranges">getRegionFlowRanges()</a>;
};               
    
</pre>

    <p>The <dfn id="dom-element-regionoverflow"><code class=
    "idl">regionOverflow</code></dfn> attribute can take one of the following
    values:</p>

    <dl>
        <dt>'overflow'</dt>

        <dd>the region element's content overflows the region's <a href=
        "http://www.w3.org/TR/CSS21/box.html#box-dimensions">content box</a>.
        Note that the region's <a href=
        "http://www.w3.org/TR/CSS21/visufx.html#overflow"><code class=
        "idl">overflow</code></a> property value can be used to control the
        visibility of the overflowing content. This means that the region is
        the last one in the <span title="region-chain">region chain</span> and
        not able to fit the remaining content from the <span title=
        "named-flow">named flow</span>.</dd>

        <dt>'fit'</dt>

        <dd>the region element's content fits into the region's <a href=
        "http://www.w3.org/TR/CSS21/box.html#box-dimensions">content box</a>.
        It does not overflow. If the region is the last one in the <span title=
        "region-chain">region chain</span>, it means that the content fits
        without overflowing. If the region is not the last one in the region
        chain, that means the <span title="named-flow">named flow</span>
        content is further fitted in subsequent regions. In particular, in this
        last case, that means the region may have received no content from the
        <span title="named-flow">named flow</span> (for example if the region
        is too span to accommodate any content).</dd>

        <dt>'empty'</dt>

        <dd>the region element has no content and is empty. All content from
        the <span title="named-flow">named flow</span> was fitted in regions
        with a lower 'content-order' value.</dd>
        
        <dt>'undefined'</dt>
        <dd>The element is not a <span>region</span>.</dd>
    </dl>



    <p>&nbsp;</p>

    <p>The <dfn id="dom-element-getregionflowranges">getRegionFlowRanges</dfn> method returns
    an array of <a href=
    "http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-idl">
    Range</a> instances corresponding to the content from the region flow that
    is positioned in the region.</p>

    <p>If an element is not a <span>region</span>, the <code class=
    "idl"><span title="#document-element-getregionflowranges">getRegionFlowRanges</span></code>
    method throws a <a href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-17189187"><code class="idl">DOMException</code></a> with the 
    <a href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#DOMException-INVALID_ACCESS_ERR"><code class="idl">INVALID_ACCESS_ERR</code></a> error code.</p>

    <div class="note">
        The Element interface extension is only available to regions that are
        document elements and not to regions that are pseudo-elements. For
        example, when regions are created with a grid layout, this interface
        cannot be used because the regions are not document elements but
        pseudo-elements. In that situation, the NamedFlow interface can be
        used.
    </div>

    <div class="issue resolved">
        <p><a href="http://www.w3.org/Style/CSS/Tracker/actions/350">ACTION-350</a> was created
            to add the API to the specification draft.</p>
        <p>It has been <a href=
        "http://lists.w3.org/Archives/Public/www-style/2011May/0379.html">suggested</a>
        to add an API to find which region displays an element in a named flow.
        Should we add such an API? How would it work in a 'multi-view' context
        as suggested by Alex.</p>
    </div>
    
    <h3 id="region-flow-layout-events">Region Flow Layout Events</h3>
    
    <p>Region <a href="http://www.w3.org/TR/DOM-Level-3-Events/#glossary-event">Event Targets</a> 
    dispatch <code class="idl">NamedFlowUpdate</code>s when there is a possible layout change of their named flow 
    segment.</p>
    
    <table class="event-desc" border="0" summary="This table contains information about the semantics of the given event type" cellpadding="2" cellspacing="0">
                <tbody><tr class="assert must"><th>Type</th>
                <td class="eventname"><strong><code>NamedFlowUpdate</code></strong></td></tr>
                <tr class="assert must"><th>Interface</th> <td><a href="#events-UIEvent"><code>UIEvent</code></a></td></tr>
                <tr class="assert must"><th>Sync / Async</th> <td>Sync</td></tr>
                <tr class="assert must"><th>Bubbles</th> <td>Yes</td></tr>
                <tr class="assert must"><th>Target</th> <td><code>Element</code></td></tr>
                <tr class="assert must"><th>Cancelable</th> <td>Yes</td></tr>
                <tr class="assert must"><th>Default action</th> <td>none</td></tr>
                <tr class="assert must"><th>Context info</th>
                  <td>
                    <ul>
                      <li><a href="#events-event-type-target"><code class="attribute-name">Event.target</code></a>: region whose layout may have changed</li>
                    </ul>
                   </td>
                 </tr>
              </tbody></table>
              

    <h2 id="integration-with-other-specifications">Integration with other
    specifications</h2>

    <p>This specification does not specify how regions are created or laid out.
    This section illustrates how regions can be crated and laid out with other
    specifications. It first defines the requirements for integrating CSS
    Regions. Then it provides examples for different existing solutions.</p>

    <h3 id="region-requirements">Region requirements</h3>

    <p>For a container element (or pseudo-element) to become a region, it must
    be selectable with a CSS selector and accept the content property as
    defined in this specification.</p>

    <h3 id="integration-examples">Integration Examples</h3>

    <p>Authors can use different methods to layout regions in CSS. Some
    solutions can be expressed with CSS only and not require document changes,
    some solutions leverage the document tree. The following examples
    illustrate these different options.</p>

    <h4 id="css-grid-layout">CSS Grid Layout</h4>

    <p>The CSS Grid Layout specification (see [[CSS3-GRID-LAYOUT]]) does not define a
        pseudo-element for grid cells. Consequently, grid cells cannot directly be a region.</p>
    <p>However, it is possible to simply add a <a href="http://www.w3.org/TR/CSS21/visuren.html#block-boxes">block container box</a> to a grid
        cell to make it a region.</p>

    <p>The following example shows how CSS Grid Layout could be use to create
    regions and position them to create the example given in the
    introduction.</p>

    <div class="issue resolved">
        <p><a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">Issue resolved during the July 2011 Seattle Face to Face Meeting</a>.</p>
         
        There is a pending issue in the CSS Grid Layout module draft (section
        7.2) about whether or not grid cells should generate a box and have an
        associated 'display' property. To completely allow the use-case
        presented below, ''::grid-cell'' pseudo elements should allow box
        sizing properties and behave as block level elements.
    </div>

    <div class="example">
        <pre>
&lt;style&gt;
#grid {
    display: grid;
    grid-template: "aae"
                   "bbe"
                   "cde";
}

#a { grid-cell: 'a'}
#b { grid-cell: 'b'}
#c { grid-cell: 'c'}
#d { grid-cell: 'd'}
#e { grid-cell: 'e'}

#a::before {
    content: url('illustration.png');
}

#b, #c, #d, #e {
    content: flow-from(article_flow);
}
&lt;/style&gt;

&lt;html&gt;
    &lt;body&gt;
        &lt;div id="article"&gt;...&lt;/div&gt;
        &lt;div id="grid"&gt;
            &lt;div id="a"/&gt;
            &lt;div id="b"/&gt;
            &lt;div id="c"/&gt;
            &lt;div id="d"/&gt;
            &lt;div id="e"/&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</pre>
    </div>

    <h4 id="css-multi-column-layout">CSS Multi-Column Layout</h4>

    <p>The CSS Multi-Column Layout (see [[CSS3COL]]) does not specify a
    selector for column boxes. Therefore, column boxes cannot be regions.</p>

<!--
    <p>&nbsp;</p>

    <p>The CSS Multi-Column specification could offer a pseudo-element selector
    (e.g., called ''nth-column'') for its column boxes. This would enable
    different content to flow through different columns. The following example
    illustrates how two different content flows could be threaded on alternate
    columns.</p>

    <div class="example">
        <pre>
&lt;style&gt;
body:before {
    columns: 4;
}

body:before::nth-column(even) {
    content: flow-from(article_1_flow);
}

body:before::nth-column(odd) {
    content: flow-from(article_2_flow);
}
&lt;/style&gt;

&lt;body&gt;
    &lt;div id="article_1"&gt;...&lt;/div&gt;
    &lt;div id="article_2"&gt;...&lt;/div&gt;
&lt;/body&gt;
</pre>
    </div>

    <p>Note that if a column box becomes associated with a flow by its content
    property, it is no longer associated to the 'column flow', as discussed
    <a href="column-flow">before</a>. For example, if the second column in a
    multi column element was associated with the 'illustration' named flow, the
    regular 'column-flow' would thread through the first and third column while
    column two would flow content from the 'illustration' named flow.</p>
-->

    <h4 id="css-visual-formatting">CSS Visual Formatting</h4>

    <p>CSS (see [[CSS21]]) offers a way to visually format content with
    different layout schemes: inline and block formatting, float, absolute
    positioning, relative positioning or table layout.</p>

    <p>Elements laid out using these schemes can be regions, as illustrated
    below, using absolutely positioned elements for simplicity.</p>

    <div class="example">
        <pre>
&lt;style&gt;
#article {
    flow-into: article_flow;
}

#region_1, #region_2, #region_3, #region_4 {
    content: flow-from(article_flow);
}

#region_1 {
    /* positioning properties */
}

/* ... positioning of other regions ... */

&lt;/style&gt;
&lt;html&gt;
    &lt;body&gt;
        &lt;div id="article"&gt;...&lt;/div&gt;
        &lt;div id="region_A"&gt;&lt;/div&gt;
        &lt;div id="region_1"&gt;&lt;/div&gt;
        &lt;div id="region_2"&gt;&lt;/div&gt;
        &lt;div id="region_3"&gt;&lt;/div&gt;
        &lt;div id="region_4"&gt;&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
  
</pre>
    </div>

    <h2 id="relation-to-other-specifications">Relation to other
    specifications</h2>

    <p>This specification is related to other specifications as described in
    the <a href='#references'>references</a> section. In addition, it is
    related to the following specifications:</p>

    <ol>
        <li>CSS Exclusions Module [[CSS3EXCLUSIONS]]. This module defines a
        generic way to define arbitrarily shaped exclusions into which content
        can flow or around which content can flow. This can be seen as an
        extension to the way CSS floats provide rectangular areas into which
        content flows and around which content flows. In advanced layout
        designs, it is expected that the CSS Exclusions module will be commonly
        combined with the CSS Regions module.</li>

        <li>CSS Line Grid Module [[CSS3LINEGRID]]. This module defines a
        concept of line grid to align the position of lines in different
        elements. The line grid functionality is related and needed for
        aligning content flowing in separate regions.</li>
    </ol>

    <h2 id="conformance">Conformance</h2>
    
    <h2 id="changes">Changes</h2>

    <h3 id="changes_from_June_09_2011">Changes from <a href="http://www.w3.org/TR/2011/WD-css3-regions-20110609/">June 09<sup>th</sup> 2011</a> version</h3>
    
    <ul>
        <li>Made 'content-order' a &lt;integer&gt; and not a &lt;float&gt; following a working group
            <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0329.html">resolution</a></li>
        <li>Added Alex Mogilevsky as an editor</li>
        <li>Flow names became &lt;indent&gt; instead of &lt;string&gt; following a working group
            <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0413.html">resolution</a></li>
        <li>Removed issue about possibly altering the DOM Events model for region events following
            a working group
            <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0413.html">resolution</a></li>
        <li>Made the "relation to document events" section informative following a     working group
            <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0413.html">resolution</a></li>
        <li>Removed issue in section "The NamedFlow interface" following the working group's 
            <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0413.html">resolution</a> to
            have both NamedFlow and the Element interface extension</li>
        <li>Following a working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0413.html">resolution</a>:
        	<ul>
            	<li>Turned the first issue in the "Extensions to the Element interface" into a note 
            explaining that the NamedFlow interface can be used when regions are pseudo-elements.</li>
            	<li>Added NamedFlowUpdate</li>
                </ul>
        </li>
        <li>Excluded 'none', 'inherit' and 'initial' from the possible identifier names on 
        	the flow property following <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0583.html">discussion</a> on the mailing list.</li>
        <li>Simplified integration discussion on multi-column layout and just state that since
        column boxes are not addressable by selectors, they cannot be regions.</li>
        <li>Added specification of how the 'flow-into' property interacts with object, embed and iframe 
        elements.</li>
        <li>Excluded 'default' from the possible identifier names on the flow property because it 
            <a href="http://www.w3.org/TR/2006/WD-css3-values-20060919/#keywords">may get reserved</a>.</li>
        <li>Added to the definition of 'auto' on 'region-overflow' specifying that region breaks must
            be ignored.</li>
        <li>Renamed 'Document.flowWithName' to 'Document.getFlowByName' since it is not a property.</li>
        <li>Added a note that a 'NamedFlow' instance is live.</li>
        <li>Added an 'undefined' string value to the regionOverflow property on the Element interface 
            extension.</li>
        <li>Renamed NamedFlowEvent to NamedFlowUpdate to avoid having 'Event' in the event name.</li>
		<li>Added description for special behavior of iframe/object/embed as 
		flow source</li>
		<li>Removed issue on copying content to a named flow instead of moving elements to named
		    flow following working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">resolution</a>.</li>
    	<li>Removed issue on content:flow-from v.s., flow-from property following working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">resolution</a>.</li>
    	<li>Renamed 'flow' to 'flow-into' following working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">resolution</a>.</li>
    	<li>Updated the css3-grid-align example following working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">resolution</a> that 
    	    it should use &lt;div&gt; instead of grid-cell pseudo elements that were removed
    	    from the CSS Grid Layout specification.</li>
        <li>Renamed 'from-flow' to 'flow-from' following a working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">resolution</a>.</li>
        <li>Limited the applicability of 'content: flow-from()' to block container box and added
            a note that this might be expanded in the future, following a working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">resolution</a>.</li>
        <li>Removed issue about API to find which region displays an element in a named flow
            since <a href="http://www.w3.org/Style/CSS/Tracker/actions/350">ACTION-350</a> was
            created to add this API.</li>
        
    </ul>
    
    <h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

    <h2 class="no-num" id="references">References</h2>

    <h3 class="no-num" id="normative-references">Normative references</h3>
    <!--begin-normative--><!--end-normative-->

    <h3 class="no-num" id="other-references">Other references</h3>
    <!--begin-informative--><!--end-informative-->

    <h2 class="no-num" id="index">Index</h2><!--index-->

    <h2 class="no-num" id="property-index">Property index</h2>
    <!-- properties -->
    <!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
</body>
</html>
