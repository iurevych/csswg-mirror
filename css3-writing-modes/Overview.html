<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html lang=en>
 <head><meta content="text/html; charset=utf-8" http-equiv=Content-Type>

  <title>CSS Writing Modes Module Level 3</title>
  <link href="../default.css" rel=stylesheet type="text/css">

  <style type="text/css">
    object { vertical-align: middle; }
    .sidebar { float: right; background: #eee; border: solid gray; margin: 1em; }
    .landscape { height: 10em; }
    .portrait { width: 10em; }
    .sidebar .figure { margin: 1em; }
    .sidebar object { margin: 0 auto; display: block; }
    .figurepair { display: table; margin: 1em auto; }
    .figurepair .figure { display: table-cell; }
     h2 { clear: both; }
  </style>
  <link href="http://www.w3.org/StyleSheets/tr/W3C-ED.css" rel=stylesheet
  type="text/css">

 <body>
  <div class=head> <!--begin-logo-->
   <p><a href="http://www.w3.org/"><img alt=W3C height=48
    src="http://www.w3.org/Icons/w3c_home" width=72></a> <!--end-logo-->

   <h1>CSS Writing Modes Module Level 3</h1>

   <h2 class="no-num no-toc" id=longstatus-date>Editor's Draft 10 November
    2010</h2>

   <dl>
    <dt>This version:

    <dd><a
     href="http://dev.w3.org/csswg/css3-writing-modes/">http://dev.w3.org/csswg/css3-writing-modes/</a>
     

    <dt>Latest version:

    <dd><a
     href="http://www.w3.org/TR/css3-writing-modes/">http://www.w3.org/TR/css3-writing-modes/</a>

    <dt>Previous version:

    <dd><a
     href="http://www.w3.org/TR/2003/CR-css3-text-20030514/">http://www.w3.org/TR/2003/CR-css3-text-20030514/</a>

    <dt>Editors:

    <dd><a href="http://fantasai.inkedblade.net/contact">Elika J. Etemad</a>
     (Invited Expert)

    <dd><a href="mailto:kojiishi@gluesoft.co.jp">Koji Ishii</a> (<a
     href="http://www.antenna.co.jp/">Antenna House</a>)

    <dd><a href="mailto:murakami@antenna.co.jp">Shinyu Murakami</a> (<a
     href="http://www.antenna.co.jp/">Antenna House</a>)

    <dt>Previous Editors:

    <dd><a href="mailto:paulnel@microsoft.com">Paul Nelson</a> (<a
     href="http://www.microsoft.com/">Microsoft</a>)

    <dd><a href="mailto:michelsu@microsoft.com">Michel Suignard</a> (<a
     href="http://www.microsoft.com/">Microsoft</a>)
   </dl>
   <!--begin-copyright-->
   <p class=copyright><a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright"
    rel=license>Copyright</a> &copy; 2010 <a
    href="http://www.w3.org/"><acronym title="World Wide Web
    Consortium">W3C</acronym></a><sup>&reg;</sup> (<a
    href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute
    of Technology">MIT</acronym></a>, <a href="http://www.ercim.eu/"><acronym
    title="European Research Consortium for Informatics and
    Mathematics">ERCIM</acronym></a>, <a
    href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>
    and <a
    href="http://www.w3.org/Consortium/Legal/copyright-documents">document
    use</a> rules apply.</p>
   <!--end-copyright-->
   <hr title="Separator for header">
  </div>

  <h2 class="no-num no-toc" id=abstract>Abstract</h2>

  <p>This module specifies the text layout model in CSS and the properties
   that control it. It covers bidirectional and vertical text.

  <h2 class="no-num no-toc" id=status>Status of this document</h2>
  <!--begin-status-->

  <p>This is a public copy of the editors' draft. It is provided for
   discussion only and may change at any moment. Its publication here does
   not imply endorsement of its contents by W3C. Don't cite this document
   other than as work in progress.

  <p>The (<a
   href="http://lists.w3.org/Archives/Public/www-style/">archived</a>) public
   mailing list <a
   href="mailto:www-style@w3.org?Subject=%5Bcss3-writing-modes%5D%20PUT%20SUBJECT%20HERE">
   www-style@w3.org</a> (see <a
   href="http://www.w3.org/Mail/Request">instructions</a>) is preferred for
   discussion of this specification. When sending e-mail, please put the text
   &#8220;css3-writing-modes&#8221; in the subject, preferably like this:
   &#8220;[<!---->css3-writing-modes<!---->] <em>&hellip;summary of
   comment&hellip;</em>&#8221;

  <p>This document was produced by the <a href="/Style/CSS/members">CSS
   Working Group</a> (part of the <a href="/Style/">Style Activity</a>).

  <p>This document was produced by a group operating under the <a
   href="/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent
   Policy</a>. W3C maintains a <a href="/2004/01/pp-impl/32061/status"
   rel=disclosure>public list of any patent disclosures</a> made in
   connection with the deliverables of the group; that page also includes
   instructions for disclosing a patent. An individual who has actual
   knowledge of a patent which the individual believes contains <a
   href="/Consortium/Patent-Policy-20040205/#def-essential">Essential
   Claim(s)</a> must disclose the information in accordance with <a
   href="/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the
   W3C Patent Policy</a>.</p>
  <!--end-status-->

  <h2 class="no-num no-toc" id=Contents>Contents</h2>
  <!--begin-toc-->

  <ul class=toc>
   <li><a href="#intro"><span class=secno>1. </span>Introduction</a>

   <li><a href="#text-flow"><span class=secno>2. </span>Writing Modes and
    Terminology</a>

   <li><a href="#text-direction"><span class=secno>3. </span>Inline Direction
    and Bidirectionality</a>
    <ul class=toc>
     <li><a href="#direction"><span class=secno>3.1. </span>Specifying
      Directionality: the &lsquo;<code class=property>direction</code>&rsquo;
      property</a>

     <li><a href="#unicode-bidi"><span class=secno>3.2. </span>Embeddings and
      Overrides: the &lsquo;<code class=property>uncode-bidi</code>&rsquo;
      property</a>

     <li><a href="#bidi-example"><span class=secno>3.3. </span>Example of
      Bidirectional Text</a>

     <li><a href="#bidi-box-model"><span class=secno>3.4. </span>Box model
      for inline elements in bidirectional context</a>
    </ul>

   <li><a href="#writing-mode"><span class=secno>4. </span>Block Flow
    Direction: the &lsquo;<code class=property>writing-mode</code>&rsquo;
    property</a>
    <ul class=toc>
     <li><a href="#vertical-layout"><span class=secno>4.1. </span>Box Layout
      in Vertical Writing Modes</a>
    </ul>

   <li><a href="#line-orientation"><span class=secno>5. </span>Line
    Orientation</a>
    <ul class=toc>
     <li><a href="#text-orientation"><span class=secno>5.1. </span>Orienting
      Text: the &lsquo;<code class=property>text-orientation</code>&rsquo;
      property</a>
    </ul>

   <li><a href="#text-combine"><span class=secno>6. </span>Glyph Composition:
    the &lsquo;<code class=property>text-combine</code>&rsquo; property</a>

   <li><a href="#abstract-layout"><span class=secno>7. </span>Abstract Box
    Layout</a>
    <ul class=toc>
     <li><a href="#dimensions"><span class=secno>7.1. </span>Logical vs
      Physical Dimensions</a>
      <ul class=toc>
       <li><a href="#orthogonal-flows"><span class=secno>7.1.1.
        </span>Orthogonal Flows</a>
      </ul>

     <li><a href="#directions"><span class=secno>7.2. </span>Logical vs
      Physical Directions</a>
      <ul class=toc>
       <li><a href="#block-directions"><span class=secno>7.2.1.
        </span>Logical Directions</a>

       <li><a href="#line-directions"><span class=secno>7.2.2.
        </span>Line-Relative Directions</a>

       <li><a href="#logical-to-physical"><span class=secno>7.2.3.
        </span>Abstract-to-Physical Mappings</a>

       <li><a href="#physical-only"><span class=secno>7.2.4. </span>Purely
        Physical Properties</a>

       <li><a href="#caption-side"><span class=secno>7.2.5. </span>The
        &lsquo;<code class=property>caption-side</code>&rsquo; property</a>
      </ul>

     <li><a href="#html-attributes"><span class=secno>7.3. </span>HTML
      Attributes</a>
      <ul class=toc>
       <li><a href="#width-height-attributes"><span class=secno>7.3.1.
        </span>The <code>width</code> and <code>height</code> attributes</a>

       <li><a href="#alignment-attributes"><span class=secno>7.3.2.
        </span>Alignment, Float and Clear Attributes</a>

       <li><a href="#spacing-attributes"><span class=secno>7.3.3.
        </span>Spacing Attributes</a>
      </ul>
    </ul>

   <li><a href="#logical-controls"><span class=secno>8. </span>Logical
    Properties and Values</a>
    <ul class=toc>
     <li><a href="#logical-value"><span class=secno>8.1. </span>Logical
      Directional Values: before, after, start, end</a>

     <li><a href="#logical-page"><span class=secno>8.2. </span>Logical Page
      Classifications</a>

     <li><a href="#logical-properties"><span class=secno>8.3. </span>Logical
      Properties</a>
      <ul class=toc>
       <li><a href="#logical-dimension-properties"><span class=secno>8.3.1.
        </span>Logical Height and Logical Width: the &lsquo;<code
        class=property>length</code>&rsquo; and &lsquo;<code
        class=property>measure</code>&rsquo; properties</a>

       <li><a href="#logical-prop"><span class=secno>8.3.2. </span>Logical
        Margins and Offsets: : the margin- and offset- before/after/start/end
        properties</a>

       <li><a href="#border-padding"><span class=secno>8.3.3. </span>Logical
        Padding and Border: the padding- and border-<var>*</var>-
        before/after/start/end properties</a>

       <li><a href="#logical-shorthand-keyword"><span class=secno>8.3.4.
        </span>Shorthand Properties with &lsquo;<code
        class=css>logical</code>&rsquo; Keyword</a>
      </ul>

     <li><a href="#background-and-borders"><span class=secno>8.4.
      </span>Logical Background and Border Images</a>
      <ul class=toc>
       <li><a href="#background-image-transform-prop"><span
        class=secno>8.4.1. </span>Background Image Transform: The
        &lsquo;<code class=property>background-image-transform</code>&rsquo;
        property</a>

       <li><a href="#background-repeat-prop"><span class=secno>8.4.2.
        </span>The &lsquo;<code
        class=property>background-repeat</code>&rsquo; property</a>

       <li><a href="#border-image-transform-prop"><span class=secno>8.4.3.
        </span>Border Image Transform: The &lsquo;<code
        class=property>border-image-transform</code>&rsquo; property</a>
      </ul>
    </ul>

   <li><a href="#acknowledgements"><span class=secno>9.
    </span>Acknowledgements</a>

   <li><a href="#bidi-html"><span class=secno>10. </span>Appendix B: Bidi
    Rules for HTML</a>
  </ul>
  <!--end-toc-->

  <h2 id=intro><span class=secno>1. </span>Introduction</h2>

  <p>This module defines support for various international writing
   directions, such as left-to-right (e.g., Latin scripts), right-to-left
   (e.g., Hebrew or Arabic), bidirectional (e.g., mixing Latin with Arabic)
   and vertical (e.g., Asian scripts).

  <p>Inherently bottom-to-top scripts are not handled in this version. See
   [[UTN22]] for an explanation of relevant issues.

  <h2 id=text-flow><span class=secno>2. </span>Writing Modes and Terminology</h2>

  <p>A <dfn id=writing-mode0>writing mode</dfn> in CSS is determined by the
   &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;, &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;, and
   &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo; properties. It is
   defined primarily in terms of its <a
   href="#inline-base-direction"><i>inline base direction</i></a> and <a
   href="#block-flow-direction"><i>block flow direction</i></a>:

  <div class=sidebar>
   <div class="figure right"> <object class=landscape
    data="diagrams/text-flow-vectors-tb.svg" type="image/svg+xml"></object>
    <p class=caption>Latin-based writing mode
   </div>

   <div class="figure left"> <object class=portrait
    data="diagrams/text-flow-vectors-lr-reverse.svg"
    type="image/svg+xml"></object>
    <p class=caption>Mongolian-based writing mode
   </div>

   <div class="figure right"> <object class=landscape
    data="diagrams/text-flow-vectors-tb.svg" type="image/svg+xml"></object>
    <object class=portrait data="diagrams/text-flow-vectors-rl.svg"
    type="image/svg+xml"></object>
    <p class=caption>Han-based writing mode
   </div>
  </div>

  <p>The <dfn id=inline-base-direction>inline base direction</dfn> is the
   primary direction in which content is ordered on a line and defines on
   which sides the "start" and "end" of a line are. The &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;
   property specifies the inline base direction of an element and, together
   with the &lsquo;<a href="#unicode-bidi0"><code
   class=property>unicode-bidi</code></a>&rsquo; property and the inherent
   directionality of any text content, determines the ordering of
   inline-level content within a line.

  <p>The <dfn id=block-flow-direction>block flow direction</dfn> is the
   direction in which block-level boxes stack and the direction in which line
   boxes stack within a block container. The &lsquo;<a
   href="#writing-mode1"><code class=property>writing-mode</code></a>&rsquo;
   property determines the block flow direction.

  <p>A <dfn id=horizontal-writing-mode>horizontal writing mode</dfn> is one
   with horizontal lines of text, i.e. a downward or upward block flow. A
   <dfn id=vertical-writing-mode>vertical writing mode</dfn> is one with
   vertical lines of text, i.e. a leftward or rightward block flow.

  <p class=note>These terms should not be confused with <dfn
   id=vertical-block-flow>vertical block flow</dfn> (which is a downward or
   upward block flow) and <dfn id=horizontal-block-flow>horizontal block
   flow</dfn> (which is leftward or rightward block flow). To avoid
   confusion, the CSS specifications avoid this latter set of terms.

  <p>Writing systems typically have one or two native writing modes. Some
   examples are:

  <ul>
   <li>Latin-based systems are typically written using a left-to-right inline
    direction with a downward (top-to-bottom) block flow direction.

   <li>Arabic-based systems are typically written using a right-to-left
    inline direction with a downward (top-to-bottom) block flow direction.

   <li>Mongolian-based systems are typically written using a top-to-bottom
    inline direction with a rightward (left-to-right) block flow direction.

   <li>Han-based systems are commonly written using a left-to-right inline
    direction with a downward (top-to-bottom) block flow direction,
    <strong>or</strong> a top-to-bottom inline direction with a leftward
    (right-to-left) block flow direction. Many magazines and newspapers will
    mix these two writing modes on the same page.
  </ul>

  <p>Some additional characteristics, the line orientation and glyph
   orientation, are primarily used to handle scripts placed in a non-native
   writing mode. The <dfn id=line-orientation0>line orientation</dfn>
   determines which side of the line is the "top" and thus which sides are
   <dfn id=under>under</dfn> or <dfn id=over>over</dfn> the line. This
   determines the interpretation of alignment in the transverse dimension of
   the line. It also determines the default <dfn id=glyph-orientation>glyph
   orientation</dfn> for scripts in a non-native orientation. These
   characteristics are controlled by the &lsquo;<a
   href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo; property.

  <p class=note>See Unicode Technical Note #22 [[UTN22]] (<a
   href="http://fantasai.inkedblade.net/style/discuss/vertical-text/paper">HTML
   version</a>) for a more in-depth introduction to writing modes and
   vertical text.

  <h2 id=text-direction><span class=secno>3. </span>Inline Direction and
   Bidirectionality</h2>

  <p>While the characters in most scripts are written from left to right,
   certain scripts are written from right to left. In some documents, in
   particular those written with the Arabic or Hebrew script, and in some
   mixed-language contexts, text in a single (visually displayed) block may
   appear with mixed directionality. This phenomenon is called <span
   class=index-def id=bidirectionality title="bidirectionality (bidi)"><dfn
   id=bidirectionality0>bidirectionality</dfn></span>, or "bidi" for short.

  <p>The Unicode standard (<a
   href="http://www.unicode.org/reports/tr9/">Unicode Standard Annex #9</a>)
   defines a complex algorithm for determining the proper ordering of
   bidirectional text. The algorithm consists of an implicit part based on
   character properties, as well as explicit controls for embeddings and
   overrides. CSS relies on this algorithm to achieve proper bidirectional
   rendering. The <span class=propinst-direction>&lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;</span>
   and <span class=propinst-unicode-bidi>&lsquo;<a
   href="#unicode-bidi0"><code
   class=property>unicode-bidi</code></a>&rsquo;</span> properties allow
   authors to specify how the elements and attributes of a document language
   map to this algorithm.

  <p>User agents that support bidirectional text must apply the Unicode
   bidirectional algorithm to every sequence of inline boxes uninterrupted by
   a forced (<a
   href="http://www.unicode.org/reports/tr9/#Bidirectional_Character_Types">bidi
   class B</a>) line break or block boundary. This sequence forms the
   "paragraph" unit in the bidirectional algorithm. The paragraph embedding
   level is set according to the value of the &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;
   property of the containing block rather than by the heuristic given in
   steps P2 and P3 of the Unicode algorithm.

  <p>Because the base directionality of a text depends on the structure and
   semantics of the document, these properties should in most cases be used
   only to map bidi information in the markup to its corresponding CSS
   styles. If a document language provides markup features to control bidi,
   authors and users should use those features and not specify CSS rules to
   override them.

  <p>The HTML 4 specification (<a href="#HTML401"
   rel=biblioentry>[HTML401]<!--{{HTML401}}--></a>, section 8.2) defines
   bidirectionality behavior for HTML elements. The HTML 4 specification also
   contains more information on bidirectionality issues.

  <p class=note>Because HTML UAs can turn off CSS styling, we advise HTML
   authors to use the HTML &lsquo;<code class=property>dir</code>&rsquo;
   attribute and &lt;bdo&gt; element to ensure correct bidirectional layout
   in the absence of a style sheet.

  <h3 id=direction><span class=secno>3.1. </span>Specifying Directionality:
   the &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; property</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=direction0>direction</dfn>

    <tr>
     <th>Value:

     <td>ltr | rtl

    <tr>
     <th>Initial:

     <td>ltr

    <tr>
     <th>Applies to:

     <td>all elements

    <tr>
     <th>Inherited:

     <td>yes

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>specified value
  </table>

  <p>This property specifies the base directionality of text and elements on
   a line, and the directionality of embeddings and overrides (see &lsquo;<a
   href="#unicode-bidi0"><code class=property>unicode-bidi</code></a>&rsquo;)
   for the Unicode bidirectional algorithm. In addition, it affects the
   ordering of <a href="http://www.w3.org/TR/CSS21/tables.html">table</a>
   column layout, the direction of horizontal <a
   href="http://www.w3.org/TR/CSS21/visufx.html#overflow">overflow</a>, and
   the default alignment of text within a line, and other things that depend
   on the base inline base direction.

  <p>Values for this property have the following meanings:

  <dl>
   <dt><strong>ltr</strong>

   <dd>Left-to-right directionality.

   <dt><strong>rtl</strong>

   <dd>Right-to-left directionality.
  </dl>

  <p class=note>The &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; property has no reordering in
   inline-level elements whose &lsquo;<a href="#unicode-bidi0"><code
   class=property>unicode-bidi</code></a>&rsquo; property's value is
   &lsquo;<code class=css>normal</code>&rsquo;.

  <p>The value of the &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; property on the root element is
   also propagated to the initial containing block and, together with the
   &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; property, determines the
   document's principal writing mode. (See <a
   href="#principal-writing-mode">below</a>.)

  <p class=note>Note that the &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; property of the HTML BODY
   element is <em>not</em> propagated to the viewport. That special behavior
   only applies to the background and overflow properties.

  <p class=note>The &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; property, when specified for
   table column elements, is not inherited by cells in the column since
   columns are not the ancestors of the cells in the document tree. Thus, CSS
   cannot easily capture the "dir" attribute inheritance rules described in
   <a href="#HTML401" rel=biblioentry>[HTML401]<!--{{HTML401}}--></a>,
   section 11.3.2.1.

  <h3 id=unicode-bidi><span class=secno>3.2. </span>Embeddings and Overrides:
   the &lsquo;<code class=property>uncode-bidi</code>&rsquo; property</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=unicode-bidi0>unicode-bidi</dfn>

    <tr>
     <th>Value:

     <td>normal | ( embed | isolate ) || ( plaintext | bidi-override )

    <tr>
     <th>Initial:

     <td>normal

    <tr>
     <th>Applies to:

     <td>all elements, but see prose

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>specified value
  </table>

  <p>Values for this property have the following meanings:

  <dl>
   <dt><strong>normal</strong>

   <dd>The element does not open an additional level of embedding with
    respect to the bidirectional algorithm. For inline-level elements,
    implicit reordering works across element boundaries.

   <dt><strong>embed</strong>

   <dd>If the element is inline-level, this value opens an additional level
    of embedding with respect to the bidirectional algorithm. The direction
    of this embedding level is given by the &lsquo;<a
    href="#direction0"><code class=property>direction</code></a>&rsquo;
    property. Inside the element, reordering is done implicitly. This
    corresponds to adding a LRE (U+202A; for &lsquo;<code
    class=css>direction: ltr</code>&rsquo;) or RLE (U+202B; for &lsquo;<code
    class=css>direction: rtl</code>&rsquo;) at the start of the element and a
    PDF (U+202C) at the end of the element.

   <dt><strong>bidi-override</strong>

   <dd>For inline-level elements this creates an override. For block-level,
    table-cell, table-caption, or inline-block elements this creates an
    override for inline-level descendants not within another block-level,
    table-cell, table-caption, or inline-block element. This means that
    inside the element, reordering is strictly in sequence according to the
    <span class=propinst-direction>&lsquo;<a href="#direction0"><code
    class=property>direction</code></a>&rsquo;</span> property; the implicit
    part of the bidirectional algorithm is ignored. This corresponds to
    adding a LRO (U+202D; for &lsquo;<code class=css>direction:
    ltr</code>&rsquo;) or RLO (U+202E; for &lsquo;<code class=css>direction:
    rtl</code>&rsquo;) at the start of the element and a PDF (U+202C) at the
    end of the element.

   <dt><strong>isolate</strong>

   <dd>For the purposes of the Unicode bidirectional algorithm, the contents
    of the element are considered to be inside a separate, independent
    paragraph, and for the purpose of bidi resolution in its containing bidi
    paragraph (if any), the element itself is treated as if it were an Object
    Replacement Character (U+FFFC). (If the element is broken across multiple
    lines, then each box of the element is treated as an Object Replacement
    Character.)

   <dt><strong>plaintext</strong>

   <dd>
    <p>For the purposes of the Unicode bidirectional algorithm, the base
     directionality of each "paragraph" for which the element is the
     containing block element is determined not by the element's computed
     &lsquo;<a href="#direction0"><code
     class=property>direction</code></a>&rsquo; as usual, but by following
     rules P1, P2, and P3 of the Unicode bidirectional algorithm. However, if
     no direction-determining character is found in step P2, then the value
     of the &lsquo;<a href="#direction0"><code
     class=property>direction</code></a>&rsquo; property is used instead.
     Note this value has no effect on inline elements.
  </dl>

  <p>The final order of characters in each block-level element is the same as
   if the bidi control codes had been added as described above, markup had
   been stripped, and the resulting character sequence had been passed to an
   implementation of the Unicode bidirectional algorithm for plain text that
   produced the same line-breaks as the styled text. In this process,
   non-textual entities such as images are treated as neutral characters,
   unless their <span class=propinst-unicode-bidi>&lsquo;<a
   href="#unicode-bidi0"><code
   class=property>unicode-bidi</code></a>&rsquo;</span> property has a value
   other than &lsquo;<code class=property>normal</code>&rsquo;, in which case
   they are treated as strong characters in the <span
   class=propinst-direction>&lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo;</span> specified for the
   element.

  <p>Please note that in order to be able to flow inline boxes in a uniform
   direction (either entirely left-to-right or entirely right-to-left), more
   inline boxes (including anonymous inline boxes) may have to be created,
   and some inline boxes may have to be split up and reordered before
   flowing.

  <p>Because the Unicode algorithm has a limit of <em title="According to
   unicode 3.0, chapter 3, section 12, definition BD2. Specifically, page 58
   here: http://www.unicode.org/unicode/uni2book/ch03.pdf"> 61 levels</em> of
   embedding, care should be taken not to use <span
   class=propinst-unicode-bidi>&lsquo;<a href="#unicode-bidi0"><code
   class=property>unicode-bidi</code></a>&rsquo;</span> with a value other
   than &lsquo;<code class=property>normal</code>&rsquo; unless appropriate.
   In particular, a value of &lsquo;<code
   class=property>inherit</code>&rsquo; should be used with extreme caution.
   However, for elements that are, in general, intended to be displayed as
   blocks, a setting of &lsquo;<code class=css>unicode-bidi:
   isolate</code>&rsquo; is preferred to keep the element together in case
   display is changed to inline (see example below).

  <p>The following example shows an XML document with bidirectional text. It
   illustrates an important design principle: document language designers
   should take bidi into account both in the language proper (elements and
   attributes) and in any accompanying style sheets. The style sheets should
   be designed so that bidi rules are separate from other style rules, and
   such rules should not be overridden by other style sheets so that the
   document language's bidi behavior is preserved.

  <h3 id=bidi-example><span class=secno>3.3. </span>Example of Bidirectional
   Text</h3>

  <div class=example>
   <p>In this example, lowercase letters stand for inherently left-to-right
    characters and uppercase letters represent inherently right-to-left
    characters. The text stream is shown in logical backing store order.</p>

   <pre class=xml-example><code class=xml>
&lt;HEBREW&gt;
  &lt;PAR&gt;HEBREW1 HEBREW2 english3 HEBREW4 HEBREW5&lt;/PAR&gt;
  &lt;PAR&gt;HEBREW6 &lt;EMPH&gt;HEBREW7&lt;/EMPH&gt; HEBREW8&lt;/PAR&gt;
&lt;/HEBREW&gt;
&lt;ENGLISH&gt;
  &lt;PAR&gt;english9 english10 english11 HEBREW12 HEBREW13&lt;/PAR&gt;
  &lt;PAR&gt;english14 english15 english16&lt;/PAR&gt;
  &lt;PAR&gt;english17 &lt;HE-QUO&gt;HEBREW18 english19 HEBREW20&lt;/HE-QUO&gt;&lt;/PAR&gt;
&lt;/ENGLISH&gt;
    </code></pre>

   <p>Since this is arbitrary XML, the style sheet is responsible for setting
    the writing direction. This is the style sheet:</p>

   <pre>
/* Rules for bidi */
HEBREW, HE-QUO  {direction: rtl; unicode-bidi: embed;}
ENGLISH         {direction: ltr; unicode-bidi: embed;} 

/* Rules for presentation */
HEBREW, ENGLISH, PAR  {display: block;}
EMPH                  {font-weight: bold;}
    </pre>

   <p>The HEBREW element is a block with a right-to-left base direction, the
    ENGLISH element is a block with a left-to-right base direction. The PARs
    are blocks that inherit the base direction from their parents. Thus, the
    first two PARs are read starting at the top right, the final three are
    read starting at the top left. Please note that HEBREW and ENGLISH are
    chosen as element names for explicitness only; in general, element names
    should convey structure without reference to language.</p>

   <p>The EMPH element is inline-level, and since its value for <span
    class=propinst-unicode-bidi>&lsquo;<a href="#unicode-bidi0"><code
    class=property>unicode-bidi</code></a>&rsquo;</span> is &lsquo;<code
    class=property>normal</code>&rsquo; (the initial value), it has no effect
    on the ordering of the text. The HE-QUO element, on the other hand,
    creates an embedding.</p>

   <p>The formatting of this text might look like this if the line length is
    long:</p>

   <pre class=ascii-art>
               5WERBEH 4WERBEH english3 2WERBEH 1WERBEH

                                8WERBEH <b>7WERBEH</b> 6WERBEH

english9 english10 english11 13WERBEH 12WERBEH

english14 english15 english16

english17 20WERBEH english19 18WERBEH
    </pre>

   <p>Note that the HE-QUO embedding causes HEBREW18 to be to the right of
    english19.</p>

   <p>If lines have to be broken, it might be more like this:</p>

   <pre class=ascii-art>
       2WERBEH 1WERBEH
  -EH 4WERBEH english3
                 5WERB

   -EH <b>7WERBEH</b> 6WERBEH
                 8WERB

english9 english10 en-
glish11 12WERBEH
13WERBEH

english14 english15
english16

english17 18WERBEH
20WERBEH english19
    </pre>

   <p>Because HEBREW18 must be read before english19, it is on the line above
    english19. Just breaking the long line from the earlier formatting would
    not have worked. Note also that the first syllable from english19 might
    have fit on the previous line, but hyphenation of left-to-right words in
    a right-to-left context, and vice versa, is usually suppressed to avoid
    having to display a hyphen in the middle of a line.</p>
  </div>
  <!-- example -->

  <h3 id=bidi-box-model><span class=secno>3.4. </span>Box model for inline
   elements in bidirectional context</h3>
  <!-- CSS2.1 8.6 -->

  <p>For each line box, UAs must take the inline boxes generated for each
   element and render the margins, borders and padding in visual order (not
   logical order).

  <p>When the element's &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; property is &lsquo;<code
   class=css>ltr</code>&rsquo;, the left-most generated box of the first line
   box in which the element appears has the left margin, left border and left
   padding, and the right-most generated box of the last line box in which
   the element appears has the right padding, right border and right margin.

  <p>When the element's &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; property is &lsquo;<code
   class=css>rtl</code>&rsquo;, the right-most generated box of the first
   line box in which the element appears has the right padding, right border
   and right margin, and the left-most generated box of the last line box in
   which the element appears has the left margin, left border and left
   padding.

  <h2 id=writing-mode><span class=secno>4. </span>Block Flow Direction: the
   &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; property</h2>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=writing-mode1>writing-mode</dfn>

    <tr>
     <th>Value:

     <td>horizontal-tb | vertical-rl | vertical-lr | horizontal-bt

    <tr>
     <th>Initial:

     <td>horizontal-tb

    <tr>
     <th>Applies to:

     <td>All elements except table row groups, table column groups, table
      rows, and table columns

    <tr>
     <th>Inherited:

     <td>yes

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>specified value
  </table>

  <p>This property sets the block flow direction. Possible values:

  <dl>
   <dt>horizontal-tb

   <dd>Top-to-bottom block flow. The writing mode is horizontal.

   <dt>vertical-rl

   <dd>Right-to-left block flow. The writing mode is vertical.

   <dt>vertical-lr

   <dd>Left-to-right block flow. The writing mode is vertical.

   <dt>horizontal-bt

   <dd>Bottom-to-top block flow. The writing mode is horizontal.
  </dl>

  <p>SVG1.1 <a href="#SVG11" rel=biblioentry>[SVG11]<!--{{!SVG11}}--></a>
   defines some additional values: &lsquo;<code class=css>lr</code>&rsquo;,
   &lsquo;<code class=css>lr-tb</code>&rsquo;, &lsquo;<code
   class=css>rl</code>&rsquo;, &lsquo;<code class=css>rl-tb</code>&rsquo;,
   &lsquo;<code class=css>tb</code>&rsquo;, and &lsquo;<code
   class=css>tb-rl</code>&rsquo;. These values are <em>deprecated</em> in any
   context except SVG1 documents. Implementations that wish to support them
   in the context of CSS must treat these values as follows:

  <table class=data>
   <thead>
    <tr>
     <th>SVG1

     <th>CSS

   <tbody>
    <tr>
     <td>lr

     <td rowspan=3>horizontal-tb

    <tr>
     <td>lr-tb

    <tr>
     <td>rl

    <tr>
     <td>tb

     <td rowspan=2>vertical-rl

    <tr>
     <td>tb-rl
  </table>

  <p class=note>In SVG1.1, these values set the <dfn
   id=inline-progression-direction>inline progression direction</dfn>, in
   other words, the direction the current text position advances each time a
   glyph is added. This is a geometric process that happens <a
   href="#after"><em>after</em></a> bidi reordering, and thus has no effect
   on the interpretation of the &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; property (which is independent
   of &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;). (See <a
   href="http://www.w3.org/TR/SVG/text.html#RelationshipWithBiDirectionality">Relationship
   with bidirectionality</a>. <a href="#SVG11"
   rel=biblioentry>[SVG11]<!--{{!SVG11}}--></a>) There are varying
   interpretations on whether this process causes "writing-mode: rl" to
   merely shift the text string or reverse the order of all glyphs in the
   text.

  <p class=issue>See <a href=test-writing-mode-direction.svg>this demo</a> to
   check out your implementation's interpretation! (Note that most SVG
   implementations don't support the &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; property, and thus your results
   may be skewed on that account. Examine the red line of text: if the
   numbers are not in reverse order, your implementation doesn't support
   "direction: rtl".)

  <p>The &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; property determines the
   direction of block flow. This determines the progression of block-level
   boxes in a block formatting context; the progression of line boxes in a
   block container that contains inlines; and the progression of rows in a
   table. As a result it also determines which side of a box is its <dfn
   id=before>before</dfn> edge (i.e. the edge that comes earlier in the
   progression) and which side is its <dfn id=after>after</dfn> edge (i.e.
   the edge that comes later in the progression).

  <p>The &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; property, by virtue of
   determining the stacking direction of line boxes, determines whether line
   boxes and thus the writing mode of text are horizontal or vertical.
   However, it does not determine the orientation of the line boxes' contents
   or the start and end sides of the line. See <a
   href="#line-orientation">Line orientation</a>.

  <p>When set on the root element, the &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; property together with the
   &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; property determines the <dfn
   id=principal-writing-mode>principal writing mode</dfn> of the document.
   This writing mode is used, for example, to determine the default page
   progression direction. See <a href="#CSS3PAGE"
   rel=biblioentry>[CSS3PAGE]<!--{{CSS3PAGE}}--></a> The &lsquo;<a
   href="#writing-mode1"><code class=property>writing-mode</code></a>&rsquo;
   value of the root element is also propagated to the initial containing
   block and sets the block flow direction of the initial block formatting
   context.

  <p class=note>Note that the &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; property of the HTML BODY
   element is <em>not</em> propagated to the viewport. That special behavior
   only applies to the background and overflow properties.

  <p>If an element has a different block flow direction than its containing
   block:

  <ul>
   <li>If the element has a specified &lsquo;<code
    class=property>display</code>&rsquo; of &lsquo;<code
    class=css>inline</code>&rsquo;, its &lsquo;<code
    class=property>display</code>&rsquo; computes to &lsquo;<code
    class=property>inline-block</code>&rsquo;. <a href="#CSS21"
    rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>

   <li>If the element has a specified &lsquo;<code
    class=property>display</code>&rsquo; of &lsquo;<code
    class=css>run-in</code>&rsquo;, its &lsquo;<code
    class=property>display</code>&rsquo; computes to &lsquo;<code
    class=property>block</code>&rsquo;. <a href="#CSS21"
    rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>
  </ul>

  <p>If such an element is a block container, then it establishes a new block
   formatting context.

  <p>The content of replaced elements do not rotate due to the writing mode:
   images, for example, remain upright. However replaced content involving
   text (such as MathML content or form elements) should match the replaced
   element's writing mode and line orientation if the UA supports such a
   vertical writing mode for the replaced content.

  <div class=example>
   <p>In the following example, two blocks elements (1 and 3) separated by an
    image (2) are presented in various flow writing modes.</p>

   <p>Here is a diagram of horizontal writing mode (<code>writing-mode:
    horizontal-tb</code>):</p>

   <p><img alt="Diagram of horizontal layout: blocks 1, 2, and 3 are stacked
    top-to-bottom" height=300 src=horizontal.png width=219></p>

   <p>Here is a diagram for the right-to-left vertical writing mode commonly
    used in East Asia (<code>writing-mode: vertical-rl</code>):</p>

   <p><img alt="Diagram of a right-to-left vertical layout: blocks 1, 2, and
    3 are arranged side by side from right to left" height=191
    src=vertical-rl.png width=297></p>

   <p>And finally, here is a diagram for the left-to-right vertical writing
    mode used for Uighur and Mongolian (<code>writing-mode: lr</code>):</p>

   <p><img alt="Diagram of left-to-right vertical layout: blocks 1, 2, and 3
    are arranged side by side from left to right" height=191
    src=vertical-lr.png width=300></p>
  </div>

  <h3 id=vertical-layout><span class=secno>4.1. </span>Box Layout in Vertical
   Writing Modes</h3>

  <p>CSS box layout in vertical writing modes is analogous to layout in the
   horizontal writing modes, following the principles outlined below:

  <ul>
   <li>Calculations that refer to the width use height instead, and vice
    versa. See <a href="#dimensions">Logical vs Physical Dimensions</a>.

   <li>Calculations that refer to the &lsquo;<code
    class=css>*-left</code>&rsquo; and &lsquo;<code
    class=css>*-right</code>&rsquo; box properties (border, margin, padding,
    outline) use &lsquo;<code class=css>*-top</code>&rsquo; and &lsquo;<code
    class=css>*-bottom</code>&rsquo; instead, and vice versa. In
    right-to-left block flow &lsquo;<code class=css>*-right</code>&rsquo; is
    analogous to top-to-bottom's &lsquo;<code class=css>*-top</code>&rsquo;;
    in left-to-right block flow &lsquo;<code class=css>*-left</code>&rsquo;
    is analogous to top-to-bottom's &lsquo;<code
    class=css>*-top</code>&rsquo;. See <a href="#logical-directions">Logical
    Directions</a> for a fuller discussion of direction-mapping.

   <li>Layout effects that depend on the &lsquo;<a href="#direction0"><code
    class=property>direction</code></a>&rsquo; property to choose between
    left and right (e.g. overflow, overconstraint resolution, the initial
    value for &lsquo;<code class=property>text-align</code>&rsquo;, table
    column ordering) are abstracted to the <a href="#start">start</a> and <a
    href="#end">end</a> sides and mapped appropriately.
  </ul>

  <p>For features such as text alignment, floating, and list marker
   positioning, that primarily reference the left or right sides of the line
   box or its longitudinal parallels and therefore have no top or bottom
   equivalent, the <a href="#line-left">line left</a> and <a
   href="#line-right">line right</a> sides are used as the reference for the
   left and right sides respectively. (See <a
   href="#line-directions">Line-Relative Directions</a>.)

  <p>Likewise for features such as underlining, overlining, and baseline
   alignment (the unfortunately-named &lsquo;<code
   class=property>vertical-align</code>&rsquo;), that primarily reference the
   top or bottom sides of the linebox or its transversal parallels and
   therefore have no left or right equivalent, the <a href="#over">over</a>
   and <a href="#under">under</a> sides are used as the reference for the top
   and bottom sides respectively.

  <h2 id=line-orientation><span class=secno>5. </span>Line Orientation</h2>
  <!-- <p>The block flow direction given by &lsquo;<code class=property>writing-mode</code>&rsquo; determines only the
    ordering and placement of the line boxes -->

  <p>Every line box has an orientation. Whether its orientation is horizontal
   or vertical is determined by the &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; property. Given that, which
   side is its "top", or <a href="#over0"><em>over</em></a> edge, is
   determined by the &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo; property on its
   containing block, and is independent of the block flow direction.

  <p>In addition to its <dfn id=over0>over</dfn> (ascender side) and <dfn
   id=under0>under</dfn> (descender side) edges, a line box, even a
   vertically-oriented one, also has a "left" and "right" side, which we will
   call the <dfn id=line-left>line left</dfn> and <dfn id=line-right>line
   right</dfn> sides of the box to distinguish from the physical left and
   physical right sides of the box.

  <div class=figure> <object class=landscape
   data="diagrams/line-orient-up.svg" type="image/svg+xml"></object>
   <p class=caption>Line orientation compass</p>
  </div>

  <p>The <dfn id=start>start</dfn> edge of a box is nominally the edge from
   which text of its inline base direction will start. For boxes with a used
   &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; value of &lsquo;<code
   class=css>ltr</code>&rsquo;, this means the <a href="#line-left"><i>line
   left</i></a> edge. For boxes with a used &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo; value
   of &lsquo;<code class=css>rtl</code>&rsquo;, this means the <a
   href="#line-right"><i>line right</i></a> edge. The edge opposite the start
   edge is the <dfn id=end>end</dfn> edge.

  <p>These directional mappings exist even for boxes that do not contain any
   line boxes: they are calculated by the values of the &lsquo;<a
   href="#writing-mode1"><code class=property>writing-mode</code></a>&rsquo;,
   &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo;, and &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;
   properties only.

  <p class=note>Note that determining the <a href="#start"><i>start</i></a>
   and <a href="#end"><i>end</i></a> edges of a box depends not only on its
   &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; and &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;
   properties, but also its &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo; property.

  <div class=figurepair>
   <div class=figure> <object class=portrait
    data="diagrams/line-orient-right.svg" type="image/svg+xml"></object>
    <p class=caption>Typical orientation in vertical</p>
   </div>

   <div class=figure> <object class=portrait
    data="diagrams/line-orient-left.svg" type="image/svg+xml"></object>
    <p class=caption>Line orientation with &lsquo;<code
     class=css>text-orientation: rotate-left</code>&rsquo;</p>
   </div>
  </div>

  <p class=note>Note also that while the <a href="#over0"><i>over</i></a> and
   <a href="#under0"><i>under</i></a> directions often map to the same
   directions as <a href="#before">before</a> and <a href="#after">after</a>
   respectively, this mapping is reversed for some combinations of &lsquo;<a
   href="#writing-mode1"><code class=property>writing-mode</code></a>&rsquo;
   and &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo;.

  <h3 id=text-orientation><span class=secno>5.1. </span>Orienting Text: the
   &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo; property</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=text-orientation0>text-orientation</dfn>

    <tr>
     <th>Value:

     <td>vertical-right | upright | rotate-right | rotate-left |
      rotate-normal

    <tr>
     <th>Initial:

     <td>vertical-right

    <tr>
     <th>Applies to:

     <td>all elements except table row groups, rows, column groups, and
      columns

    <tr>
     <th>Inherited:

     <td>yes

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>specified value
  </table>

  <p>This property specifies the orientation of characters in a non-native
   &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; and sets the orientation of
   the line. Current values only have an effect in vertical writing modes.
   Values have the following meanings:

  <dl>
   <dt><dfn id=vertical-right>vertical-right</dfn>

   <dd>
    <p>In vertical writing modes, grapheme clusters from scripts that do not
     have an intrinsic vertical orientation are rotated 90&deg; clockwise
     from their standard orientation in horizontal text. When available,
     vertical glyph variants and vertical font metrics are used to set all
     punctuation and characters from any script that is not rotated. This
     value is typical for layout of primarily vertical-script text.

   <dt><dfn id=upright>upright</dfn>

   <dd>
    <p>In vertical writing modes, grapheme clusters that do not have an
     intrinsic vertical orientation are rendered upright, i.e. in their
     standard horizontal orientation. Shaping characters are shaped in their
     isolated forms. When available, vertical glyph variants and vertical
     font metrics are used to set the text. The UA should synthesize vertical
     font metrics for grapheme clusters that do not have any.

    <p>For the purposes of bidi reordering, this value causes all characters
     to be treated as strong LTR. This value causes the used value of
     &lsquo;<a href="#direction0"><code
     class=property>direction</code></a>&rsquo; to be &lsquo;<code
     class=css>ltr</code>&rsquo;.

   <dt><dfn id=rotate-right>rotate-right</dfn>

   <dd>
    <p>In vertical writing modes, this causes text to be set as if in a
     horizontal layout (using horizontal glyph variants and metrics), but
     rotated 90&deg; clockwise. This value is typical for &lsquo;<code
     class=css>vertical-rl</code>&rsquo; text in a primarily
     horizontal-script document.

   <dt><dfn id=rotate-left>rotate-left</dfn>

   <dd>
    <p>In vertical writing modes, this causes text to be set as if in a
     horizontal layout (using horizontal glyph variants and metrics), but
     rotated 90&deg; counter-clockwise. This value is typical for
     &lsquo;<code class=css>vertical-lr</code>&rsquo; text in a primarily
     horizontal-script document.

    <p>If set on a non-replaced inline whose parent is not &lsquo;<a
     href="#rotate-left"><code class=css>rotate-left</code></a>&rsquo;, this
     forces &lsquo;<code class=css>isolate</code>&rsquo; to be added to the
     computed value of &lsquo;<a href="#unicode-bidi0"><code
     class=property>unicode-bidi</code></a>&rsquo;. Layout of text is exactly
     as for &lsquo;<a href="#rotate-right"><code
     class=css>rotate-right</code></a>&rsquo; except that the entire text
     content and baseline table of the element is mirrored: each box of the
     inline is mirrored around a vertical axis such that its content box does
     not move. (However the contents of atomic inlines are not mirrored; only
     their alignment is changed.) Similarly, if a child of the element has a
     &lsquo;<a href="#text-orientation0"><code
     class=property>text-orientation</code></a>&rsquo; value other than
     &lsquo;<a href="#rotate-left"><code
     class=css>rotate-left</code></a>&rsquo;, an analogous transformation is
     applied.

   <dt><dfn id=rotate-normal>rotate-normal</dfn>

   <dd>
    <p>This value is equivalent to &lsquo;<a href="#rotate-right"><code
     class=css>rotate-right</code></a>&rsquo; in &lsquo;<code
     class=css>vertical-rl</code>&rsquo; writing mode and equivalent to
     &lsquo;<a href="#rotate-left"><code
     class=css>rotate-left</code></a>&rsquo; in &lsquo;<code
     class=css>vertical-lr</code>&rsquo; writing mode.
  </dl>

  <p><a href="#SVG11" rel=biblioentry>[SVG11]<!--{{!SVG11}}--></a> defines
   &lsquo;<code class=property>glyph-orientation-vertical</code>&rsquo; and
   &lsquo;<code class=property>glyph-orientation-horizontal</code>&rsquo;
   properties that were intended to control text orientation. These
   properties are <em>deprecated</em> and do not apply to non-SVG elements.
   Implementations that wish to support these properties in conjunction with
   &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo; must introduce an
   &lsquo;<code class=css>auto</code>&rsquo; value for &lsquo;<a
   href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo;, which is set by the UA
   default style sheet on all <a
   href="http://www.w3.org/TR/SVG/intro.html#TermTextContentElement">SVG text
   content elements</a> and which indicates that the SVG &lsquo;<code
   class=property>glyph-orientation-vertical</code>&rsquo; and &lsquo;<code
   class=property>glyph-orientation-horizontal</code>&rsquo; behavior
   controls the layout of text. In all other contexts the &lsquo;<code
   class=css>auto</code>&rsquo; behavior is the same as for &lsquo;<code
   class=css>right</code>&rsquo;.

  <p class=issue>Add appendix that describes interaction with OpenType
   features and font layout?

  <h2 id=text-combine><span class=secno>6. </span>Glyph Composition: the
   &lsquo;<a href="#text-combine0"><code
   class=property>text-combine</code></a>&rsquo; property</h2>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=text-combine0>text-combine</dfn>

    <tr>
     <th>Value:

     <td>none | cluster | upright

    <tr>
     <th>Initial:

     <td>none

    <tr>
     <th>Applies to:

     <td>non-replaced inline elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>specified value
  </table>

  <p>This property allows the combination of multiple characters into the
   space of a single character. For text layout purposes, e.g. bidi ordering,
   line-breaking, emphasis marks, text-decoration, etc. the resulting
   composition is treated as a single glyph representing the Object
   Replacement Character U+FFFC. Values have the following meanings:

  <dl>
   <dt><dfn id=none title="text-combine:none">none</dfn>

   <dd>No special processing.

   <dt><dfn id=upright0 title="text-combine:upright">upright</dfn>

   <dd>
    <p>In vertical writing mode, attempt to display the text contents of the
     element horizontally within the vertical line box, ideally within the
     space of one ideographic character (1em square), as follows:

    <p>If the UA has compressed glyphs available for the contents of the
     element, then it should use those glyphs to attempt sizing the contents
     to 1em square. For example, a single-digit number should use a fullwidth
     glyph, a two digit number should use halfwidth or proportional glyphs, a
     three-digit number use 1/3-em glyphs (if available, else halfwidth
     glyphs), etc. The glyphs are stacked horizontally (similar to the
     contents of an inline-box with a horizontal writing mode and a
     line-height of 1em) and the baseline of the resulting composition chosen
     such that it is centered between the content edges of its parent inline
     box.

    <p>If the length of the element's contents exceeds the element's used
     line-height, then its contents are instead rendered as if &lsquo;<a
     href="#text-combine0"><code class=css>text-combine</code></a>&rsquo;
     were &lsquo;<code class=css>none</code>&rsquo;. This fallback behavior
     is also triggered if the element contains anything other than text.

    <p>In horizontal mode this value is equivalent to &lsquo;<code
     class=css>none</code>&rsquo;.
  </dl>

  <div class=example>
   <p>In East Asian documents, the &lsquo;<code class=css>text-combine:
    upright</code>&rsquo; effect is often used to display Latin-based strings
    such as components of a date or letters of an initialism, always in a
    horizontal writing mode regardless of the writing mode of the line:</p>

   <div class=figure>
    <p><img alt="Diagram of tate-chu-yoko, showing the two digits of a date
     set halfwidth side-by-side in a vertical column of text" class=example
     src=tate-chu-yoko.png>

    <p>Example of horizontal-in-vertical <i lang=ja>tate-chu-yoko</i></p>
   </div>

   <p>In Japanese, this effect is known as <i lang=ja>tate-chu-yoko</i>.
  </div>

  <h2 id=abstract-layout><span class=secno>7. </span>Abstract Box Layout</h2>

  <p><a href="#CSS21" rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a> defines
   the box layout model of CSS in detail. However, it only defines the box
   model for the &lsquo;<code class=css>horizontal-tb</code>&rsquo; writing
   mode. CSS box layout in writing modes other than &lsquo;<code
   class=css>horizontal-tb</code>&rsquo; is analogous to the box layout
   defined in CSS2.1 if boxes and dimensions are abstracted and remapped
   appropriately. This module defines the following abstract directional and
   dimensional terms and their mappings in order to define box layout for
   other writing modes:

  <h3 id=dimensions><span class=secno>7.1. </span>Logical vs Physical
   Dimensions</h3>

  <dl>
   <dt><dfn id=block-flow-dimension>block flow dimension</dfn>

   <dd>The dimension perpendicular to the flow of text with in a line, the
    <i>vertical dimension</i> in horizontal writing modes, and the
    <i>horizontal dimension</i> in vertical writing modes.

   <dt><dfn id=inline-dimension>inline dimension</dfn>

   <dd>The dimension parallel to the flow of text within a line, i.e. the
    <i>horizontal dimension</i> in horizontal writing modes, and the
    <i>vertical dimension</i> in vertical writing modes.

   <dt><dfn id=y-axis>y-axis</dfn>

   <dd>The axis in the block flow dimension, i.e. the <i>vertical axis</i> in
    horizontal writing modes and the <i>horizontal axis</i> in vertical
    writing modes.

   <dt><dfn id=x-axis>x-axis</dfn>

   <dd>The axis in the inline dimension, i.e. the <i>horizontal axis</i> in
    horizontal writing modes and the <i>vertical axis</i> in vertical writing
    modes.

   <dt><dfn id=length>length</dfn> or <dfn id=logical-height>logical
    height</dfn>

   <dt>

   <dd>A measurement in the block flow dimension: refers to the physical
    height (vertical dimension) in horizontal writing modes, and to the
    physical width (horizontal dimension) in vertical writing modes.

   <dt><dfn id=measure>measure</dfn> or <dfn id=logical-width>logical
    width</dfn>

   <dt>

   <dd>A measurement in the inline dimension: refers to the physical width
    (horizontal dimension) in horizontal writing modes, and to the physical
    height (vertical dimension) in vertical writing modes. (The term <a
    href="#measure0"><i>measure</i></a> derives from its <a
    href="http://en.wikipedia.org/wiki/Measure_%28typography%29">use in
    typography</a>.)
  </dl>

  <p>Properties that are named in terms of the x and y axes are logical with
   respect to the block flow direction rather than absolute with respect to
   the page. Specifically:

  <ul>
   <li>The &lsquo;<code class=css>repeat-x</code>&rsquo; keyword of
    &lsquo;<code class=property>background-repeat</code>&rsquo; tiles in the
    inline dimension of the element, which is not necessarily the horizontal
    dimension. <a href="#CSS21" rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>
    [[!CSS3BACKGROUND]]

   <li>The &lsquo;<code class=css>repeat-y</code>&rsquo; keyword of
    &lsquo;<code class=property>background-repeat</code>&rsquo; tiles in the
    block flow dimension of the element, whcih is not necessarily the
    vertical dimenion. <a href="#CSS21"
    rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a> [[!CSS3BACKGROUND]]

   <li>The &lsquo;<code class=property>overflow-x</code>&rsquo; property
    controls overflow in the inline dimension of the element. <a
    href="#CSS3UI" rel=biblioentry>[CSS3UI]<!--{{!CSS3UI}}--></a>

   <li>The &lsquo;<code class=property>overflow-y</code>&rsquo; property
    controls overflow in the block flow dimension of the element. <a
    href="#CSS3UI" rel=biblioentry>[CSS3UI]<!--{{!CSS3UI}}--></a>
  </ul>

  <p>Additionally, certain properties behave logically as follows:

  <ul>
   <li>The first and second values of the &lsquo;<code
    class=property>border-spacing</code>&rsquo; property represent spacing
    between columns and rows respectively, not necessarily the horizontal and
    vertical spacing respectively. <a href="#CSS21"
    rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>

   <li>The &lsquo;<code class=property>line-height</code>&rsquo; property
    always refers to the logical height. <a href="#CSS21"
    rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>
  </ul>

  <p>The height properties (&lsquo;<code class=property>height</code>&rsquo;,
   &lsquo;<code class=property>min-height</code>&rsquo;, and &lsquo;<code
   class=property>max-height</code>&rsquo;) refer to the physical height, and
   the width properties (&lsquo;<code class=property>width</code>&rsquo;,
   &lsquo;<code class=property>min-width</code>&rsquo;, and &lsquo;<code
   class=property>max-width</code>&rsquo;) refer to the physical width.
   However, the rules used to calculate the height and width are logical: the
   height calculation rules in <a href="#CSS21"
   rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a> are used for the logical
   height (which could be either the physical height or physical width).
   Likewise the width calculation rules in <a href="#CSS21"
   rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a> are used for the logical
   width.

  <p>As a corollary, percentages on the margin and padding properties, which
   are calculated with respect to the containing block width regardless of
   their dimension, are calculated with respect to the <a
   href="#logical-width"><em>logical width</em></a> of the containing block.

  <h4 id=orthogonal-flows><span class=secno>7.1.1. </span>Orthogonal Flows</h4>

  <p>When an element has a different &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; from its containing block
   two cases are possible:

  <ul>
   <li>The two writing modes are parallel to each other. (For example,
    &lsquo;<code class=property>rl</code>&rsquo; and &lsquo;<code
    class=property>lr</code>&rsquo;).

   <li>The two writing modes are perpendicular to each other. (For example,
    &lsquo;<code class=property>tb</code>&rsquo; and &lsquo;<code
    class=property>lr</code>&rsquo;).
  </ul>

  <p>To handle the second case, for the purposes of calculating the layout of
   the box, the dimensions corresponding to the logical height and logical
   width of the containing block are determined using the writing mode of the
   box under consideration, not the writing mode of the element associated
   with the containing block.

  <p class=issue>What's a reasonable way of calculating &lsquo;<code
   class=css>auto</code>&rsquo; logical widths? The fallout of the above
   statements is not reasonable. Three good options are: use the max-content
   size; use 100vh margin-box; use the same logical width that would be
   calculated if the block flows were parallell.

  <h3 id=directions><span class=secno>7.2. </span>Logical vs Physical
   Directions</h3>

  <p>The terms "left", "right", "top", and "bottom" are always interpreted
   physically, i.e. with respect to the page independent of writing mode. Two
   abstract mappings are possible for these directions: logical and
   line-relative. Which one is chosen depends on whether the usage is
   primarily with respect to the block, or primarily with respect to the line
   box.

  <h4 id=block-directions><span class=secno>7.2.1. </span>Logical Directions</h4>

  <p>The <dfn id=logical-directions>logical directions</dfn> are <a
   href="#before">before</a>, <a href="#after">after</a>, <a
   href="#start">start</a>, and <a href="#end">end</a>. In an <abbr
   title=left-to-right>LTR</abbr> &lsquo;<code
   class=css>horizontal-tb</code>&rsquo; writing mode, they correspond to the
   top, bottom, left, and right directions, respectively.

  <div class=example>
   <p>An English (LTR-TB) block:</p>

   <pre class=ascii-art>
                  &lt;---- width / logical width ---&gt;

                             top side/
                            before side
                  +------------------------------+                  A
      left side/  |   ---inline direction --->   |  right side/     |
      start side  |  |                           |  end side        |
                  |  | block      * horizontal * |                height/
                  |  | direction  *writing mode* |            logical height
                  |  V                           |                  |
                  +------------------------------+                  V
                             bottom side/
                              after side
    </pre>
  </div>

  <div class=example>
   <p>A vertical Japanese block (TTB-RL):</p>

   <pre class=ascii-art>
                  &lt;--- width / logical height ---&gt;

                             top side/
                            start side
                  +------------------------------+                  A
      left side/  |    &lt;---block direction---    |  right side/     |
      after side  |                           |  |  before side     |
                  |  *  vertical  *     inline|  |                height/
                  |  *writing mode*  direction|  |             logical width
                  |                           V  |                  |
                  +------------------------------+                  V
                            bottom side/
                             end side
    </pre>
  </div>

  <p>Logical directions are calculated with respect to the writing mode of
   the element and used to abstract layout related to padding and border
   properties. For example, if an element had computed values of &lsquo;<code
   class=css>direction: ltr; writing-mode: vertical-lr; text-orientation:
   vertical-right</code>&rsquo;, &lsquo;<code
   class=property>padding-top</code>&rsquo; would give its start padding, and
   &lsquo;<code class=property>padding-left</code>&rsquo; would give its
   before padding.

  <p>Logical directions are calculated with respect to the writing mode of
   the <em>parent</em> of the element and used to abstract layout related to
   the margin properties and the &lsquo;<code
   class=property>top</code>&rsquo;, &lsquo;<code
   class=property>bottom</code>&rsquo;, &lsquo;<code
   class=property>left</code>&rsquo;, and &lsquo;<code
   class=property>right</code>&rsquo; properties. (For the root element,
   which has no parent, the values of the writing mode of the element is used
   instead.)

  <p>The <a
   href="http://www.w3.org/TR/CSS21/box.html#collapsing-margins">margin
   collapsing rules</a> apply exactly with the <em>before margin</em>
   substituted for the top margin and the <em>after margin</em> substituted
   for the bottom margin. Similarly the padding and border on the same side
   as the before margin is substituted for the top padding and border, and
   the padding and border on the same side as the after margin for the bottom
   padding and border. Note this means only before and after margins ever
   collapse.

  <p class=note>The parent element is used instead of the containing block,
   because the benefit of using the containing block is very rare, but the
   cost to implement it is rather high for implementations that do
   logical-physical mapping at cascade time.

  <p>The start and end directions are also used for inline layout as follows:
   

  <ul>
   <li>The initial value of the &lsquo;<code
    class=property>text-align</code>&rsquo; property aligns to the start edge
    of the line box.

   <li>The &lsquo;<code class=property>text-indent</code>&rsquo; property
    indents from the start edge of the line box.
  </ul>

  <h4 id=line-directions><span class=secno>7.2.2. </span>Line-Relative
   Directions</h4>

  <p>The <dfn id=line-relative-directions>line-relative directions</dfn> are
   <a href="#over">over</a>, <a href="#under">under</a>, <a
   href="#line-left">line-left</a>, and <a href="#line-right">line-right</a>.
   In an <abbr title=left-to-right>LTR</abbr> &lsquo;<code
   class=css>horizontal-tb</code>&rsquo; writing mode, they correspond to the
   top, bottom, left, and right directions, respectively.

  <p>The line right and line left directions are calculated with respect to
   the writing mode of the element and used to interpret the &lsquo;<code
   class=css>left</code>&rsquo; and &lsquo;<code
   class=css>right</code>&rsquo; values of the following properties:

  <ul>
   <li>the &lsquo;<code class=property>text-align</code>&rsquo; property <a
    href="#CSS21" rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>
  </ul>

  <p>The line right and line left directions are calculated with respect to
   the writing mode of the <em>containing block</em> of the element and used
   to interpret the &lsquo;<code class=css>left</code>&rsquo; and
   &lsquo;<code class=css>right</code>&rsquo; values of the following
   properties:

  <ul>
   <li>the &lsquo;<code class=property>float</code>&rsquo; property <a
    href="#CSS21" rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>

   <li>the &lsquo;<code class=property>clear</code>&rsquo; property <a
    href="#CSS21" rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>
  </ul>

  <p>The over and under directions are calculated with respect to the writing
   mode of the element and used to define the interpretation of the "top"
   (over edge) and "bottom" (under edge) of the line box as follows:

  <ul>
   <li>For the &lsquo;<code class=property>vertical-align</code>&rsquo;
    property, the "top" of the line box is the over edge; the "bottom" of the
    line box is the under edge. Positive length and percentage values shift
    the baseline towards the over edge. <a href="#CSS21"
    rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>

   <li>For the &lsquo;<code class=property>text-decoration</code>&rsquo;
    property, the underline is drawn on the under side of the text; the
    overline is drawn on the over side of the text. <a href="#CSS21"
    rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a> <span class=note>Note that
    the CSS Text Module defines this in more detail and provides additional
    controls for controlling the position of underlines and overlines. <a
    href="#CSS3TEXT" rel=biblioentry>[CSS3TEXT]<!--{{CSS3TEXT}}--></a></span>
    
  </ul>

  <h4 id=logical-to-physical><span class=secno>7.2.3.
   </span>Abstract-to-Physical Mappings</h4>

  <p>The following table summarizes the abstract-to-physical mappings:

  <table class=data>
   <caption>Abstract-Physical Mapping</caption>

   <thead>
    <tr>
     <th scope=row>&lsquo;<a href="#writing-mode1"><code
      class=property>writing-mode</code></a>&rsquo;

     <th colspan=2>&lsquo;<code class=css>horizontal-tb</code>&rsquo;

     <th colspan=4>&lsquo;<code class=css>vertical-rl</code>&rsquo;

     <th colspan=4>&lsquo;<code class=css>vertical-lr</code>&rsquo;

    <tr>
     <th scope=row>&lsquo;<a href="#text-orientation0"><code
      class=property>text-orientation</code></a>&rsquo;

     <th colspan=2>&mdash;

     <th colspan=2>&lsquo;<a href="#rotate-left"><code
      class=css>rotate-left</code></a>&rsquo;

     <th colspan=2><abbr title="vertical-right, upright,
      rotate-right">*right</abbr>

     <th colspan=2>&lsquo;<a href="#rotate-left"><code
      class=css>rotate-left</code></a>&rsquo;

     <th colspan=2><abbr title="vertical-right, upright,
      rotate-right">*right</abbr>

    <tr>
     <th scope=row>&lsquo;<a href="#direction0"><code
      class=property>direction</code></a>&rsquo;

     <th>&lsquo;<code class=css>ltr</code>&rsquo;

     <th>&lsquo;<code class=css>rtl</code>&rsquo;

     <th>&lsquo;<code class=css>ltr</code>&rsquo;

     <th>&lsquo;<code class=css>rtl</code>&rsquo;

     <th>&lsquo;<code class=css>ltr</code>&rsquo;

     <th>&lsquo;<code class=css>rtl</code>&rsquo;

     <th>&lsquo;<code class=css>ltr</code>&rsquo;

     <th>&lsquo;<code class=css>rtl</code>&rsquo;

     <th>&lsquo;<code class=css>ltr</code>&rsquo;

     <th>&lsquo;<code class=css>rtl</code>&rsquo;

   <tbody>
    <tr>
     <th scope=row>length

     <td colspan=2>height

     <td colspan=8>width

    <tr>
     <th scope=row>measure

     <td colspan=2>width

     <td colspan=8>height

    <tr>
     <th scope=row>before

     <td colspan=2>top

     <td colspan=4>right

     <td colspan=4>left

    <tr>
     <th scope=row>after

     <td colspan=2>bottom

     <td colspan=4>left

     <td colspan=4>right

    <tr>
     <th scope=row>start

     <td>left

     <td>right

     <td>bottom

     <td>top

     <td>top

     <td>bottom

     <td>bottom

     <td>top

     <td>top

     <td>bottom

    <tr>
     <th scope=row>end

     <td>right

     <td>left

     <td>top

     <td>bottom

     <td>bottom

     <td>top

     <td>top

     <td>bottom

     <td>bottom

     <td>top

   <tbody>
    <tr>
     <th scope=row>over

     <td colspan=2>top

     <td colspan=2>left

     <td colspan=2>right

     <td colspan=2>left

     <td colspan=2>right

    <tr>
     <th scope=row>under

     <td colspan=2>bottom

     <td colspan=2>right

     <td colspan=2>left

     <td colspan=2>right

     <td colspan=2>left

    <tr>
     <th scope=row>line-left

     <td colspan=2>left

     <td colspan=2>bottom

     <td colspan=2>top

     <td colspan=2>bottom

     <td colspan=2>top

    <tr>
     <th scope=row>line-right

     <td colspan=2>right

     <td colspan=2>top

     <td colspan=2>bottom

     <td colspan=2>top

     <td colspan=2>bottom
  </table>

  <h4 id=physical-only><span class=secno>7.2.4. </span>Purely Physical
   Properties</h4>

  <p>The following values are purely physical in their definitions and do not
   respond to changes in writing mode:

  <ul>
   <li>all values of &lsquo;<code
    class=property>background-repeat</code>&rsquo; other than &lsquo;<code
    class=css>repeat-y</code>&rsquo; and &lsquo;<code
    class=css>repeat-x</code>&rsquo; (described above)

   <li>the &lsquo;<code class=css>rect()</code>&rsquo; notation of the
    &lsquo;<code class=property>clip</code>&rsquo; property <a href="#CSS21"
    rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>

   <li>the offsets of the &lsquo;<code
    class=property>box-shadow</code>&rsquo; and &lsquo;<code
    class=property>text-shadow</code>&rsquo; properties
  </ul>

  <h4 id=caption-side><span class=secno>7.2.5. </span>The &lsquo;<code
   class=property>caption-side</code>&rsquo; property</h4>

  <p>This module introduces two new values to the &lsquo;<code
   class=property>caption-side</code>&rsquo; property: &lsquo;<a
   href="#before"><code class=css>before</code></a>&rsquo; and &lsquo;<a
   href="#after"><code class=css>after</code></a>&rsquo;, which position the
   caption before and after the table box, respectively. For tables with
   &lsquo;<code class=css>horizontal-tb</code>&rsquo; writing mode, they are
   equivalent to the existing &lsquo;<code class=css>top</code>&rsquo; and
   &lsquo;<code class=css>bottom</code>&rsquo; values, respectively. <a
   href="#CSS21" rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>

  <p>Implementations that only support the &lsquo;<code
   class=css>top</code>&rsquo; and &lsquo;<code
   class=css>bottom</code>&rsquo; values of the &lsquo;<code
   class=property>caption-side</code>&rsquo; property must treat them as
   &lsquo;<a href="#before"><code class=css>before</code></a>&rsquo;, when
   the table is in a vertical writing mode.

  <p>For implementations that support side captions (i.e. the &lsquo;<code
   class=css>left</code>&rsquo; and &lsquo;<code
   class=css>right</code>&rsquo; values), this module also introduces the
   &lsquo;<a href="#start"><code class=css>start</code></a>&rsquo; and
   &lsquo;<a href="#end"><code class=css>end</code></a>&rsquo; values, which
   behave similarly and which position the caption on the start and end sides
   of the table box, calculated with respect to the writing mode of the table
   element. For such implementations, the &lsquo;<code
   class=css>top</code>&rsquo; and &lsquo;<code
   class=css>bottom</code>&rsquo; values must place the caption on the top
   and bottom sides of the table box, respectively.

  <h3 id=html-attributes><span class=secno>7.3. </span>HTML Attributes</h3>

  <p>This section defines the mapping of HTML presentational attributes in
   CSS. This section is normative for user agents supporting HTML in addition
   to the &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; property. <a href="#HTML40"
   rel=biblioentry>[HTML40]<!--{{!HTML40}}--></a> <a href="#HTML5"
   rel=biblioentry>[HTML5]<!--{{!HTML5}}--></a>

  <h4 id=width-height-attributes><span class=secno>7.3.1. </span>The
   <code>width</code> and <code>height</code> attributes</h4>

  <p>The HTML <code>width</code> and <code>height</code> attributes refer to
   the physical width and height for elements that that are replaced, i.e.
   <code>&lt;applet&gt;</code>, <code>&lt;embed&gt;</code>,
   <code>&lt;iframe&gt;</code>, <code>&lt;img&gt;</code>,
   <code>&lt;object&gt;</code>, <code>&lt;canvas&gt;</code>, and
   <code>&lt;video&gt;</code>

  <p>Form elements elements contain text, therefore their contents should be
   affected by writing mode, in which case these attributes refer to the
   <em>logical</em> width and height. The UA may, however, choose not to
   rotate nor flip these elements in vertical writing modes if it is not
   capable, and in that case, these attributes remain physical.

  <p class=issue>when not to rotate form elements/MathML, should treat them
   as images (always upright) or to force writing-mode to always calculate to
   horizontal-tb?

  <p>On table-related elements (<code>&lt;table&gt;</code>,
   <code>&lt;colgroup&gt;</code>, <code>&lt;col&gt;</code>,
   <code>&lt;tr&gt;</code>, <code>&lt;th&gt;</code>, <code>&lt;td&gt;</code>)
   the <code>width</code> and <code>height</code> attributes are always
   logical.

  <p>The <code>size</code> attribute of the <code>&lt;hr&gt;</code> element
   is also logical (refers to the logical height).

  <h4 id=alignment-attributes><span class=secno>7.3.2. </span>Alignment,
   Float and Clear Attributes</h4>

  <p>The following attributes behave the same way as their corresponding CSS
   properties:

  <ul>
   <li><code>align</code> as &lsquo;<code class=property>float</code>&rsquo;
    or &lsquo;<code class=property>text-align</code>&rsquo;

   <li><code>clear</code> as &lsquo;<code class=property>clear</code>&rsquo;

   <li><code>valign</code> as &lsquo;<code
    class=property>vertical-align</code>&rsquo;
  </ul>

  <h4 id=spacing-attributes><span class=secno>7.3.3. </span>Spacing
   Attributes</h4>

  <p>The following attributes are logical and, as margins, are logical with
   respect to the writing mode of the <em>parent</em> element.

  <ul>
   <li><code>hspace</code> as start and end margins

   <li><code>vspace</code> as before and after margins

   <li>marginwidth

   <li>marginheight
  </ul>

  <h2 id=logical-controls><span class=secno>8. </span>Logical Properties and
   Values</h2>

  <p class=issue>NOTE: This is only a proposal under discussion.

  <p>Logical properties and values provide the author with the ability to
   control layout through logical, rather than physical, direction and
   dimension mappings. This section defines logical properties and values for
   the features defined in <a href="#CSS21"
   rel=biblioentry>[CSS21]<!--{{CSS21}}--></a>. These properties are
   writing-mode relative equivalents of the corresponding physical
   properties.

  <h3 id=logical-value><span class=secno>8.1. </span>Logical Directional
   Values: before, after, start, end</h3>

  <p>Properties that accept physical directional keyword values (&lsquo;<code
   class=css>top</code>&rsquo;, &lsquo;<code class=css>bottom</code>&rsquo;,
   &lsquo;<code class=css>left</code>&rsquo;, or &lsquo;<code
   class=css>right</code>&rsquo;) are redefined to also accept the
   appropriate logical directional keywords (&lsquo;<a href="#before"><code
   class=css>before</code></a>&rsquo;, &lsquo;<a href="#after"><code
   class=css>after</code></a>&rsquo;, &lsquo;<a href="#start"><code
   class=css>start</code></a>&rsquo;, or &lsquo;<a href="#end"><code
   class=css>end</code></a>&rsquo;). In such cases, the logical values can be
   used in place of the corresponding physical values. For properties that
   take multiple keywords, combinations of logical and physical values are
   not allowed.

  <p>The following properties accept the &lsquo;<a href="#start"><code
   class=css>start</code></a>&rsquo; and &lsquo;<a href="#end"><code
   class=css>end</code></a>&rsquo; keywords where &lsquo;<code
   class=css>left</code>&rsquo; and &lsquo;<code
   class=css>right</code>&rsquo; are allowed:

  <ul>
   <li>&lsquo;<code class=property>caption-side</code>&rsquo;, if the
    &lsquo;<code class=css>left</code>&rsquo; and &lsquo;<code
    class=css>right</code>&rsquo; values are supported in horizontal writing
    modes (See the <a href="#caption-side">section on
    <code>caption-side</code></a>)

   <li>&lsquo;<code class=property>clear</code>&rsquo;

   <li>&lsquo;<code class=property>background-position</code>&rsquo;

   <li>&lsquo;<code class=property>float</code>&rsquo;

   <li>&lsquo;<code class=property>text-align</code>&rsquo;
  </ul>

  <p>The following properties accept the &lsquo;<a href="#before"><code
   class=css>before</code></a>&rsquo; and &lsquo;<a href="#after"><code
   class=css>after</code></a>&rsquo; keywords where &lsquo;<code
   class=css>top</code>&rsquo; and &lsquo;<code
   class=css>bottom</code>&rsquo; are allowed:

  <ul>
   <li>&lsquo;<code class=property>caption-side</code>&rsquo;
  </ul>

  <p>See the section on <a href="#abstract-layout">Abstract Layout</a>
   details on how to map between logical and physical terms. This mapping
   controls the interpretation of logical keywords.

  <p class=issue>float needs coordination with GCPM where it defines page
   floats

  <p class=issue>&lsquo;<code class=property>resize</code>&rsquo; accepts
   &lsquo;<code class=css>horizontal</code>&rsquo; and &lsquo;<code
   class=css>vertical</code>&rsquo;, and these terminologies should be
   physical. should we add &lsquo;<code class=css>resize-x</code>&rsquo; and
   &lsquo;<code class=css>resize-y</code>&rsquo; as logical values?

  <h3 id=logical-page><span class=secno>8.2. </span>Logical Page
   Classifications</h3>

  <p>In CSS, all pages are classified by user agents as either left pages or
   right pages. <a href="#CSS21" rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>
   Which page is first in a spread, however, depends on whether the page
   progression is left-to-right or right-to-left.

  <p>To allow control of page breaking to the page that is on the earlier or
   later side of a spread, rather than to the left or right side of a spread,
   this module introduces the following additional keywords for the
   &lsquo;<code class=property>page-break-after</code>&rsquo; and
   &lsquo;<code class=property>page-break-before</code>&rsquo; properties <a
   href="#CSS21" rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>:

  <dl>
   <dt><dfn id=recto>&lsquo;<code class=css>recto</code>&rsquo;</dfn>

   <dd>Equivalent to &lsquo;<code class=css>right</code>&rsquo; in
    left-to-right page progressions and &lsquo;<code
    class=css>left</code>&rsquo; in right-to-left page progressions.

   <dt><dfn id=verso>&lsquo;<code class=css>verso</code>&rsquo;</dfn>

   <dd>Equivalent to &lsquo;<code class=css>left</code>&rsquo; in
    left-to-right page progressions and &lsquo;<code
    class=css>right</code>&rsquo; in right-to-left page progressions.
  </dl>

  <p class=issue>recto/verso or even/odd or even-page/odd-page? If using
   odd/even, could use "The page number used to determine whether a page is
   even or odd is the physical page count starting from 1, and is sometimes
   different from the page number printed on the page. In other words, if a
   page is on the same side as the first page, it is an odd page." But which
   side would we want if page-break-before changes the first page?

  <p>Logical page selectors are added to support logical page selection.
   Authors typically place page numbers using physical placements, but the
   contents of headers often follows conventions depending on which page in
   the spread is earlier.

  <p>Following <a
   href="http://www.w3.org/TR/CSS21/page.html#page-selectors">page
   selectors</a> are added to support this scenario:

  <dl>
   <dt><dfn id=recto0>&lsquo;<code class=css>:recto</code>&rsquo;</dfn>

   <dd>Equivalent to &lsquo;<code class=css>:right</code>&rsquo; in
    left-to-right page progressions and &lsquo;<code
    class=css>:left</code>&rsquo; in right-to-left page progressions.

   <dt><dfn id=verso0>&lsquo;<code class=css>:verso</code>&rsquo;</dfn>

   <dd>Equivalent to &lsquo;<code class=css>:left</code>&rsquo; in
    left-to-right page progressions and &lsquo;<code
    class=css>:right</code>&rsquo; in right-to-left page progressions.
  </dl>

  <p>The logical page selectors have specificity equal to the &lsquo;<code
   class=css>:left</code>&rsquo; and &lsquo;<code
   class=css>:right</code>&rsquo; page selectors.

  <h3 id=logical-properties><span class=secno>8.3. </span>Logical Properties</h3>

  <p>This section uses the following terminology:

  <dl>
   <dt>logical properties

   <dd>the properties defined relative to the writing mode (e.g. &lsquo;<a
    href="#margin-before"><code
    class=property>margin-before</code></a>&rsquo;)

   <dt>physical properties

   <dd>the properties defined relative to the physical directions (e.g.
    &lsquo;<code class=property>margin-top</code>&rsquo;)

   <dt>corresponding properties

   <dd>the pair of a logical property and its corresponding physical
    property, as determined by mapping through the computed writing mode.
  </dl>

  <p>If both logical and physical properties are specified on the same
   element, corresponding properties are treated as same property and then
   normal cascading rules are applied. The value resulting from the winning
   declaration then sets the specified <span class=issue>(computed?)</span>
   value of both corresponding properties.

  <p>See the section on <a href="#abstract-layout">Abstract Layout</a>
   details on how to map between logical and physical terms. This mapping
   controls the pairing of corresponding logical and physical properties.

  <p>Since the &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;, &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;, and
   &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo; values of the element or
   parent element are used for the pairing of corresponding properties, these
   three properties must be evaluated before determining the winning
   declaration among declarations of potentially-corresponding properties. In
   most cases, the values of the element are used for this mapping. However,
   in some cases the values on the parent element are used instead.

  <p class=issue>Should we add corresponding logical properties for
   border-top-right-radius, border-bottom-right-radius,
   border-top-left-radius, border-top-left-radius, and border-radius?

  <p class=issue>an idea is to allow &lsquo;<code class=css>margin: start 2em
   end 1em</code>&rsquo; instead of these properties

  <p class=issue>another idea is to allow &lsquo;<code class=css>margin:
   logical unspecified 1em unspecified 2em</code>&rsquo; instead of these
   properties

  <h4 id=logical-dimension-properties><span class=secno>8.3.1. </span>Logical
   Height and Logical Width: the &lsquo;<a href="#length0"><code
   class=property>length</code></a>&rsquo; and &lsquo;<a
   href="#measure0"><code class=property>measure</code></a>&rsquo; properties</h4>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=measure0>measure</dfn>, <dfn id=length0>length</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;length&gt;</var> | <var>&lt;percentage&gt;</var> | auto

    <tr>
     <th>Initial:

     <td>auto

    <tr>
     <th>Applies to:

     <td>same as &lsquo;<code class=property>width</code>&rsquo; and
      &lsquo;<code class=property>height</code>&rsquo;

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td><a href="#measure">measure</a>, <a href="#length">length</a> of
      containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>the percentage as specified or the absolute length or &lsquo;<code
      class=property>auto</code>&rsquo; (see text)
  </table>

  <p>These properties correspond to the &lsquo;<code
   class=property>width</code>&rsquo; and &lsquo;<code
   class=property>height</code>&rsquo; properties. The mapping depends on the
   element's &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;.

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=min-measure>min-measure</dfn>, <dfn
      id=min-length>min-length</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;length&gt;</var> | <var>&lt;percentage&gt;</var>

    <tr>
     <th>Initial:

     <td>0

    <tr>
     <th>Applies to:

     <td>same as &lsquo;<code class=property>width</code>&rsquo; and
      &lsquo;<code class=property>height</code>&rsquo;

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td><a href="#measure">measure</a>, <a href="#length">length</a> of
      containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>the percentage as specified or the absolute length (see text)
  </table>

  <p>These properties correspond to the &lsquo;<code
   class=property>max-width</code>&rsquo; and &lsquo;<code
   class=property>max-height</code>&rsquo; properties. The mapping depends on
   the element's &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;.

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=max-measure>max-measure</dfn>, <dfn
      id=max-length>max-length</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;length&gt;</var> | <var>&lt;percentage&gt;</var> | none

    <tr>
     <th>Initial:

     <td>none

    <tr>
     <th>Applies to:

     <td>same as &lsquo;<code class=property>width</code>&rsquo; and
      &lsquo;<code class=property>height</code>&rsquo;

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td><a href="#measure">measure</a>, <a href="#length">length</a> of
      containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>the percentage as specified or the absolute length or &lsquo;<code
      class=property>none</code>&rsquo; (see text)
  </table>

  <p>These properties correspond to the &lsquo;<code
   class=property>min-width</code>&rsquo; and &lsquo;<code
   class=property>min-height</code>&rsquo; properties. The mapping depends on
   the element's &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;.

  <h4 id=logical-prop><span class=secno>8.3.2. </span>Logical Margins and
   Offsets: : the margin- and offset- before/after/start/end properties</h4>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=margin-before>margin-before</dfn>, <dfn
      id=margin-after>margin-after</dfn>, <dfn
      id=margin-start>margin-start</dfn>, <dfn id=margin-end>margin-end</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;length&gt;</var> | <var>&lt;percentage&gt;</var> | auto

    <tr>
     <th>Initial:

     <td>0

    <tr>
     <th>Applies to:

     <td>same as &lsquo;<code class=property>margin</code>&rsquo;

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>logical-width of containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>the percentage as specified or the absolute length or &lsquo;<code
      class=property>auto</code>&rsquo; (see text)
  </table>

  <p>These properties correspond to the &lsquo;<code
   class=property>margin-top</code>&rsquo;, &lsquo;<code
   class=property>margin-bottom</code>&rsquo;, &lsquo;<code
   class=property>margin-left</code>&rsquo;, and &lsquo;<code
   class=property>margin-right</code>&rsquo; properties. The mapping depends
   on the <em>parent element's</em> &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;, &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;, and
   &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo;.

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=offset-before>offset-before</dfn>, <dfn
      id=offset-after>offset-after</dfn>, <dfn
      id=offset-start>offset-start</dfn>, <dfn id=offset-end>offset-end</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;length&gt;</var> | <var>&lt;percentage&gt;</var> | auto

    <tr>
     <th>Initial:

     <td>auto

    <tr>
     <th>Applies to:

     <td>positioned elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>logical-width, resp. logical-height of containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>same as box offsets: &lsquo;<code class=property>top</code>&rsquo;,
      &lsquo;<code class=property>right</code>&rsquo;, &lsquo;<code
      class=property>bottom</code>&rsquo;, &lsquo;<code
      class=property>left</code>&rsquo; properties except that directions are
      logical
  </table>

  <p>These properties correspond to the &lsquo;<code
   class=property>top</code>&rsquo;, &lsquo;<code
   class=property>bottom</code>&rsquo;, &lsquo;<code
   class=property>left</code>&rsquo;, and &lsquo;<code
   class=property>right</code>&rsquo; properties. The mapping depends on the
   <em>parent element's</em> &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;, &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;, and
   &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo;.

  <h4 id=border-padding><span class=secno>8.3.3. </span>Logical Padding and
   Border: the padding- and border-<var>*</var>- before/after/start/end
   properties</h4>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=padding-before>padding-before</dfn>, <dfn
      id=padding-after>padding-after</dfn>, <dfn
      id=padding-start>padding-start</dfn>, <dfn
      id=padding-end>padding-end</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;length&gt;</var> | <var>&lt;percentage&gt;</var>

    <tr>
     <th>Initial:

     <td>0

    <tr>
     <th>Applies to:

     <td>all elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>logical-width of containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>&lt;length&gt; (see text)
  </table>

  <p>These properties correspond to the &lsquo;<code
   class=property>padding-top</code>&rsquo;, &lsquo;<code
   class=property>padding-bottom</code>&rsquo;, &lsquo;<code
   class=property>padding-left</code>&rsquo;, and &lsquo;<code
   class=property>padding-right</code>&rsquo; properties. The mapping depends
   on the element's &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;, &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;, and
   &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo;.

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=border-before-width>border-before-width</dfn>, <dfn
      id=border-after-width>border-after-width</dfn>, <dfn
      id=border-start-width>border-start-width</dfn>, <dfn
      id=border-end-width>border-end-width</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;border-width&gt;</var>

    <tr>
     <th>Initial:

     <td>medium

    <tr>
     <th>Applies to:

     <td>all elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>logical-width of containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>absolute length; &lsquo;<code class=css>0</code>&rsquo; if the
      border style is &lsquo;<code class=property>none</code>&rsquo; or
      &lsquo;<code class=property>hidden</code>&rsquo; (see text)
  </table>

  <p>These properties correspond to the &lsquo;<code
   class=property>border-width-top</code>&rsquo;, &lsquo;<code
   class=property>border-width-bottom</code>&rsquo;, &lsquo;<code
   class=property>border-width-left</code>&rsquo;, and &lsquo;<code
   class=property>border-width-right</code>&rsquo; properties. The mapping
   depends on the element's &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;, &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;, and
   &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo;.

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=border-before-style>border-before-style</dfn>, <dfn
      id=border-after-style>border-after-style</dfn>, <dfn
      id=border-start-style>border-start-style</dfn>, <dfn
      id=border-end-style>border-end-style</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;border-style&gt;</var>

    <tr>
     <th>Initial:

     <td>none

    <tr>
     <th>Applies to:

     <td>all elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>specified value (see text)
  </table>

  <p>These properties correspond to the &lsquo;<code
   class=property>border-style-top</code>&rsquo;, &lsquo;<code
   class=property>border-style-bottom</code>&rsquo;, &lsquo;<code
   class=property>border-style-left</code>&rsquo;, and &lsquo;<code
   class=property>border-style-right</code>&rsquo; properties. The mapping
   depends on the element's &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;, &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;, and
   &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo;.

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=border-before-color>border-before-color</dfn>, <dfn
      id=border-after-color>border-after-color</dfn>, <dfn
      id=border-start-color>border-start-color</dfn>, <dfn
      id=border-end-color>border-end-color</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;color&gt;</var>

    <tr>
     <th>Initial:

     <td>currentcolor

    <tr>
     <th>Applies to:

     <td>all elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>the computed color (see text)
  </table>

  <p>These properties correspond to the &lsquo;<code
   class=property>border-color-top</code>&rsquo;, &lsquo;<code
   class=property>border-color-bottom</code>&rsquo;, &lsquo;<code
   class=property>border-color-left</code>&rsquo;, and &lsquo;<code
   class=property>border-color-right</code>&rsquo; properties. The mapping
   depends on the element's &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;, &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;, and
   &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo;.

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=border-before>border-before</dfn>, <dfn
      id=border-after>border-after</dfn>, <dfn
      id=border-start>border-start</dfn>, <dfn id=border-end>border-end</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;border-width&gt;</var> || <var>&lt;border-style&gt;</var>
      || <var>&lt;color&gt;</var>

    <tr>
     <th>Initial:

     <td>(see individual properties)

    <tr>
     <th>Applies to:

     <td>all elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>see individual properties

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>see individual properties
  </table>

  <p>These properties correspond to the &lsquo;<code
   class=property>border-top</code>&rsquo;, &lsquo;<code
   class=property>border-bottom</code>&rsquo;, &lsquo;<code
   class=property>border-left</code>&rsquo;, and &lsquo;<code
   class=property>border-right</code>&rsquo; properties. The mapping depends
   on the element's &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo;, &lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;, and
   &lsquo;<a href="#text-orientation0"><code
   class=property>text-orientation</code></a>&rsquo;.

  <h4 id=logical-shorthand-keyword><span class=secno>8.3.4. </span>Shorthand
   Properties with &lsquo;<code class=css>logical</code>&rsquo; Keyword</h4>

  <p>The shorthand properties for margin, padding, and border set values for
   physical properties by default. But authors can specify the &lsquo;<code
   class=css>logical</code>&rsquo; keyword at the beginning of the property
   value to indicate that the values map to the logical properties instead of
   the physical ones.

  <p class=issue>other candidates of the keyword are: &lsquo;<code
   class=css>relative</code>&rsquo;, &lsquo;<code
   class=css>script</code>&rsquo;, &lsquo;<a href="#writing-mode1"><code
   class=css>writing-mode</code></a>&rsquo;, &lsquo;<code
   class=css>beas</code>&rsquo;, or the value itself (e.g., &lsquo;<code
   class=css>vertical-lr-ltr</code>&rsquo;)

  <p>The following <a href="#CSS21"
   rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a> shorthand properties accept
   the &lsquo;<code class=css>logical</code>&rsquo; keyword:

  <ul>
   <li>&lsquo;<code class=property>margin</code>&rsquo;

   <li>&lsquo;<code class=property>padding</code>&rsquo;

   <li>&lsquo;<code class=property>border-color</code>&rsquo;

   <li>&lsquo;<code class=property>border-style</code>&rsquo;

   <li>&lsquo;<code class=property>border-width</code>&rsquo;
  </ul>

  <p>The syntax for these properties is effectively changed by replacing

  <pre>&lt;<var>value-type</var>&gt;{1,4}</pre>

  <p>with

  <pre>logical? &lt;<var>value-type</var>&gt;{1,4}</pre>

  <p>When the logical keyword is present in the value, the values that follow
   are assigned to the logical properties as follows:

  <ul>
   <li>If only one value is set, the value applies to all four logical sides.

   <li>If two values are set, the first is for before and after, the second
    is for start and end.

   <li>If three values are set, the first is for before, the second is for
    start and end, and the third is for after.

   <li>If four values are set, they apply to the before, end, after, and
    start sides in that order.
  </ul>

  <p class=issue>Should the shorthand also reset the physical properties to
   their initial values?

  <div class=example>
   <p>In the following example, the two rules are equivalent:</p>

   <pre><code class=css>
<!-- -->blockquote {
<!-- -->  margin: logical 1em 2em 3em 4em;
<!-- -->}
<!-- -->blockquote {
<!-- -->  margin-before: 1em;
<!-- -->  margin-end:    2em;
<!-- -->  margin-after:  3em;
<!-- -->  margin-start:  4em;
<!-- -->}
<!----></code></pre>
  </div>

  <h3 id=background-and-borders><span class=secno>8.4. </span>Logical
   Background and Border Images</h3>

  <p><a href="#CSS3BG" rel=biblioentry>[CSS3BG]<!--{{!CSS3BG}}--></a> is
   handled separately because it can fill an area with specified images, and
   the area to fill can be rotated or flipped depending on the text flow.

  <h4 id=background-image-transform-prop><span class=secno>8.4.1.
   </span>Background Image Transform: The &lsquo;<a
   href="#background-image-transform"><code
   class=property>background-image-transform</code></a>&rsquo; property</h4>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=background-image-transform>background-image-transform</dfn>

    <tr>
     <th>Value:

     <td>logical | physical | rotate

    <tr>
     <th>Initial:

     <td>physical <span class=issue>is this the right default? we need to
      investigate which is more common</span>

    <tr>
     <th>Applies to:

     <td>All elements

    <tr>
     <th>Inherited:

     <td>yes

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>as specified
  </table>

  <p>This property defines whether background images are transformed to match
   to the value of &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; property, and whether
   &lsquo;<code class=property>background-size</code>&rsquo; widths and
   heights are logical or physical. Values have the following meanings:

  <dl>
   <dt><strong>logical</strong>

   <dd>The values for the &lsquo;<code
    class=property>background-size</code>&rsquo; property are logical. The
    background images are transformed to match to the logical axis.

   <dt><strong>physical</strong>

   <dd>The values for the &lsquo;<code
    class=property>background-size</code>&rsquo; property are physical. The
    background images remain unchanged.

   <dt><strong>rotate</strong>

   <dd>Similar to &lsquo;<code class=css>logical</code>&rsquo;, except that
    the inline direction is ignored. The result is affected only by the block
    flow direction.
  </dl>

  <h4 id=background-repeat-prop><span class=secno>8.4.2. </span>The
   &lsquo;<code class=property>background-repeat</code>&rsquo; property</h4>

  <p>The &lsquo;<code class=css>repeat-x</code>&rsquo; and &lsquo;<code
   class=css>repeat-y</code>&rsquo; values are logical, but in CSS3 this
   property can also accept double values to specify horizontal and vertical
   behaviors separately. The double values are considered logical if the
   &lsquo;<code class=css>'logical'</code>&rsquo; keyword is specified,
   otherwise physical.

  <p class=issue>should also add repeat-horizontal and repeat-vertical for
   the physical value?

  <h4 id=border-image-transform-prop><span class=secno>8.4.3. </span>Border
   Image Transform: The &lsquo;<a href="#border-image-transform"><code
   class=property>border-image-transform</code></a>&rsquo; property</h4>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=border-image-transform>border-image-transform</dfn>

    <tr>
     <th>Value:

     <td>logical | physical | rotate

    <tr>
     <th>Initial:

     <td>rotate <span class=issue>is this the right default?</span>

    <tr>
     <th>Applies to:

     <td>All elements, except internal table elements when &lsquo;<code
      class=property>border-collapse</code>&rsquo; is &lsquo;<code
      class=css>collapse</code>&rsquo;

    <tr>
     <th>Inherited:

     <td>yes

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>as specified
  </table>

  <p>This property defines whether border images are transformed to match to
   the value of &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; property, with the reference
   writing mode being &lsquo;<code class=css>writing-mode: horizontal-tb;
   direction: ltr</code>&rsquo;. Values have the following meanings:

  <dl>
   <dt><strong>logical</strong>

   <dd>The values for the border-image-* properties are logical. The border
    images are transformed to match to the logical axis.

   <dt><strong>physical</strong>

   <dd>The values for the border-image-* properties are physical. The border
    images remain unchanged.

   <dt><strong>rotate</strong>

   <dd>Similar to &lsquo;<code class=css>logical</code>&rsquo;, except that
    the inline direction is ignored. The result is affected only by the block
    flow direction.
  </dl>

  <p>The following properties use the value of this property to determine how
   directional mappings are done:

  <ul>
   <li>&lsquo;<code class=property>border-image-slice</code>&rsquo;

   <li>&lsquo;<code class=property>border-image-width</code>&rsquo;

   <li>&lsquo;<code class=property>border-image-outset</code>&rsquo;

   <li>&lsquo;<code class=property>border-image-repeat</code>&rsquo;

   <li>&lsquo;<code class=property>border-image</code>&rsquo;
  </ul>

  <h2 id=acknowledgements><span class=secno>9. </span>Acknowledgements</h2>

  <p>Martin Heijdra, Paul Nelson, Michel Suignard, Steve Zilles

  <h2 id=bidi-html><span class=secno>10. </span>Appendix B: Bidi Rules for
   HTML</h2>

  <p>The style sheet rules that would achieve the bidi behaviors specified in
   <a href="#HTML401" rel=biblioentry>[HTML401]<!--{{HTML401}}--></a> for the
   HTML Strict doctype are given below:

  <pre>
/* HTML dir attribute creates an embedding */
*[dir="ltr"]    { direction: ltr; unicode-bidi: embed; }
*[dir="rtl"]    { direction: rtl; unicode-bidi: embed; }

/* BDO element creates an override */
bdo[dir="ltr"]  { direction: ltr; unicode-bidi: bidi-override; }
bdo[dir="rtl"]  { direction: rtl; unicode-bidi: bidi-override; }

/* HTML4.01:8.2.6 - preserve bidi behavior if 'display' is changed */
html, body,
div, address, blockquote, p,
ul, ol, li, dl, dt, dd,
fieldset, form,
h1, h2, h3, h4, h5, h6,
{ unicode-bidi: isolate; }
  </pre>
