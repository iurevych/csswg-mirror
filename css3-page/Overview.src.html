<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
<head>
<title>
CSS Paged Media Module Level 3
</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="../default.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/W3C-ED.css">
<style type="text/css">
  .keyword { font-weight:bold }
  .equation { padding: 2% }
  table.equation {text-align:center}
  td, th { vertical-align: top }
  pre { font-size: 1em; }
  
  #margin-values { border-collapse: collapse; }  
  #margin-values td, 
  #margin-values th 
  { 
                padding: 0.2em; 
                border: thin solid black;
  }

  .property-list
  {
                border: 1px solid black;
                padding: .2em;
                margin-top: 2em;
  }
  
  .property-list td
  {
                border: 1px solid black;
                padding: .1em;
  }

  .editorial 
  { 
                display: block; 
                font-family: arial, helvetica, sans-serif;
      font-size: 80%;
      margin-left: .5in; 
      margin-right: 1in ; 
      padding: 0.125in;
      background: #FFFFDD ;
  }
     
  .editorial:after { content: "Ed."}
  .RFC2119 
  { 
                text-transform: lowercase; 
                font-style: italic 
  }
  
  em em.RFC2119 
  { 
                text-transform: lowercase; 
                font-style: normal 
  } 
     
  table.page-sizes 
  {
                border: thin solid; 
                margin-top: 1.5em;
  }
  table.page-sizes td 
  { 
                border: thin solid; 
                padding: .5em;
  }
  table.page-sizes th 
  { 
                border: thin solid; 
                padding: .5em; 
                background: #ffffaa;
  }

</style>
</head>
<body>
<div>
<div class="head">
<!--logo-->
<h1>CSS Paged Media Module Level 3</h1>
<h2 class="no-num no-toc" id="w3c-working">[LONGSTATUS] [DATE]</h2>
<dl>
  <dt>This version:</dt>    <dd><a href="http://dev.w3.org/csswg/css3-page/">http://dev.w3.org/csswg/css3-page/</a></dd>
    <!-- <dd><a href="[VERSION]">http://www.w3.org/TR/[YEAR]/WD-[SHORTNAME]-[CDATE]</a></dd> -->
  <dt>Latest version:</dt>    <dd><a href="http://www.w3.org/TR/css3-page">http://www.w3.org/TR/css3-page</a></dd>
  <dt>Previous version:</dt>    <dd><a href="http://www.w3.org/TR/2004/CR-css3-page-20040225/">http://www.w3.org/TR/2004/CR-css3-page-20040225/</a></dd>
  <dt>Editors:</dt>    <dd>Melinda Grant, Hewlett-Packard</dd>
    <dd>H&aring;kon Wium Lie, Opera Software</dd>
    <dd>Elika J. Etemad, Hewlett-Packard</dd>
</dl>

<!--copyright-->

</div>
<hr title="Separator for header">

<h2 class="no-num no-toc" id="abstract">Abstract</h2>

<p>This module describes the page model that partitions a flow into pages. It
builds on the <a href="/TR/CSS21/box.html">Box model module</a> and introduces
and defines the page model and paged media. It adds functionality for
pagination, page margins, page size and orientation, headers and footers,
widows and orphans, and image orientation. Finally it extends generated content
to enable page numbering and running headers / footers.</p>

<!-- "Status of this document" -->

<h2 class="no-num no-toc" id="status">Status of this Document</h2>

<!--status-->

<p>This document contains the <abbr title="Cascading Style Sheets">CSS3</abbr>
Paged Media Module W3C Last Call <a href="/2005/10/Process-20051014/tr.html#RecsWD">Working Draft</a> of [DATE]. The
Last Call period ends on <span class="fudge">TBD</span>.</p>

<p>Relative to the previous Last Call Working Draft, this version incorporates
changes to the formerly named 'fit' and 'fit-position' properties; they are
renamed to 'image-fit' and 'image-position' and redefined to enable additional
use cases. The margin-box sizing algorithm has been reworded to be a bit
simpler, and many miscellaneous clarifications and editorial improvements have
been incorporated.</p>

<p>The 'image-fit' and 'image-position' properties are explicitly identified as at
risk, and may be removed in the next version of the specification.</p>

<p>Expected next revision to this document is another LCWD, driven by the change
in definition of 'image-fit' and 'image-position'.</p>

<p>The <a href="lc2_issues.htm">Disposition of Comments</a>
document contains the current issues list and responses to input received
during this Last Call period.</p>

<h2 class="no-num no-toc" id="contents">Table of Contents</h2><!--begin-toc-->
<!--end-toc-->
<!-- "Introduction" -->
<h2 id="intro">Introduction</h2>

<p>Paged media (e.g., paper, transparencies, photo album pages, pages
displayed on computer screens as printed output simulations) differ from
<a href="/TR/CSS2/media.html#continuous-media-group">continuous media</a>
in that the content of the document is split into one or more discrete
static display surfaces. To handle pages, CSS3 Paged Media describes how:</p>

<ul>
  <li><a href="#page-breaks">page breaks</a> are created and avoided;</li>
  <li>the page properties such as size, orientation, margins, border, and
  padding are specified;</li>
  <li>headers and footers are established within the page margins;</li>
  <li>content such as page counters are placed in the headers and footers; and</li>
  <li>orphans and widows can be controlled.</li>
</ul>

<p>This module defines a <a href="#page-model">page model</a> that specifies how a
document is formatted within a rectangular area, called the <a href="#page-box-page-rule">page box</a>, that has finite width and height. Often,
but not always, the page box has a one-to-one correspondence to the physical
surface onto which the document is ultimately rendered. The CSS3 page model
specifies formatting within the page box, but it is the user agent's
responsibility to transfer the page box to the sheet. Some user agent transfer
possibilities that are not addressed by CSS3 include:</p>
<ul id="complex-usecases">
  <li>Transferring one page box to one sheet (e.g. single-sided printing);</li>
  <li>Transferring two page boxes to the front and back surfaces of the same
  sheet (e.g. double-sided printing);</li>
  <li>Transferring N (small) page boxes to one sheet (called "N-up");</li>
  <li>Transferring one (large) page box to N x M sheets (called "tiling");</li>
  <li>Creating signatures. A <dfn>signature</dfn> is a group of pages printed on
  a sheet, which, when folded and trimmed like a book, appear in their proper
  sequence;</li>
  <li>Printing one document to multiple output trays;</li>
  <li>Generating files containing print instructions.</li>
</ul>

<p>Although CSS3 does not specify how user agents transfer page boxes to sheets,
it does include certain mechanisms for telling user agents about the intended
page sheet <a href="#page-size">size and orientation</a>. In the general case,
CSS3 assumes that one page box will be transferred to one surface of similar
size.</p>


<h2 id="conformance">Conformance</h2>

<p>The keywords "<em class="RFC2119">MUST</em>", "<em class="RFC2119">SHALL</em>",
"<em class="RFC2119">MUST NOT</em>", "<em class="RFC2119">SHALL NOT</em>",
"<em class="RFC2119">REQUIRED</em>", "<em class="RFC2119">SHOULD</em>",
"<em class="RFC2119">SHOULD NOT</em>", "<em class="RFC2119">RECOMMENDED</em>",
"<em class="RFC2119">MAY</em>", and "<em class="RFC2119">OPTIONAL</em>" when
used in this document are to be interpreted as described in <cite>RFC
2119</cite> [[!RFC2119]]. However, for readability, these words do not appear
in all uppercase letters in this specification. All of the text in this
specification is normative except sections explicitly marked as non-normative,
examples, and notes.</p>

<p>Examples in this specification are introduced with the words "for example"
  or are set apart from the normative text with <code>class="example"</code>,
  like this:

<div class="example">
  <p>This is an example of an informative example.</p>
</div>

<p>Informative notes begin with the word "Note" and are set apart from the
  normative text with <code>class="note"</code>, like this:

<p class="note">Note, this is an informative note.</p>

<h2 id="page-box-page-rule">The Page Model</h2>

<p>In the page model, the document is transferred into one or more page boxes. The
<dfn id="page-box">page box</dfn> is a specialized CSS box that maps to
a rectangular print media surface, such as a page of paper. It is roughly
analogous to the viewport. <img src="PageBox.png" style="float: right;" alt=""
height="266" width="267"> As with other <a href="/TR/CSS21/box.html">boxes</a>,
a page box consists of margin, border, padding, and content areas. The containing
block of the page box is the rectangle that coincides with its margin edges.
The content and margin areas of a page box have special functions:</p>

<ul>
  <li>The content area of a page box is called the <dfn id="page-area">page
  area</dfn>. The content of the document is flowed into one or more page boxes.
  The page area acts as a container for all the boxes generated by the root
  element and its descendants that are laid out within a given page box. The
  edges of the page area on the first page establish the rectangle that is the
  initial <a href="/TR/CSS21/visudet.html#containing-block-details">containing block</a>
  of the document.</li>
  <li>The margin area of a page box is divided into 16 <dfn>margin boxes</dfn>.
  Each margin box has its own margin, border, padding and content areas. Margin
  boxes are typically used to display running headers and footers.</li>
</ul>

<p>The properties of a <dfn>page box</dfn> are determined by properties <a href="/TR/CSS21/syndata.html#declaration">declared</a> within the <dfn><a href="#page-context">page context</a></dfn>, which is the <a href="/TR/CSS21/syndata.html#x14">declaration block</a> of the <code>@page</code>
rule. Page boxes differ from other boxes in that the <span class="property">'width'</span> and <span class="property">'height'</span> properties
do not apply to a page box. The size of the page box is specified using the
<span class="property">'size'</span> property in the page context.</p>

<p>Declarations in the page context affect the page box and / or can inherit
to the margin boxes, but they do not apply to or inherit into the
document's content.</p>

<h3 id="page-terms">Page Terminology</h3>

<p>The following terminology and accompanying diagrams help to describe the
page model:</p>

<dl>
  <dt id="page-sheet">Page sheet</dt>
  <dd><img src="PageSheet.png" style="float: right;" alt="The corner of a page sheet with the non-printable area at the edge and printable area inside it"
  height="148" width="194">The page sheet is one surface of the physical
  medium. The illustration to the right shows a representation of the upper-left
  corner of a page sheet.</dd>

  <dt id="printable-area">Printable and non-printable areas</dt>
  <dd>The non-printable area is the area of a page sheet that a physical device such
  as a printer is not capable of marking reliably, usually due to the printer's
  paper handling mechanism. This value is printer dependent and is usually a
  small region along each edge of the page sheet. The printable area is the area
  of page sheet that a printer <em>is</em> capable of marking reliably. The size
  of the printable area is the size of the page sheet reduced by the size of the
  non-printable area. A user agent may not know the dimensions of this area for a
  particular printing device; but when its dimensions are known, user agents
  <em class="RFC2119">MAY</em> adjust the formatting of the document so that
  content falls within the printable area. How this adjustment is accomplished is
  device dependent within the constraints expressed in the sections <a href="#renderingpages">Rendering page boxes that do not fit a page sheet</a> and
  <a href="#content-outside-box">Content outside the page box</a>.</dd>

  <dt id="content-empty">Content-empty page</dt>
  <dd>a page box whose page area contains no printable content other than
  backgrounds and/or borders. A page box whose page area contains generated
  content, or content whose visibility is 'hidden', or invisible content such as
  a zero-width space is not a content-empty page. On the other hand, a page
  containing only a background and/or borders and/or margin-box content
  <em>is</em> a content-empty page.</dd>

  <dt id="page-orientation">Page Orientation</dt>
  <dd>The page orientation is defined by comparing the length of the edges of a
  <a href="#page-box">page box</a>. The page box is a rectangle with two
  perpendicular edges called the long edge and the short edge. The length of the
  long edge is always greater than or equal to the length of the short edge. When
  the page box is square, the two edges are of the same length and either can be
  used as the long edge with the other being the short edge. This specification
  defines page orientations of 'portrait' and 'landscape'.</dd>

  <dt id="portrait">Portrait Orientation</dt>
  <dd>A portrait page's height is greater than or equal to its width. Horizontal
  elements are parallel to the short edge and vertical elements to the long edge.</dd>

  <dt id="landscape">Landscape Orientation</dt>
  <dd>A landscape page's width is greater than or equal to its height. Horizontal
  elements are parallel to the long edge and vertical elements to the short edge.</dd>

  <dt id="duplex-printing">Duplex Printing</dt>
  <dd>Duplex printing prints one page box per side of a page sheet and uses both
  sides of the page sheet. This module provides no ability to specify whether a
  document is duplex printed, but the concept of left and right pages is based on
  the assumption that the document is duplex printed, regardless of whether or
  not it actually is.</dd>

  <dt id="binding-edge">Binding Edge</dt>
  <dd>The binding edge is the edge of the page box that is toward the binding if the
  material is bound. The binding edge often has a larger margin than the opposite
  edge to provide for the space used by the binding. The binding edge can be any
  of the four edges. However, page sheets are customarily bound so that the
  binding edge of page boxes with portrait orientation is vertical. This module
  provides no method to specify the binding edge. In duplex printing, the binding
  edge is on opposite sides of the page box for the left and right pages.</dd>

  <dt id="facing-pages">Facing Pages</dt>
  <dd>Facing pages are two sequential pages such that when the document is duplex
  printed they are on separate sheets of paper. Typically, the earlier page will
  be the back side of one sheet and the later page will be the front side of
  another. They are usually laid out so that the binding edges of facing pages
  are vertical and adjacent when the pages are placed in their normal reading
  orientation.</dd>

  <dt id="left-page">Left Page</dt>
  <dd>A page that would be on the left if it is part of a pair of facing pages as
  typically laid out. Page layouts for documents using a left-to-right page
  progression have the earlier of the facing pages on the left. Rules specific to
  the left page can be specified using the <span class="css">':left'</span> page
  selector.</dd>
  
  <dt id="right-page">Right Page</dt>
  <dd>A page that would be on the right if it is part of a pair of facing pages as
  typically laid out. Page layouts for documents using a right-to-left page
  progression have the earlier of the facing pages on the right. Rules specific
  to the right page can be specified using the <span class="css">':right'</span>
  page selector.</dd>
</dl>

<h3 id="painting">Page Backgrounds and Painting Order</h3>

<h3 id="pagination">Pagination</h3>

<h3 id="content-outside-box">Content outside the page box</h3>

<p>When formatting content in the page model, some content may end up outside the
page box. For example, an element whose <span class="property">'white-space'</span> property has the value <span class="css">'pre'</span> can generate a box that is wider than the page box. Also,
when boxes are positioned absolutely, they may end up in "inconvenient"
locations. For example, images may be placed on the edge of the page box.
Similarly, when boxes use fixed or relative positioning, they can end up
outside of the page box.</p>

<p>A specification for the exact formatting of such elements lies outside the
scope of this document. However, it is recommended that authors and user agents
observe the following general principles concerning content outside the page
box:</p>

<ul>
<li>User agents <em class="RFC2119">SHOULD</em> avoid generating a large number
of <a href="#content-empty">content-empty pages</a> to honor the positioning of
elements (e.g., printing 100 blank pages is probably neither the author's nor
the user's intent). Note, however, that generating a small number of empty page
boxes is sometimes necessary to honor the <span class="css">'left'</span> and
<span class="css">'right'</span> values for <span class="property">'page-break-before'</span> and <span class="property">'page-break-after'</span>.</li>
<li>Authors <em class="RFC2119">SHOULD NOT</em> position elements in
inconvenient locations just to avoid rendering them. Instead:

<ul>
<li>To suppress box generation entirely, set the <span class="property">'display'</span> property to <span class="css">'none'</span>.</li>
<li>To make a box invisible, set the <span class="property">'visibility'</span>
property.</li>
</ul></li>
<li>This specification does not define how boxes positioned outside the page
box are handled. Possibilities include discarding them or creating page boxes
for them at the end of the document.</li>
</ul><!-- "Margin boxes" -->

<h3 id="progression">Page Progression</h3>

<p>CSS distinguishes between left pages and right pages on all documents,
whether they are printed duplex or not. Each left page is followed by a
right page and vice versa. Left and right pages can be styled differently
with the <a href="#left-right-first"><code>:left</code> and <code>:right</code>
pseudo-classes</a>.

<p>Whether the first page of a document is a left page or a right page
depends on the page progression of the document. The <dfn>page progression</dfn>
is the direction in which the printed pages of a document would be sequenced
when laid out side-to-side; <i>e.g.</i>, English typically progresses from
left to right. In documents with with a left-to-right page progression the
first page of the document is a right page, and vice versa.</p>

<p>The page progression direction is determined as follows:</p>

<ul>
  <li>If text is laid out in horizontal lines, the page progression is the
  same as the inline progression.</li>
  <li>If text is laid out in vertical lines, the page progression is the
  same as the block progression.</li>
</ul>

<p>If the UA supports the 'direction' and 'block-progression' properties
from the CSS 3 Text Layout Module [[CSS3TEXTLAYOUT]], it must determine
whether the first page is a left or right page from the values of those
properties on the root element.</p>

<p>To explicitly force a document to begin printing on a left or right page,
authors can <a href="#page-break-before">insert a page break before</a> the
first generated box. The UA must suppress the first (empty) page(s) in this
case (and the <code>:first</code> selector applies to the first printed
page).</p>

<h2 id="page-selector-and-context">Page Selectors and the Page Context</h2>

<p>Authors can specify various aspects of a page box such as the dimensions,
orientation, and margins within an <span class="css">@page</span> rule. An
<span class="css">@page</span> rule consists of the keyword <span class="css">'@page'</span>, an <em class="RFC2119">OPTIONAL</em> page name followed
with no intervening space by an <em class="RFC2119">OPTIONAL</em> page
pseudo-class and a block of declarations (said to be in the <dfn id="page-context">page context</dfn>).</p>

<p>The <em class="RFC2119">OPTIONAL</em> page name and <em class="RFC2119">OPTIONAL</em> page pseudo-class constitute the <dfn id="page-selector">page selector</dfn>. The page selector specifies for which
pages the declarations apply. In CSS3, page selectors <em class="RFC2119">MAY</em> designate the first page of a document, all left pages, all
right pages, or pages with specific names.</p>

<p>Properties declared within the page context apply to the page box.</p>

<p>If an error is encountered during the processing of a declaration block within
a page or a margin context, the <a href="/TR/CSS21/syndata.html#parsing-errors">Rules for handling parsing errors</a>
apply; that is, valid declarations within the block are applied.</p>

<h3 id="syntax-page-selector">Page selector grammar</h3>

<p>The syntax for a page selector is a specialization of the generic at-rule
defined by CSS 2.1. This grammar extends the at-rule syntax to allow nested
at-rules for @media and @page. User agents <em class="RFC2119">MUST</em> adhere
to the following grammar:</p>

<p>See [[!CSS21]], Section 4.1.1 and Appendix G for the expansion of missing
productions:</p>
<p id="specializatons-of-ATKEYWORD">
All new lexical tokens are specializations of the ATKEYWORD lexical token:</p>
<pre class="lexical">
PAGE_SYM              ::= "@page"
TOPLEFTCORNER_SYM     ::= "@top-left-corner"
TOPLEFT_SYM           ::= "@top-left"
TOPCENTER_SYM         ::= "@top-center"
TOPRIGHT_SYM          ::= "@top-right"
TOPRIGHTCORNER_SYM    ::= "@top-right-corner"
BOTTOMLEFTCORNER_SYM  ::= "@bottom-left-corner" 
BOTTOMLEFT_SYM        ::= "@bottom-left"
BOTTOMCENTER_SYM      ::= "@bottom-center"
BOTTOMRIGHT_SYM       ::= "@bottom-right"
BOTTOMRIGHTCORNER_SYM ::= "@bottom-right-corner"
LEFTTOP_SYM           ::= "@left-top"
LEFTMIDDLE_SYM        ::= "@left-middle"
LEFTBOTTOM_SYM        ::= "@left-bottom"
RIGHTTOP_SYM          ::= "@right-top"
RIGHTMIDDLE_SYM       ::= "@right-middle"
RIGHTBOTTOM_SYM       ::= "@right-bottom"

<span id="syntax-prod-media">media</span> : 
     MEDIA_SYM S* medium [ COMMA S* medium ]* LBRACE S* [ page | ruleset ]* '}' S*
     ;

<span id="syntax-prod-page">page</span> :
     PAGE_SYM S* IDENT? S* pseudo_page? S* 
     '{' S* [ margin_box | ruleset ]? [ ';' S* [ margin_box | ruleset ]? ]* '}' S*
     ;

<span id="syntax-prod-pseudo-page">pseudo_page</span> :
     ':' [ "left" | "right" | "first" ]
     ;

<span id="syntax-prod-margin">margin_box</span> :
     margin_sym S* '{' ruleset* '}' S*
     ;

<span id="syntax-prod-margin-sym">margin_sym</span> :
     TOPLEFTCORNER_SYM | 
     TOPLEFT_SYM | 
     TOPCENTER_SYM | 
     TOPRIGHT_SYM | 
     TOPRIGHTCORNER_SYM |
     BOTTOMLEFTCORNER_SYM | 
     BOTTOMLEFT_SYM | 
     BOTTOMCENTER_SYM | 
     BOTTOMRIGHT_SYM |
     BOTTOMRIGHTCORNER_SYM |
     LEFTTOP_SYM |
     LEFTMIDDLE_SYM |
     LEFTBOTTOM_SYM |
     RIGHTTOP_SYM |
     RIGHTMIDDLE_SYM |
     RIGHTBOTTOM_SYM 
     ;
</pre>
<p id="page-selector-syntax-restrict">
The following restrictions and relaxations are made to the syntax above:</p>

<ul>
  <li>The value 'auto' <em class="RFC2119">must not</em> be used as a page name
  and <em class="RFC2119">MUST</em> be treated as a syntax error.</li>
</ul>

<div class="example">

<p>The following are examples of page selectors (declaration block intentionally
left blank)</p>
<pre>
@page { ... }
@page :left { ... }
@page :right { ... }
@page LandscapeTable { ... }
@page CompanyLetterHead:first { ... } /*  identifier and pseudo page. */
@page:first { ... };
</pre>

<p>The following are examples of margin boxes where the declaration blocks are
intentionally left blank.</p>
<pre>
@page {
 @top-left { ... /* document name */ }
 @bottom-center { ... /* page number */}
}
@page :left { @left-middle { ... /* page number in left margin */ }}
@page :right{ @right-middle { ... /* page number in right margins of right pages */}}

@page :left { @bottom-left-corner { ... /* left page numbers */ }}
@page :right { @bottom-right-corner { ... /* right page numbers */ }}
@page :first { @bottom-left-corner { ... /* empty footer on 1st page */ }
             @bottom-right-corner { ... /* empty footer */ } }
</pre>
</div>

<h3 id="cascading-and-page-context">Cascading in the page context</h3>

<p>Declarations in page and margin contexts <a href="/TR/CSS21/cascade.html">cascade</a> just like declarations in <a href="/TR/CSS21/syndata.html#rule-sets">rule sets</a>.</p>

<p>The specificity of @page rules is computed in a manner analogous to the
computations defined in the <a href="/TR/CSS21/selector.html">Selectors</a>
module:</p>

<ul>
  <li>if the @page rule has a named page, f=1; else f=0</li>
  <li>if the @page rule has a ':first' pseudo-class, g=1; else g=0</li>
  <li>if the @page rule has a ':left' or ':right' pseudo-class, h=1; else h=0</li>
</ul>

<p>Concatenating the three numbers f-g-h gives the specificity.</p>

<p>Properties that are not explicitly set within the page or margin context take
their initial values and do not inherit from any element.</p>

<div class="example">

<p>Some page specificity calculation examples follow:</p>
<pre>
      @page { } /* f=0 g=0 h=0 -&gt; specificity = 000 */
      @page :left { } /* f=0 g=0 h=1 -&gt; specificity = 001 */
      @page :first { } /* f=0 g=1 h=0 -&gt; specificity = 010 */
      @page artsy { } /* f=1 g=0 h=0 -&gt; specificity = 100 */
      @page artsy:left { } /* f=1 g=0 h=1 -&gt; specificity = 101 */
      @page artsy:first { } /* f=1 g=1 h=0 -&gt; specificity = 110 */ 
</pre>
</div>

<div class="example">

<p>Consider the following usage example:</p>
<pre>
@page {
margin-left: 3cm;
}

@page :left {
margin-left: 4cm;
}
</pre>

<p>Due to the higher specificity of the pseudo-class selector, the left margin on
left pages will be 4cm and all other pages
(the right-facing pages) will have a left margin of 3cm.</p>
</div>

<div class="example">

<p>In this example, the higher specificity of the green rules wins over the red
rule. Therefore the first page will have blue text in the top-left margin box
and green text in the top-right margin box, while subsequent pages will have
red text in the margin boxes.</p>
<pre>
@page :first {
color: green;

@top-left {
  content: "foo";
  color: blue;
}
@top-right {
  content: "bar";
}
}

@page { color: red;
@top-center {
  content: "Page " counter(page);
  }
}
</pre>
</div>

<div class="example">

<p>Page contexts cascade, so the following stylesheet would style pages with 25
millimeter margins and 14 point type in the margin boxes:</p>
<pre>
@page { margin: 25mm;}
@page { font-size: 14pt;}
</pre>
</div>

<h3 id="left-right-first">Left, right, and first pages</h3>

<p>When printing double-sided documents, left and right pages are often formatted
differently. This can be expressed through CSS pseudo-classes defined in the
<a href="#page-context">page context</a>.</p>

<p>All pages are automatically classified by user agents into either the
<span class="css">':left'</span> or <span class="css">':right'</span>
pseudo-class. The following example creates left and right binding edges using
these pseudo-classes.</p>

<div class="example">
<pre>
@page :left {
margin-left: 3cm;
margin-right: 4cm;
}

@page :right {
margin-left: 4cm;
margin-right: 3cm;
}
</pre>
</div>

<p>If different declarations have been given for left and right pages, the user
agent <em class="RFC2119">MUST</em> honor these declarations even if the user
agent does not transfer the page boxes to left and right sheets (i.e., a
printer that only prints on one side of the medium must nevertheless produce
correctly formatted output).</p>

<p>Authors can also specify style for the first page of a document with the
<span class="css">':first'</span> pseudo-class. Such style rules are applied only 
to the first printed page of a document.</p>

<div class="example">
<pre>
@page { margin: 2cm } /* All margins set to 2cm */

@page :first {
margin-top: 10cm /* Top margin on first page 10cm */
}
</pre>
</div>

<div class="example">
<pre>
html {page-break-before: always;}
</pre>

<p>For an XHTML document with a left-to-right page progression, the above style
rule will cause the first page of the document to print on a ':right' page</p>
</div>
<div class="note">

<p><em><strong>Note.</strong> Adding declarations to the <span class="css">':left'</span> or <span class="css">':right'</span> pseudo-class does not
necessarily influence whether the document comes out of the printer double- or
single-sided (which is outside the scope of this specification).</em></p>
</div>
<div class="note">

<p><em><strong>Note.</strong> Future versions of CSS may include other page
pseudo-classes.</em></p>
</div>

<h2 id="page-properties">Page Properties</h2>
<div>

<p>The following properties can be used in the <a href="#page-context">page
context</a> to style the appearance of the page box and margin boxes:</p>

<ul>
  <li><a href="/TR/CSS21/colors.html#background-properties">background properties</a></li>
  <li><a href="/TR/CSS21/box.html#border-properties">border properties</a></li>
  <li><a href="/TR/CSS21/colors.html#propdef-color">color</a></li>
  <li><a href="/TR/CSS21/generate.html#counters">counter-reset, counter-increment</a></li>
  <li><a href="/TR/CSS21/fonts.html">font properties</a></li>
  <li><a href="/TR/CSS21/visudet.html#line-height">line-height</a></li>
  <li><a href="/TR/CSS21/box.html#margin-properties">margin properties</a></li>
  <li><a href="/TR/CSS21/box.html#padding-properties">padding properties</a></li>
  <li><a href="#page-size">size</a></li>
  <li><a href="/TR/CSS21/text.html">text properties</a></li>
  <li><a href="/TR/CSS21/visufx.html#visibility">visibility</a></li>
</ul>

<p>That is, the margin boxes inherit values for inheritable properties from the
page context.</p>

<p>The following properties can be used in the <a href="#margin-at-rule">margin
context</a> to style margin boxes and their content:</p>

<ul>
  <li><a href="/TR/CSS21/colors.html#background-properties">background properties</a>,</li>
  <li><a href="/TR/CSS21/box.html#border-properties">border properties</a>,</li>
  <li><a href="/TR/CSS21/colors.html#propdef-color">color</a>,</li>
  <li><a href="/TR/CSS21/generate.html#content">content</a>,</li>
  <li><a href="/TR/CSS21/fonts.html">font properties</a>,</li>
  <li><a href="/TR/CSS21/visudet.html#the-height-property">height</a>,</li>
  <li><a href="/TR/CSS21/visudet.html#line-height">line-height</a></li>
  <li><a href="/TR/CSS21/box.html#margin-properties">margin properties</a>,</li>
  <li><a href="/TR/CSS21/box.html#padding-properties">padding properties</a>,</li>
  <li><a href="/TR/CSS21/text.html">text properties</a>,</li>
  <li><a href="/TR/CSS21/visufx.html#visibility">visibility</a>,</li>
  <li><a href="/TR/CSS21/visudet.html#the-width-property">width</a></li>
</ul>

<p>A detailed list of properties that <em class="RFC2119">MUST</em> be supported
within page and margin contexts by a conforming implementation can be found in
<a href="#Appendix_A">Appendix A</a>.</p>

<p>Other properties defined by [[!CSS21]] are ignored in these contexts. Behavior
for properties not included in CSS 2.1 and not listed here or in Appendix A is
undefined.</p>
<p class="note">
Note: The intent of leaving other properties undefined is to allow the gradual
addition of appropriate CSS3 properties as they emerge, without having to
update this specification with each addition.</p>

<p>The normal rules for box properties apply with the following exceptions:</p>

<ul>
  <li>Values in units of <span class="css">'em'</span> and <span class="css">'ex'</span> are interpreted relative to their context. The <a href="#page-context">page context</a> has a font associated with it by an explicit
  use of font properties, or from the UA's default style sheet, or from their
  initial values. (When the value is taken from the UA's default style sheet, the
  UA may choose to apply the value of the root element's 'font-family' property.)
  A margin context has a font association via explicit use of font properties
  within the margin context, or via inheritance from the page context.</li>
  <li>Percentage values on the margin and padding properties are relative to the
  dimensions of the containing block. For right and left values, percentages are
  relative to the width of the containing block; for top and bottom values,
  percentages are relative to the height of the containing block.</li>
  <li>The <span class="property">'width'</span> and <span class="property">'height'</span> properties do not apply to the page box.</li>
  <li>The page background covers the entire page box, including the page margins.
    Background images are positioned as for any other box; however if the
    'background-attachment' is 'fixed' then the image is placed relative to the
    page box instead.</li>
</ul>

<p>The page background and borders are painted first. Margin-boxes are painted
over (on top of) the page box. The root element then paints the canvas and the
document contents within the page padding box. <span class="issue">Check this:
should margin boxes be painted over the canvas background?</span></p>

<p>The exact painting order of margin boxes is not specified, however it is
<em class="RFC2119">recommended</em> that when margin boxes overlap, paint
order should place center/middle margin boxes on top of corner margin boxes,
which are in turn painted on top of other boxes. More precisely, in terms of
the algorithm in <a href="http://www.w3.org/TR/CSS21/zindex.html">CSS2.1
Appendix E</a> the exact "tree order" of margin boxes is not defined, but it
is recommended that center/middle boxes be after corner boxes, which should
themselves be after other boxes.</p>

<p>It is <em class="RFC2119">recommended</em> that user agents establish a default
page margin via the user agent stylesheet that includes any non-printable area.
It is further <em class="RFC2119">recommended</em> that authors assume that the
default page area will not include unprintable regions.</p>

<h2 id="page-size">Page size</h2>

<p>People around the world use many different paper sizes. It is a goal of this
specification that web content should be adaptable to a range of different
sizes without having to write a specific style sheet for each paper size.</p>

<p>However, in some situations it is important that a certain page size achieves a
certain style. One way to achieve this goal is to utilize the 'size' property,
which indicates that the document should preferentially be displayed on a
surface of a certain size; another method is to use Media Queries [[MEDIAQ]]
which allow different style sheets to be applied to different page sizes.</p>

<h3 id="page-size-prop">Page size: the 'size' property</h3>
<table class="propdef" summary="definition of the size property">
  <tr>
    <th>Name:
    <td><dfn id="size">size</dfn>
  <tr>
    <th>Value:
    <td>[ &lt;length&gt;{1,2} | auto | &lt;page-size&gt; ] || [ portrait | landscape]
  <tr>
    <th>Initial:
    <td>auto
  <tr>
    <td><em>Applies to:</em>
    <td>page context
  <tr>
    <th>Inherited:
    <td>N/A
  <tr>
    <th>Percentages:
    <td>N/A
  <tr>
    <th>Media:
    <td>paged
  <tr>
    <td><em>Computed value:</em>
    <td>specified value
</table>

<p>This property specifies the size and orientation of the
<a href="#page-box">page box</a>. In the general case, where one
page box is rendered onto one <a href="#page-sheet">page sheet</a>, the
<span class="property">'size'</span> property also indicates the size of the
destination page sheet.</p>

<p>The size of a page box can either be "absolute" (fixed size) or "relative"
(scalable, i.e., fitting available sheet sizes).</p>

<p>The first three values in the table below can be used to create relative page
boxes.</p>

<p>Other values define a fixed-size page box, and thereby indicate the preferred
output media size. When possible, output should be rendered on the media size
indicated. If the specified size is not available, the smallest available
larger size should be used; if not available, the contents of the page box
should be scaled down to fit the largest smaller page sheet available.</p>

<p>If a <code>size</code> property declaration specifies a page size that would
cause that declaration to not apply (e.g. a media query that qualifies it applies
only to a different paper size) then the declaration must be
<a href="http://www.w3.org/TR/CSS21/conform.html#ignore">ignored</a>.
<span class="issue">Is this a reasonable way of dealing with this conflict?</span></p>

<div class="example">
  <p>In the following example
  <pre>
  @page {
    size: 4in 6in;
  }
  
  @media (max-width: 6in) {
    @page {
      size: letter;
    }
  }
  </pre>
  <p>The second <code>size</code> declaration is ignored, i.e. the specified value
  of the <code>size</code> property is <code>4in 6in</code>.
</div>

<table class="page-sizes">
<tr>
<th>Value</th>
<th>Description</th>
</tr>
<tr>
<td>auto</td>
<td>The page box will be set to a size and orientation chosen by the UA. In the
usual case, the page box size and orientation is chosen to match the target
media sheet.</td>
</tr>
<tr>
<td>landscape</td>
<td>Specifies that the page's content be printed in landscape orientation. The
longer sides of the page box are horizontal. If a <span class="css">'&lt;page-size&gt;'</span> is not specified, the size of the page sheet
is chosen by the UA.</td>
</tr>
<tr>
<td>portrait</td>
<td>Specifies that the page's content be printed in portrait orientation. The
shorter sides of the page box are horizontal. If a <span class="css">'&lt;page-size&gt;'</span> is not specified, the size of the page sheet
is chosen by the UA.</td>
</tr>
<tr>
<td>&lt;length&gt;</td>
<td>The page box will be set to the given absolute dimension(s). If only one length
value is specified, it sets both the width and height of the page box (i.e.,
the box is a square). If two length values are specified, the first establishes
the page box width, and the second the page box height. Values in units of
<span class="css">'em'</span> and <span class="css">'ex'</span> refer to the
page context's font.</td>
</tr>
<tr>
<td>&lt;page-size&gt;</td>
<td>A page size can be specified using one of the following media names. This is
the equivalent of specifying the <span class="css">'&lt;page-size&gt;'</span>
using length values. The definition of the the media names comes from
<cite>Media Standardized Names</cite> [[!PWGMSN]].

<dl>

<dt>A5</dt>
<dd>Equivalent to the size of ISO A5 media: 148mm wide and 210 mm high.</dd>

<dt>A4</dt>
<dd>Equivalent to the size of IS0 A4 media: 210 mm wide and 297 mm high.</dd>

<dt>A3</dt>
<dd>Equivalent to the size of ISO A3 media: 297mm wide and 420mm high.</dd>

<dt>B5</dt>
<dd>Equivalent to the size of ISO B5 media: 176mm wide by 250mm high.</dd>

<dt>B4</dt>
<dd>Equivalent to the size of ISO B4 media: 250mm wide by 353mm high.</dd>

<dt>letter</dt>
<dd>Equivalent to the size of North American letter media: 8.5 inches wide and 11
inches high</dd>

<dt>legal</dt>
<dd>Equivalent to the size of North American legal: 8.5 inches wide by 14 inches
high.</dd>

<dt>ledger</dt>
<dd>Equivalent to the size of North American ledger: 11 inches wide by 17 inches
high.</dd>
</dl></td>
</tr>
</table>

<p>The '&lt;page-size&gt;' names can be used in conjunction with 'landscape' or
'portrait' to indicate both size and orientation.</p>

<h4>Some examples:</h4>

<div class="example">
<pre>
@page {
size: A4 landscape;
}
</pre>

<p>The above example sets the width of the page box to be 297mm and the height to
be 210mm. The page box in this example should be rendered on a page sheet size
of 210 mm by 297 mm.</p>
</div>

<div class="example">

<p>In the following example, the outer edges of the page box will align with the
page. The percentage value on the <span class="property">'margin'</span>
property is relative to the page size so if the page sheet dimensions are 210mm
x 297mm (i.e., A4), the margins are 21mm and 29.7mm. Assuming there are no page
borders or padding set in the UA default style sheet, the resulting page area
is 189mm by 367.3mm (210mm-21mm by 297mm-29.7mm).</p>
<pre>
@page {
size: auto;/* auto is the initial value */
margin: 10%;
}
</pre>
</div>

<div class="example">
<pre>
@page {
size: 8.5in 11in;/* width height */
}
</pre>

<p>The above example sets the width of the page box to be 8.5 inches and the
height to be 11 inches. This indicates that the page sheet size should be
8.5"x11" and the orientation 'portrait'.</p>
</div>

<h4 id="page-size-media-query">Media Queries</h4>

<p>This section is informative.</p>

<p>By using Media Queries [[MEDIAQ]], one style sheet can express different
stylistic preferences for different page sizes. Consider this example:</p>

<div class="example" style="font-size: 10pt;">
<pre>
 /* style sheet for "A4" printing */ 
 @media print and (width: 21cm) and (height: 29.7cm) {
    @page {
       margin: 3cm;
    }
 }
 
 /* style sheet for "letter" printing */
 @media print and (width: 8.5in) and (height: 11in) {
    @page {
        margin: 1in;
    }
 }
</pre>
</div>

<p>In the example above, "A4" sheets are given a "3cm" page margin, and "letter"
sheets are given a "1in" page margin.</p>

<h3 id="renderingpages">Rendering page boxes that do not fit a page sheet</h3>

<p>If a page box does not match the target page sheet dimensions, the user agent
<em class="RFC2119">MAY</em> choose (in order of preference) to:</p>

<ol>
  <li>Render the page box at the indicated size on a larger page sheet.</li>
  <li>Rotate the page box 90° if this will make the page box fit the page sheet.</li>
  <li>Scale the page box to fit the page sheet. (The aspect ratio of the page box
  <em class="RFC2119">should</em> be preserved.)</li>
  <li>Reformat the page contents, including 'spilling' onto other page sheets.</li>
  <li>Clip overflowed content (least preferred).</li>
</ol>

<p>The user agent <em class="RFC2119">MAY</em> wish to consult the user before
performing these operations.</p>

<h3 id="positioning-page-box">Positioning the page box on the sheet</h3>

<p>When the page box is smaller than the page size, the user agent <em class="RFC2119">SHOULD</em> either:</p>

<ul>
  <li>center the page box on the sheet since this will align double-sided pages
  and avoid accidental loss of information that is printed near the edge of the
  sheet; or</li>
  <li>position the page box in the upper left corner of the page sheet, as this
  may minimize media consumption.</li>
</ul>

<p>The user agent <em class="RFC2119">MAY</em> wish to consult the user in this
regard.</p><!-- "Page selector and page context" -->

<h2 id="margin-boxes">Margin Boxes</h2>

<p>Margin boxes are boxes within the page margin that, like pseudo-elements,
can contain generated content.</p>

<p>Margin boxes can be used to create page headers and footers, which are portions
of the page set aside for supplementary information such as the page number or
document title.</p>

<div class="example">
<p>Typically, a <dfn>page header</dfn> is located at the top of the page in
documents with a predominately horizontal writing direction and on the side
opposite the <a href="#binding-edge">binding edge</a> for documents with a
predominately vertical writing direction. One possible design of page headers
for horizontally written documents uses the <span class="css">'top-left-corner'</span>, <span class="css">'top-left'</span>,
<span class="css">'top-center'</span>, <span class="css">'top-right'</span> and
<span class="css">'top-right-corner'</span> margin boxes. Another design, for
vertically written documents, could use the <span class="css">'right-top'</span>, <span class="css">'right-middle'</span>, and
<span class="css">'right-bottom'</span> margin boxes for <a href="#right-page">right facing pages</a> and <span class="css">'left-top'</span>,
<span class="css">'left-middle'</span>, and <span class="css">'left-bottom'</span> for <a href="#left-page">left facing pages</a>.</p>

<p>The <dfn>page footer</dfn> is typically at the opposite end of the page from
the page header. For example, the design of a horizontally written document with
a page header at the top of the page could use the <span class="css">'bottom-left-corner'</span>, <span class="css">'bottom-left'</span>,
<span class="css">'bottom-center'</span>, <span class="css">'bottom-right'</span> and <span class="css">'bottom-right-corner'</span>
margin boxes as the page footer. The design of a vertically written document
could use the margin boxes of the binding edge of the page for the page footer.</p>
</div>

<p>Margin boxes are oriented with respect to the content and are independent of
page orientation, for example the top margin boxes are above the page area in
both portrait and landscape orientation. The various margin boxes are defined
and illustrated in the diagram below:

  <table id="margin-box-def" class="data" summary="defintion of each of the margin boxes">
    <caption>Table 1 Margin Box Definitions</caption>
    <thead>
      <tr>
        <th>Box</th>
        <th>Description</th>
        <th>Placement</th>
      </tr>
    </thead>
    <tbody>
      <tr id="top-margin-boxes-def">
        <th id="top-left-corner-box-def">top-left-corner</th>
        <td>a fixed-size box defined by the intersection of the top and left margins of the
        page box</td>
        <td><img src="TopLeftCornerBox.png" alt="the top left corner box with margin, border, and padding, nested within intersection of the page's top and left margins"
        height="47" width="181"></td>
      </tr>
      <tr id="top-left-box-def">
        <th>top-left</th>
        <td>a variable-width box filling the top page margin between the top-left-corner
        and top-center margin boxes</td>
        <td><img src="TopLeftMarginBox.png" alt="the top left box with margin, border, and padding, nested in the page's top margin next to the top left corner box"
        height="47" width="181"></td>
      </tr>
      <tr id="top-center-box-def">
        <th>top-center</th>
        <td>a variable-width box centered horizontally between the page's left and right
        border edges and filling the page top margin between the top-left and top-right
        margin boxes</td>
        <td><img src="TopCenterMarginBox.png" alt="the top center box with margin, border, and padding, centered within the page's top margin"
        height="47" width="181"></td>
      </tr>
      <tr id="top-right-box-def">
        <th>top-right</th>
        <td>a variable-width box filling the top page margin between the top-center and
        top-right-corner margin boxes</td>
        <td><img src="TopRightMarginBox.png" alt="the top right box with margin, border, and padding, nested within the page's top margin"
        height="47" width="181"></td>
      </tr>
      <tr>
        <th id="top-right-corner-box-def">top-right-corner</th>
        <td>a fixed-size box defined by the intersection of the top and right margins of
        the page box</td>
        <td><img src="TopRightCornerMarginBox.png" alt="the top right corner box with margin, border, and padding, nested within the intersection of the page's top and right margin"
        height="47" width="181"></td>
      </tr>
      <tr id="left-margin-boxes-def">
        <th id="left-top-box-def">left-top</th>
        <td>a variable-height box filling the left page margin between the top-left-corner
        and left-middle margin boxes</td>
        <td rowspan="3"><img src="LeftMarginBoxes.png" alt="left-top, left-middle, and left-bottom margin boxes in the page box's left margin"
        height="226" width="181"></td>
      </tr>
      <tr id="left-middle-box-def">
        <th>left-middle</th>
        <td>a variable-height box centered vertically between the page's top and bottom
        border edges and filling the left page margin between the left-top and
        left-bottom margin boxes</td>
      </tr>
      <tr id="left-bottom-box-def">
        <th>left-bottom</th>
        <td>a variable-height box filling the left page margin between the left-middle and
        bottom-left-corner margin boxes</td>
      </tr>
      <tr id="right-margin-boxes-def">
        <th id="right-top-box-def">right-top</th>
        <td>a variable-height box filling the right page margin between the
        top-right-corner and right-middle margin boxes</td>
        <td rowspan="3"><img src="RightMarginBoxes.png" alt="right-top, right-middle, and right-bottom margin boxes in the page box's right margin"
        height="226" width="181"></td>
      </tr>
      <tr id="right-middle-box-def">
        <th>right-middle</th>
        <td>a variable-height box centered vertically between the page's top and bottom
        border edges and filling the right page margin between the right-top and
        right-bottom margin boxes</td>
      </tr>
      <tr id="right-bottom-box-def">
        <th>right-bottom</th>
        <td>a variable-height box filling the right page margin between the right-middle
        and bottom-right-corner margin boxes</td>
      </tr>
      <tr id="bottom-margin-boxes-def">
        <th id="bottom-left-corner-box-def">bottom-left-corner</th>
        <td>a fixed-size box defined by the intersection of the bottom and left margins of
        the page box</td>
        <td><img src="BottomLeftCornerBox.png" alt="bottom left corner box with margin, border, and padding, nested within the page margin at the intersection of the left and bottom page margins"
        height="48" width="181"></td>
      </tr>
      <tr id="bottom-left-box-def">
        <th>bottom-left</th>
        <td>a variable-width box filling the bottom page margin between the
        bottom-left-corner and bottom-center margin boxes</td>
        <td><img src="BottomLeftMarginBox.png" alt="bottom left margin box with margin, border, and padding, nested within the page's bottom margin next to the bottom-left-corner box"
        height="48" width="181"></td>
      </tr>
      <tr id="bottom-center-box-def">
        <th>bottom-center</th>
        <td>a variable-width box centered horizontally between the page's left and right
        border edges and filling the bottom page margin between the bottom-left and
        bottom-right margin boxes</td>
        <td style="vertical-align: middle;"><img src="BottomCenterMarginBox.png" alt="bottom center box with margin, border, and padding, nested within the page's bottom margin and centered on the page"
        height="48" width="181"></td>
      </tr>
      <tr id="bottom-right-box-def">
        <th>bottom-right</th>
        <td>a variable-width box filling the bottom page margin between the bottom-center
        and bottom-right-corner margin boxes</td>
        <td><img src="BottomRightMarginBox.png" alt="bottom right margin box with margin, border, and padding, nested within the page's bottom margin and next to the bottom-right-corner box"
        height="48" width="181"></td>
      </tr>
      <tr id="bottom-right-corner-box-def">
        <th>bottom-right-corner</th>
        <td>a fixed-size box defined by the intersection of the bottom and right margins of
        the page box</td>
        <td><img src="BottomRightCornerBox.png" alt="bottom right corner box with margin, border, and padding, nested within the page margin at the intersection of the right and bottom page margins"
        height="48" width="181"></td>
      </tr>
    </tbody>
  </table>

<p>Margin boxes are created through <a href="#margin-at-rules">margin at-rules</a>
inside the <a href="#page-context">page context</a>.</p>

<h3 id="margin-at-rules">At-rules for margin boxes</h3>

<p>A <dfn id="margin-at-rule">margin at-rule</dfn> consists of an <a href="#specializatons-of-ATKEYWORD">ATKEYWORD</a> that identifies the margin box
(e.g. <span class="css">'@top-left'</span>) and a block of declarations (said
to be in the <dfn id="margin-context">margin context</dfn>).</p>

<div class="example">

<p>The following style sheet establishes a page header containing the title
("Hamlet") on the left side and the page number, preceded by "Page ", on the
right side:</p>
<pre>
@page {
  size: 8.5in 11in;
  margin: 10%;

  @top-left {
    content: "Hamlet";
  }
  @top-right {
    content: "Page " counter(page);
  }
}
</pre>
</div>

<h3 id="margin-box-dimensions">Computing Margin Box Dimensions</h3>

<p>The width and height of each margin box is determined by the rules
below.</p>

<h4 id="max-margin-dimension">Margin Box Terminology</h4>

<p>In addition to the box model definitions in CSS2.1 [[!CSS21]], the following
terms are defined for use in the subsequent margin box calculations:</p>

<dl>

<dt id="MaxBoxWidth">max box width</dt>
<dd>the sum of the page's left border width, left padding,
<a href="#page-box">page area</a> width, right padding, and right border width.
In other words, it is the distance between the <a href="#page-box">page
box</a>'s left border edge and right border edge</a>. This quantity is used
when calculating dimensions of the top and bottom margin boxes.</dd>

<dt id="MaxBoxHeight">max box height</dt>
<dd>the sum of the page's top border width, top padding,
<a href="#page-box">page area</a> height, bottom padding, and bottom border
width. In other words, it is the distance between the <a href="#page-box">page
box</a>'s top border edge and bottom border edge. This quantity is used when
calculating dimensions of the left and right margin boxes.</dd>

<dt>outer width</dt>
<dd>the sum of a margin box's left and right margins, left and right border
widths, left and right padding, and content-box width.</dd>

<dt>outer height</dt>
<dd>the sum of a margin box's top and bottom margins, top and bottom border
widths, used top and bottom padding, and content-box height.</dd>
</dl>

<p>The <dfn>containing block</dfn> for a corner margin box is the rectangle
defined by the intersection of the two page margins meeting at that corner.</p>

<p>For all other margin boxes, the <dfn>containing block</dfn> is the rectangle
formed by the encapsulating page margin minus the containing blocks of the
adjacent corners' margin boxes. Note that the size of this containing block is
given in one dimension by the used page margin and in the other dimension by
the <a href="#MaxBoxWidth">max box width</a> (for top and bottom margin boxes)
or <a href="#MaxBoxHeight">max box height</a> (for left and right margin
boxes) for the other.</p>

<h4 id="margin-dimension">Margin Box Variable Dimension Computation Rules</h4>

<p>The following rules apply to 'top-left', 'top-center' and 'top-right' margin
boxes, which are referred to as A, B, and C, respectively, in the expression
below.</p>

<ul>
<li>The UA chooses used values for each box's width, left and right margin,
  left and right border thickness, and left and right padding. It chooses them in
  such a way that the sum of the squares of the boxes' left and right margins,
  i.e. the value of:
  <div class="equation">
    margin-left<sub>A</sub>² + margin-left<sub>B</sub>² + margin-left<sub>C</sub>² + margin-right<sub>A</sub>² + margin-right<sub>B</sub>² + margin-right<sub>C</sub>²
  </div>
  is as small as possible under the constraints below.

  <ol>
    <li>The sum of the outer widths of the three boxes is equal to max box width.
      (Margin box margins do not collapse.)</li>
    <li>If the center box is not empty or if its computed width is not 'auto', then
    the outer widths of the other two boxes are equal to each other (i.e., the
    center box is centered in that case).</li>
    <li>If a box is empty and its computed width is 'auto', then the used values of
    its left and right padding width and left and right border width are all 0.
    (This makes such a box invisible, because, by item 5, its width is also 0.)</li>
    <li>The used values of the margin boxes' left and right margins are their
    respective computed values, unless the respective computed value is 'auto'.</li>
    <li>If a box's computed width is 'auto', then its used width must be greater
    than or equal to its <a href="/TR/CSS21/visudet.html#float-width">preferred
    minimum width</a>.</li>
    <li>If a box's computed width is 'auto', then its used width must also be less
    than or equal to its <a href="/TR/CSS21/visudet.html#float-width">preferred
    width</a>.</li>
  </ol>
</li>
<li>If the above constraints are contradictory ("over-constrained"), then drop
  rule 6 above. If they are still contradictory, then the right margin of the
  left box and the left margin of the right box are treated as if their computed
  values were 'auto'.</li>
</ul>

<p class="note">
Note: By their definitions, margins can be negative, but widths cannot.</p>

<p>The used values for 'bottom-left', 'bottom-center' and 'bottom-right' margin
boxes are established by the same rules as for 'top-left', 'top-center', and
'top-right', respectively.</p>

<p>The used values for 'left-top', 'left-middle' and 'left-bottom' boxes are
established by the same rules, with "width" replaced by "height", "left" by
"top", "right" by "bottom" and "center" by "middle".</p>

<p>The used values for 'right-top', 'right-middle' and 'right-bottom' margin boxes
are established by the same rules as for 'left-top', 'left-middle' and
'left-bottom', respectively.</p>

<h4 id="margin-constraints">Margin Box Fixed Dimension Computation Rules</h4>

<p>The following constraints must hold among the used values of each
'top-left-corner', 'top-left', 'top-center', 'top-right', and
'top-right-corner' margin box's properties:</p>
<blockquote>

<p>'margin-top' + 'border-top-width' + 'padding-top' + 'height' + 'padding-bottom'
+ 'border-bottom-width' + 'margin-bottom' = top page margin.</p>
</blockquote>

<p>If 'height' is not 'auto' and 'border-top-width' + 'padding-top' + 'height' +
'padding-bottom' + 'border-bottom-width' (plus any of 'margin-top' or
'margin-bottom' that are not 'auto') is larger than the height of the top page
margin, then any 'auto' values for 'margin-top' or 'margin-bottom' are, for the
following rules, treated as zero.</p>

<p>If all of the above have a computed value other than 'auto', the values are
said to be "over-constrained". In this case, the specified value of
'margin-top' is ignored and the value is calculated so as to make the equality
true.</p>

<p>If there is exactly one value specified as 'auto', its used value follows from
the equality.</p>

<p>If 'height' is set to 'auto', any other 'auto' values become '0' and 'height'
follows from the resulting equality.</p>

<p>If both 'margin-top' and 'margin-bottom' are 'auto', their used values are
equal. This vertically centers the margin-box content within the top page
margin.</p>

<p>The same rules apply to the bottom margin boxes (bottom-left-corner,
bottom-left, bottom-center, bottom-right, and bottom-right-corner), except that
in the overconstrained case, the 'margin-bottom' is ignored rather than the
'margin-top'.</p>

<p>Analogous rules govern the properties for the left and right margin boxes with
respect to 'width' (top-left-corner, left-top, left-middle, left-bottom, and
bottom-left-corner; top-right-corner, right-top, right-middle, right-bottom,
bottom-right-corner), with 'top' replaced by 'left', 'bottom' replaced by
'right', and 'height' replaced by 'width'. In the overconstrained case for left
(right) margin boxes, the specified value of 'margin-left' ('margin-right') is
ignored.</p>

<h3 id="margin-text-alignment">Margin boxes and default values</h3>

<p>Properties used within page or margin contexts take their initial values from
their respective property definitions; however, user agents must behave as
though the values in the following table were established by rules in the UA
default style sheet.</p>
<table id="margin-values" class="data" summary="definition of margin box default properties">
  <caption>Table 2. Default values for Margin Boxes</caption>
  <thead>
    <tr>
      <th>Margin box</th>
      <th><span class="property">'text-align'</span></th>
      <th><span class="property">'vertical-align'</span></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#top-left-corner-box-def">top-left-corner</a></td>
      <td>right</td>
      <td>middle</td>
      </tr>
    <tr>
      <td><a href="#top-left-box-def">top-left</a></td>
      <td>left</td>
      <td>middle</td>
      </tr>
    <tr>
      <td><a href="#top-center-box-def">top-center</a></td>
      <td>center</td>
      <td>middle</td>
      </tr>
    <tr>
      <td><a href="#top-right-box-def">top-right</a></td>
      <td>right</td>
      <td>middle</td>
      </tr>
    <tr>
      <td><a href="#top-right-corner-box-def">top-right-corner</a></td>
      <td>left</td>
      <td>middle</td>
      </tr>
    <tr>
      <td><a href="#left-top-box-def">left-top</a></td>
      <td>center</td>
      <td>top</td>
      </tr>
    <tr>
      <td><a href="#left-middle-box-def">left-middle</a></td>
      <td>center</td>
      <td>middle</td>
      </tr>
    <tr>
      <td><a href="#left-bottom-box-def">left-bottom</a></td>
      <td>center</td>
      <td>bottom</td>
      </tr>
    <tr>
      <td><a href="#right-top-box-def">right-top</a></td>
      <td>center</td>
      <td>top</td>
      </tr>
    <tr>
      <td><a href="#right-middle-box-def">right-middle</a></td>
      <td>center</td>
      <td>middle</td>
      </tr>
    <tr>
      <td><a href="#right-bottom-box-def">right-bottom</a></td>
      <td>center</td>
      <td>bottom</td>
      </tr>
    <tr>
      <td><a href="#bottom-left-corner-box-def">bottom-left-corner</a></td>
      <td>right</td>
      <td>middle</td>
      </tr>
    <tr>
      <td><a href="#bottom-left-box-def">bottom-left</a></td>
      <td>left</td>
      <td>middle</td>
      </tr>
    <tr>
      <td><a href="#bottom-center-box-def">bottom-center</a></td>
      <td>center</td>
      <td>middle</td>
      </tr>
    <tr>
      <td><a href="#bottom-right-box-def">bottom-right</a></td>
      <td>right</td>
      <td>middle</td>
      </tr>
    <tr>
      <td><a href="#bottom-right-corner-box-def">bottom-right-corner</a></td>
      <td>left</td>
      <td>middle</td>
    </tr>
  </tbody>
</table>

<h3 id="populating-margin-boxes">Populating margin boxes</h3>

<p>A margin box is instantiated if a margin context is established and one of the following conditions holds:</p>

<ul>
<li>The computed value of <span class="property">'content'</span> is not <span class="css">'none'</span>. </li>
<li>Either <span class="property">'width'</span> or <span class="property">'height'</span> are set in the margin context.</li>
</ul>


<div class="example">

<p>This example style sheet could be used to create a centered header with the
current chapter name:</p>
<pre>body {counter-reset: chapter;}
div.chapter {counter-increment: chapter;}
@page {
margin: 10%;
@top-center { content: "Chapter" counter(chapter) }
}
</pre>
</div>

<h3 id="margin-box-ex">Margin box examples</h3>

<p>The following is a collection of examples of margin box usage.</p>

<div class="example">

<p>Here is an example of a page with only a top-left header:</p>
<pre>
@page {
@top-left { content: "Header in Left Cell (top-left)" }
}
</pre>

<p>Because there are no contents defined for the top-center or the top-right
margin boxes, the extent of the top-left margin box is allowed to cross the
center of the page box.</p>

<p><img alt="Header Example 1" src="header-ex-1.png" height="177" width="737"></p>
</div>

<div class="example">

<p>The following is an example of a page with a centered header:</p>
<pre>
@page {
@top-center { content: "Header in Center Cell (top-center)" }
}
</pre>

<p><img alt="Header Example 2" src="header-ex-2.png" height="177" width="737"></p>
</div>

<div class="example">

<p>The following is an example of a page with a single header in the top-right
margin box:</p>
<pre>
@page {
@top-right { content: "Header in Right Cell (top-right)" }
}
</pre>

<p>Because the content of the center cell is empty, the extent of the top-right
margin box is allowed to cross the center of the page box.</p>

<p><img alt="Header Example 3" src="header-ex-3.png" height="177" width="737"></p>
</div>

<div class="example">

<p>The following is an example of a page with a top-center and a top-left header:</p>
<pre>
@page {
@top-left { content: "Left Cell (top-left)" }
@top-center { content: "Header in Center Cell (top-center)" }
}
</pre>

<p><img alt="Header Example 4" src="header-ex-4.png" height="177" width="737"></p>
</div>

<div class="example">

<p>The following is an example of a page with a top-center and a top-right header:</p>
<pre>
@page {
@top-center { content: "Header in Center Cell (top-center)" }
@top-right { content: "Right Cell (top-right)" }
}
</pre>

<p><img alt="Header Example 5" src="header-ex-5.png" height="177" width="737"></p>
</div>

<div class="example">

<p>The following is an example of a page with top-left and top-right headers:</p>
<pre>
@page {
@top-left { content: "Header in top-left with approx. "
                   "twice as many words as right cell." }
@top-right { content: "Right cell (top-right)" }
}
</pre>

<p>Because there are no center cell contents, the extent of the top-left is
allowed to cross the center of the page box. As the intrinsic width of the
top-left contents is approximately twice the intrinsic width of that of the
top-right, the top-left margin box is approximately twice as wide as the
top-right margin box.</p>

<p><img alt="Header Example 6" src="header-ex-6.png" height="177" width="737"></p>
</div>

<h2 id="page-breaks">Page Breaks</h2>

<p>The following sections explain page breaking in CSS3 paged media. Five
properties indicate where the user agent <em class="RFC2119">MAY</em> or
<em class="RFC2119">SHOULD</em> break pages, and on what page (left or right)
the subsequent content <em class="RFC2119">SHOULD</em> resume. Each page break
ends layout in the current <a href="#page-box">page box</a> and causes
remaining pieces of the document tree to be laid out in a new page box.</p>

<p>When a page break splits a box, the box's bottom margins, borders, and padding
have no visual effect where the split occurs; the box's background and left and
right margins, border, and padding extend to the bottom of the page, through an
ensuing blank page if one exists, and onto the top of the subsequent page.</p>

<h3 id="pg-br-before-after">Break before/after elements: <span class="property">'page-break-before'</span>,
<span class="property">'page-break-after'</span>, <span class="property">'page-break-inside'</span></h3>

<table class="propdef" summary="property definition">
  <tr>
    <th>Name:
    <td><dfn id="page-break-before">page-break-before</dfn>
  <tr>
    <th>Value:
    <td>auto | always | avoid | left | right
  <tr>
    <th>Initial:
    <td>auto
  <tr>
    <th>Applies to:
    <td>block-level elements
  <tr>
    <th>Inherited:
    <td>no
  <tr>
    <th>Percentages:
    <td>N/A
  <tr>
    <th>Media:
    <td>paged
  <tr>
    <th>Computed value:
    <td>specified value
</table>

<table class="propdef" summary="property definition">
  <tr>
    <th>Name:
    <td><dfn id="page-break-after">page-break-after</dfn>
  <tr>
    <th>Value:
    <td>auto | always | avoid | left | right
  <tr>
    <th>Initial:
    <td>auto
  <tr>
    <th>Applies to:
    <td>block-level elements
  <tr>
    <th>Inherited:
    <td>no
  <tr>
    <th>Percentages:
    <td>N/A
  <tr>
    <th>Media:
    <td>paged
  <tr>
    <th>Computed value:
    <td>specified value
</table>

<table class="propdef" summary="property definition">
  <tr>
    <th>Name:
    <td><dfn id="page-break-inside">page-break-inside</dfn>
  <tr>
    <th>Value:
    <td>auto | avoid
  <tr>
    <th>Initial:
    <td>auto
  <tr>
    <th>Applies to:
    <td>block-level elements
  <tr>
    <th>Inherited:
    <td>no
  <tr>
    <th>Percentages:
    <td>N/A
  <tr>
    <th>Media:
    <td>paged
  <tr>
    <th>Computed value:
    <td>specified value
</table>
      
<p>Values for these properties have the following meanings:</p>

<dl>

<dt>auto</dt>
<dd>Neither force nor forbid a page break before / after / inside the generated
box.</dd>

<dt>always</dt>
<dd>Always force a page break before / after the generated box.</dd>

<dt>avoid</dt>
<dd>Avoid a page break before / after / inside the generated box.</dd>

<dt>left</dt>
<dd>Force one or two page breaks before (after) the generated box so that the next
page is formatted as a left page.</dd>

<dt>right</dt>
<dd>Force one or two page breaks before (after) the generated box so that the next
page is formatted as a right page.</dd>
</dl>

<p>A potential page break location is typically under the influence of the parent
element's <span class="property">'page-break-inside'</span> property, the
<span class="property">'page-break-after'</span> property of the preceding
element, and the <span class="property">'page-break-before'</span> property of
the following element. When these properties have values other than
<span class="css">'auto'</span>, the values <span class="css">'always'</span>,
<span class="css">'left'</span>, and <span class="css">'right'</span> take
precedence over <span class="css">'avoid'</span>. See the section on <a href="#allowed-pg-brk">allowed page breaks</a> for the exact rules on how these
properties affect page breaks.</p>

<h3 id="using-named-pages">Using named pages: 'page'</h3>
<table class="propdef" summary="property definition">
  <tr>
    <th>Name:
    <td><dfn id="page">page</dfn>
  <tr>
    <th>Value:
    <td>&lt;identifier&gt;
  <tr>
    <th>Initial:
    <td>none
  <tr>
    <th>Applies to:
    <td>block-level elements
  <tr>
    <th>Inherited:
    <td>yes
  <tr>
    <th>Percentages:
    <td>N/A
  <tr>
    <th>Media:
    <td>paged
  <tr>
    <th>Computed value:
    <td>specified value
</table>
      
<p>The <span class="property">'page'</span> property is used to specify a
particular type of page where an element <em class="RFC2119">SHOULD</em> be
displayed.</p>

<div class="example">

<p>This example will put all tables on a right-hand side landscape page (named
"rotated"):</p>
<pre>
@page rotated { size: landscape }
table { page: rotated; page-break-before: right }
</pre>
</div>

<p>The <span class="property">'page'</span> property works as follows: If a block
box with inline content has a <span class="property">'page'</span> property
that is different from the preceding block box with inline content, then one or
two page breaks are inserted between them, and the boxes after the break are
rendered on a page box of the named type. See <a href="#forced-pg-brk">"Forced
page breaks" below</a>.</p>

<div class="example">

<p>In this example, the two tables are rendered on landscape pages (indeed, on the
same page, if they fit). The page type "narrow" is used for the &lt;p&gt; after
the second table, as the page properties for the table element are no longer in
effect:</p>
<pre>
@page narrow { size: 9cm 18cm }
@page rotated { size: landscape }
div { page: narrow }
table { page: rotated }
</pre>with this document:
<pre>
&lt;div&gt;
&lt;table&gt;...&lt;/table&gt;
&lt;table&gt;...&lt;/table&gt;
&lt;p&gt;This text is rendered on a 'narrow' page&lt;/p&gt;
&lt;/div&gt;
</pre>
</div>

<h3 id="breaks-inside">Breaks inside elements: 'orphans', 'widows'</h3>
<table class="propdef" summary="property definition">
  <tr>
    <th>Name:
    <td><dfn id="orphans">orphans</dfn>
  <tr>
    <th>Value:
    <td>&lt;integer&gt;
  <tr>
    <th>Initial:
    <td>2
  <tr>
    <th>Applies to:
    <td>block-level elements
  <tr>
    <th>Inherited:
    <td>yes
  <tr>
    <th>Percentages:
    <td>N/A
  <tr>
    <th>Media:
    <td>visual
  <tr>
    <th>Computed value:
    <td>specified value
</table>

<table class="propdef" summary="property definition">
  <tr>
    <th>Name:
    <td><dfn id="widows">widows</dfn>
  <tr>
    <th>Value:
    <td>&lt;integer&gt;
  <tr>
    <th>Initial:
    <td>2
  <tr>
    <th>Applies to:
    <td>block-level elements
  <tr>
    <th>Inherited:
    <td>yes
  <tr>
    <th>Percentages:
    <td>N/A
  <tr>
    <th>Media:
    <td>visual
  <tr>
    <th>Computed value:
    <td>specified value
</table>

<p>The <span class="property">'orphans'</span> property specifies the minimum
number of line boxes in a block element that <em class="RFC2119">MUST</em> be
left at the bottom of a page. The <span class="property">'widows'</span>
property specifies the minimum number of line boxes of a block element that
<em class="RFC2119">MUST</em> be left at the top of a page. Examples of how
they are used to control page breaks are given below.</p>

<p>If a block contains fewer lines than the value of 'widows' or 'orphans', the
rule is relaxed.</p>

<h3 id="allowed-pg-brk">Allowed page breaks</h3>

<p>In the normal flow, page breaks <em class="RFC2119">may</em> occur at the
following places:</p>

<ol>
<li>In the vertical margin between sibling block boxes (or rows in a table).
When a page break occurs here, the used values of the adjoining <span class="property">'margin-bottom'</span> and <span class="property">'margin-top'</span> properties are set to <span class="css">'0'</span>.</li>
<li>Between line boxes inside a block box.</li>
</ol>

<p>These breaks are subject to the following rules:</p>

<ul>
  <li><strong>Rule A:</strong> Breaking at (1) is allowed only if the <span class="property">'page-break-after'</span> and <span class="property">'page-break-before'</span> properties of all the elements generating
  boxes that meet at this margin allow it, which is when at least one of them has
  the value <span class="css">'always'</span>, <span class="css">'left'</span>,
  or <span class="css">'right'</span>, or when all of them are <span class="css">'auto'</span>.</li>
  <li><strong>Rule B:</strong> However, if all of them are <span class="css">'auto'</span> and a common ancestor of all the elements has a
  <span class="property">'page-break-inside'</span> value of <span class="css">'avoid'</span>, then breaking here is not allowed.</li>
  <li><strong>Rule C:</strong> Breaking at (2) is allowed only if the number of line
  boxes between the break and the start of the enclosing block box is the value
  of <span class="property">'orphans'</span> or more, and the number of line
  boxes between the break and the end of the box is the value of <span class="property">'widows'</span> or more.</li>
  <li><strong>Rule D:</strong> In addition, breaking at (2) is allowed only if the
  <span class="property">'page-break-inside'</span> property of all ancestors is
  <span class="css">'auto'</span>.</li>
</ul>

<p>If the above doesn't provide enough break points to keep content from
overflowing the page boxes, then rules A, B and D are dropped in order to find
additional breakpoints. In this case the UA may use the 'avoid's that are in
effect at those points to weight the appropriateness of the new breakpoints;
however, this specification does not suggest a precise algorithm.</p>

<p>If that still does not lead to sufficient break points, rule C is dropped as
well, to find still more break points.</p>

<h3 id="forced-pg-brk">Forced page breaks</h3>

<p>A page break <em class="RFC2119">MUST</em> occur at (1) if, among the
<span class="property">'page-break-after'</span> and <span class="property">'page-break-before'</span> properties of all the elements generating
boxes that meet at this margin, there is at least one with the value
<span class="css">'always'</span>, <span class="css">'left'</span>, or
<span class="css">'right'</span>.</p>

<p>When multiple 'page-break-before' and/or 'page-break-after' properties with
values of "always", "left" or "right" apply at a margin, only one of them
should generate page breaks. That is, no content-empty pages are generated by
page-break properties, except for at most one content-empty page as may be
required by 'right' and 'left' values to position ensuing content on a right-
or left-facing page.</p>

<p>A page break <em class="RFC2119">MUST</em> also occur at (1) if the last line
box above this margin and the first one below it do not have the same value for
<span class="property">'page'</span>.</p>


<h3 id="best-pg-brk">"Best" page breaks</h3>

<p>CSS3 does <em>not</em> define which of a set of allowed page breaks <em class="RFC2119">MUST</em> be used; except as defined earlier in the section, CSS3
does not forbid a user agent to break at every possible break point, or to not
break at all. But CSS3 does recommend that user agents observe the following
guidelines (while recognizing that they are sometimes contradictory):</p>

<ul>
  <li>Break as few times as possible.</li>
  <li>Make all pages that don't end with a forced break appear to have about the
  same height.</li>
  <li>Avoid breaking inside a block that has a border.</li>
  <li>Avoid breaking inside a table.</li>
  <li>Avoid breaking inside a floated element.</li>
</ul>

<div class="example">

<p>Suppose, for example, that the style sheet contains <span class="css">'orphans
: 4'</span>, <span class="css">'widows : 2'</span>, and there are 20 lines
(line boxes) available at the bottom of the current page, and the next block in
normal flow is considered for placement:</p>

<ul>
  <li>If the block contains 20 line boxes or fewer, it <em class="RFC2119">SHOULD</em> be placed on the current page.</li>
  <li>If the block contains 21 or 22 line boxes, the second part of the paragraph
  <em class="RFC2119">MUST</em> not violate the <span class="property">'widows'</span> constraint, and so the second part <em class="RFC2119">MUST</em> contain at least two line boxes; likewise the first part
  <em class="RFC2119">MUST</em> contain at least four line boxes.</li>
  <li>If the block contains 23 line boxes or more, the first part <em class="RFC2119">SHOULD</em> contain 20 lines and the second part the remaining lines.
  (But if any part of the block is placed on the current page, that part
  <em class="RFC2119">MUST</em> contain at least four line boxes and the second
  part at least two line boxes.)</li>
</ul>

<p>Now suppose that <span class="property">'orphans'</span> is <span class="css">'10'</span>, <span class="property">'widows'</span> is <span class="css">'20'</span>, and there are 8 lines available at the bottom of the current
page:</p>

<ul>
  <li>If the block contains 8 lines or fewer, it <em class="RFC2119">SHOULD</em>
  be placed on the current page.</li>
  <li>If the block contains 9 lines or more, it <em class="RFC2119">MAY NOT</em>
  be split (that would violate the orphan constraint), so it <em class="RFC2119">MUST</em> move as a block to the next page.</li>
</ul>
</div>

<h2 id="pg-based-extensions">Page-based Extensions to Counters</h2>

<h3 id="page-based-counters">Page-based counters</h3>

<p>Counters apply to page contexts defined by means of the <span class="css">'@page'</span> rule. This is useful for maintaining a page count.</p>

<div class="example">

<p>The following rules result in the placement of the current page number in the
middle of the outside margin of each page.</p>
<pre>
@page {
margin: 10%;
counter-increment: page;

@top-center {
  font-family: sans-serif;
  font-weight: bold;
  font-size: 2em;
  content: counter(page);
}
}
</pre>
</div>

<p>A 'counter-increment' within either a page or margin context causes the counter
to increment with the generation of each page box.</p>

<p>If a counter is reset or incremented within the page context, it is in scope
for all margin boxes and obscures all counters of the same name within the
document.</p>

<p>If a counter is reset or incremented within a margin context, it is in scope
for that margin box and obscures any counters of the same name in both the page
context and the document.</p>

<p>If a counter that has not been reset or incremented within the margin context
or the page context is used by counter() or counters() in the margin context,
then the resultant value is exactly as if the margin box were an element within
the document at the start of the page, inside the deepest element in the normal
flow that spans the page break. Use of the counter in this way does not affect
the calculation of the counter's value.</p>

<p>In the absence of a 'counter-reset' or 'counter-increment' for a counter named
'page', the UA must automatically create and increment such a counter as if
"@page { counter-increment: page;}" were specified.</p>

<p>In all other respects, page-associated counters behave as described in
[[!CSS21]], <a href="TR/CSS21/generate.html#scope">Nested Counters and
Scope</a> and <a href="/TR/CSS21/syndata.html#counter">Counters</a>.</p>

<h2 id="image-properties">Image Properties</h2>

<h3 id="image-orientation">Orienting an Image on the Page: the <a href="#propdef-img-orient">image-orientation</a> property</h3>

<p>Images from camera phones, digital cameras or scanners may be encoded sideways.
For example, the first row of image data may represent the leftmost or
rightmost column of image pixels. Furthermore, often such devices have limited
resources, and do not have the capability to rotate the image into an upright
orientation. However, this type of device may have internal knowledge or can
accept input from its user as to the rotational correction to perform.</p>

<p>The image-orientation property provides a way to specify an 'out-of-band'
rotation to be applied to image source data. This facility is not intended to
specify layout transformations such as arbitrary rotation or flipping the image
in the horizontal or vertical direction. It is not needed to correctly orient
an image when printing in landscape versus portrait orientation, as that
rotation is done as part of layout.</p>

<table class="propdef" summary="image-orientation property definition">
  <tr>
    <th>Name:
    <td><dfn id="propdef-img-orient">image-orientation</dfn>
  <tr>
    <th>Value:
    <td>&lt;angle&gt; | intrinsic
  <tr>
    <th>Initial:
    <td>0deg
  <tr>
    <th>Applies to:
    <td>images
  <tr>
    <th>Inherited:
    <td>N/A
  <tr>
    <th>Percentages:
    <td>N/A
  <tr>
    <th>Media:
    <td>visual
  <tr>
    <th>Computed value:
    <td>normalized angle or 'intrinsic'
</table>

<p>'image-orientation' specifies an orthogonal rotation to be applied to an image
before it is laid out. CSS layout processing applies to the image after
rotation. This implies, for example:</p>

<ul>
<li>The intrinsic height and width are derived from the rotated rather than the
original image dimensions;</li>
<li>The height (width) property applies to the vertical (horizontal) dimension
of the image, <em>after</em> rotation.</li>
</ul>

<p>The following values for the <span class="property">'image-orientation'</span>
property apply to an image:</p>

<dl>

<dt>intrinsic</dt>
<dd>The image will be oriented according to orientation metadata contained within
the image source data. If no such metadata is available, the image is oriented
as for '0deg'.</dd>

<dt>&lt;angle&gt;</dt>
<dd>Positive values cause the image to be rotated to the right (in a clockwise
direction), while negative values cause a rotation to the left. The angular
value in degrees, radians or grads is rounded to the nearest cardinal angle.
Values half way between cardinal angles, such as 45deg, round forward, in the
direction of rotation. Values greater than 360deg or less than -360deg are
moduloed to produce a value between 0deg and 360deg. Analogous rules apply for
rad and grad unit values.</dd>
</dl>
<pre class="example">
The following example rotates the image 90 degrees clockwise:

img.ninety     { image-orientation: 90deg }
...
&lt;img class="ninety" src=... /&gt;
</pre>

<h3 id="img-fit-img-posn">The 'image-fit' and 'image-position' Properties</h3>

<table class="propdef">
  <tr>
    <th>Name:
    <td><dfn id="propdef-image-scaling">image-fit</dfn>
  <tr>
    <th>Value:
    <td>fill | contain | cover
  <tr>
    <th>Initial:
    <td>fill
  <tr>
    <th>Applies to:
    <td>replaced elements
  <tr>
    <th>Inherited:
    <td>yes
  <tr>
    <th>Percentages:
    <td>N/A
  <tr>
    <th>Media:
    <td>visual
  <tr>
    <th>Computed value:
    <td>specified value
</table>

<p>The 'image-fit' property specifies how the contents of a replaced element
should be scaled relative to the box established by its used height and width.
It also enables scaling a replaced element's contents up to a specified maximum
size or down to a specified minimum size while preserving its aspect ratio.</p>

<p>Not all replaced elements can be scaled, but images typically can.</p>

<p>The contents of a replaced element with an intrinsic aspect ratio (which may be
derived from intrinsic dimensions) are scaled as follows:</p>

<dl>

<dt>fill</dt>
<dd>Determine the used 'height' and 'width' <a href="/TR/CSS21/visudet.html">as
usual</a>. Scale the content height and width independently so that the edges
of the content just meet the edges of the box established by the used 'height'
and 'width'.</dd>

<dt>contain</dt>
<dd>Determine the used 'height' and 'width' <a href="/TR/CSS21/visudet.html">as
usual</a>, except if both 'height' and 'width' are 'auto', and the used value
of at least one of 'max-width' and 'max-height' is not 'none', then compute the
element's used width and used height as though the intrinsic dimensions of the
contents were infinitely large numbers whose ratio is the actual intrinsic
ratio of the contents.</dd>
<dd>Scale the contents of the element, preserving their aspect ratio, to the
largest size such that the width of the contents is less than or equal to the
used width of the box and the height of the contents is less than or equal to
the used height of the box.</dd>

<dt>cover</dt>
<dd>Determine the used 'height' and 'width' <a href="/TR/CSS21/visudet.html">as
usual</a>, except if both 'height' and 'width' are 'auto', and the used value
of at least one of 'min-width' and 'min-height' is not '0', then compute the
used width and used height of the element as though the intrinsic dimensions of
the contents were infinitesimally small numbers whose ratio is the actual
intrinsic ratio of the contents.</dd>
<dd>Scale the contents of the element, preserving their aspect ratio, to the
smallest size such that the width of the contents is greater than or equal to
the used width of the box and the height of the contents is greater than or
equal to the height of the box.</dd>
</dl>

<p>The 'overflow' property determines how to render parts of the replaced
element's content that extend beyond the edges of its box. See the <a href="#propdef-image-position">'image-position'</a> property for positioning the
object with respect to the element's box.</p>
<p class="note">
Note: the 'image-fit' property has similar semantics to the fit attribute in
[[SMIL10]].</p>
<div class="figure">

<p><img src="img_scale.png" style="width: 70%; border: thin solid black;" alt="Illustration of the four values"></p>
<p class="caption">
An example showing how each of the four values of 'image-fit' causes the
replaced element (blue figure) to be scaled to fit its height/width box (shown
with a green background), with overflow 'visible' and 'hidden', using the
initial value for 'image-position'.</p>
</div>

<hr>
<table class="propdef">
  <tr>
    <th>Name:
    <td><dfn id="propdef-image-posn">image-position</dfn>
  <tr>
    <th>Value:
    <td>[ [ <a class="noxref" href="/TR/CSS21/syndata.html#value-def-percentage"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | <a class="noxref" href="/TR/CSS21/syndata.html#value-def-length"><span class="value-inst-length">&lt;length&gt;</span></a> | left | center | right ] [
    <a class="noxref" href="/TR/CSS21/syndata.html#value-def-percentage"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | <a class="noxref" href="/TR/CSS21/syndata.html#value-def-length"><span class="value-inst-length">&lt;length&gt;</span></a> | top | center | bottom ]? ] | [
    [ left | center | right ] || [ top | center | bottom ] ]
  <tr>
    <th>Initial:
    <td>50% 50%
  <tr>
    <th>Applies to:
    <td>replaced elements
  <tr>
    <th>Inherited:
    <td>yes
  <tr>
    <th>Percentages:
    <td>refer to width and height of box itself
  <tr>
    <th>Media:
    <td>visual
  <tr>
    <th>Computed value:
    <td>specified value
</table>

<p>The 'image-position' property determines the alignment of the replaced element
inside its box. The values have the same meaning as the values for the
'background-position' property. See
<a href="/TR/CSS21/colors.html#propdef-background-position">background-position</a>
of these values.</p>

<dl>

<dt>&lt;percentage&gt; &lt;percentage&gt;</dt>
<dd>With a value pair of '0% 0%', the upper left corner of the image is aligned
with the upper left corner of the box's padding edge. A value pair of '100%
100%' places the lower right corner of the image in the lower right corner of
padding area. With a value pair of '14% 84%', the point 14% across and 84% down
the image is to be placed at the point 14% across and 84% down the padding
area.</dd>

<dt>&lt;length&gt; &lt;length&gt;</dt>
<dd>With a value pair of '2cm 2cm', the upper left corner of the image is placed
2cm to the right and 2cm below the upper left corner of the padding area.</dd>

<dt>'top left', 'left top'</dt>
<dd>Same as '0% 0%'.</dd>

<dt>'top', 'top center', 'center top'</dt>
<dd>Same as '50% 0%'.</dd>

<dt>'right top', 'top right'</dt>
<dd>Same as '100% 0%'.</dd>

<dt>'left', 'left center', 'center left'</dt>
<dd>Same as '0% 50%'.</dd>

<dt>'center', 'center center'</dt>
<dd>Same as '50% 50%'.</dd>

<dt>'right', 'right center', 'center right'</dt>
<dd>Same as '100% 50%'.</dd>

<dt>'bottom left', 'left bottom'</dt>
<dd>Same as '0% 100%'.</dd>

<dt>'bottom', 'bottom center', 'center bottom'</dt>
<dd>Same as '50% 100%'.</dd>

<dt>'bottom right', 'right bottom'</dt>
<dd>Same as '100% 100%'.</dd>
</dl>

<p>The computed value is the same as the specified value.</p>
<p class="note">
Note: areas of the box not covered by the replaced element will show the
element's background.</p>

<h2 class="no-num" id="properties-list">Appendix A: Full List of Properties</h2>

<h3 class="no-num">Properties that apply within the page context</h3>

<p>The following CSS 2.1 [[!CSS21]] properties <em class="RFC2119">MUST</em> be
supported within an @page rule by conforming implementations:</p>

<table class="property-list">
<tr>
<td rowspan="6"><a href="/TR/CSS21/colors.html#background-properties">background properties</a></td>
<td>background-color</td>
</tr>
<tr>
<td>background-image</td>
</tr>
<tr>
<td>background-repeat</td>
</tr>
<tr>
<td>background-attachment</td>
</tr>
<tr>
<td>background-position</td>
</tr>
<tr>
<td>background</td>
</tr>
<tr>
<td rowspan="20"><a href="/TR/CSS21/box.html#border-properties">border properties</a></td>
<td>border-top-width</td>
</tr>
<tr>
<td>border-right-width</td>
</tr>
<tr>
<td>border-bottom-width</td>
</tr>
<tr>
<td>border-left-width</td>
</tr>
<tr>
<td>border-width</td>
</tr>
<tr>
<td>border-top-color</td>
</tr>
<tr>
<td>border-right-color</td>
</tr>
<tr>
<td>border-bottom-color</td>
</tr>
<tr>
<td>border-left-color</td>
</tr>
<tr>
<td>border-color</td>
</tr>
<tr>
<td>border-top-style</td>
</tr>
<tr>
<td>border-right-style</td>
</tr>
<tr>
<td>border-bottom-style</td>
</tr>
<tr>
<td>border-left-style</td>
</tr>
<tr>
<td>border-short-style</td>
</tr>
<tr>
<td>border-top</td>
</tr>
<tr>
<td>border-right</td>
</tr>
<tr>
<td>border-bottom</td>
</tr>
<tr>
<td>border-left</td>
</tr>
<tr>
<td>border</td>
</tr>
<tr>
<td rowspan="2"><a href="/TR/CSS21/generate.html#counters">counters</a></td>
<td>counter-reset</td>
</tr>
<tr>
<td>counter-increment</td>
</tr>
<tr>
<td colspan="2"><a href="/TR/CSS21/colors.html#propdef-color">color</a></td>
</tr>
<tr>
<td rowspan="6"><a href="/TR/CSS21/fonts.html">font properties</a></td>
<td>font-family</td>
</tr>
<tr>
<td>font-style</td>
</tr>
<tr>
<td>font-variant</td>
</tr>
<tr>
<td>font-weight</td>
</tr>
<tr>
<td>font-size</td>
</tr>
<tr>
<td>font</td>
</tr>
<tr>
<td colspan="2"><a href="/TR/CSS21/visudet.html#line-height">line-height</a></td>
</tr>
<tr>
<td rowspan="5"><a href="/TR/CSS21/box.html#margin-properties">margin properties</a></td>
<td>margin-top</td>
</tr>
<tr>
<td>margin-right</td>
</tr>
<tr>
<td>margin-bottom</td>
</tr>
<tr>
<td>margin-left</td>
</tr>
<tr>
<td>margin</td>
</tr>
<tr>
<td rowspan="5"><a href="/TR/CSS21/box.html#padding-properties">padding properties</a></td>
<td>padding-top</td>
</tr>
<tr>
<td>padding-right</td>
</tr>
<tr>
<td>padding-bottom</td>
</tr>
<tr>
<td>padding-left</td>
</tr>
<tr>
<td>padding</td>
</tr>
<tr>
<td colspan="2"><a href="#page-size">size</a></td>
</tr>
<tr>
<td rowspan="7"><a href="/TR/CSS21/text.html">text properties</a></td>
<td>text-indent</td>
</tr>
<tr>
<td>text-align</td>
</tr>
<tr>
<td>text-decoration</td>
</tr>
<tr>
<td>letter-spacing</td>
</tr>
<tr>
<td>word-spacing</td>
</tr>
<tr>
<td>text-transform</td>
</tr>
<tr>
<td>white-space</td>
</tr>
<tr>
<td colspan="2"><a href="/TR/CSS21/visufx.html#visibility">visibility</a></td>
</tr>
</table>

<h3 class="no-num">Properties that apply within the margin contexts</h3>

<p>The following CSS 2.1 [[!CSS21]] properties <em class="RFC2119">MUST</em> be
supported by conforming implementations within an @margin-box rule:</p>
<table class="property-list">
<tr>
<td rowspan="6"><a href="/TR/CSS21/colors.html#background-properties">background properties</a></td>
<td>background-color</td>
</tr>
<tr>
<td>background-image</td>
</tr>
<tr>
<td>background-repeat</td>
</tr>
<tr>
<td>background-attachment</td>
</tr>
<tr>
<td>background-position</td>
</tr>
<tr>
<td>background</td>
</tr>
<tr>
<td rowspan="20"><a href="/TR/CSS21/box.html#border-properties">border properties</a></td>
<td>border-top-width</td>
</tr>
<tr>
<td>border-right-width</td>
</tr>
<tr>
<td>border-bottom-width</td>
</tr>
<tr>
<td>border-left-width</td>
</tr>
<tr>
<td>border-width</td>
</tr>
<tr>
<td>border-top-color</td>
</tr>
<tr>
<td>border-right-color</td>
</tr>
<tr>
<td>border-bottom-color</td>
</tr>
<tr>
<td>border-left-color</td>
</tr>
<tr>
<td>border-color</td>
</tr>
<tr>
<td>border-top-style</td>
</tr>
<tr>
<td>border-right-style</td>
</tr>
<tr>
<td>border-bottom-style</td>
</tr>
<tr>
<td>border-left-style</td>
</tr>
<tr>
<td>border-short-style</td>
</tr>
<tr>
<td>border-top</td>
</tr>
<tr>
<td>border-right</td>
</tr>
<tr>
<td>border-bottom</td>
</tr>
<tr>
<td>border-left</td>
</tr>
<tr>
<td>border</td>
</tr>

<tr>
<td rowspan="2"><a href="/TR/CSS21/generate.html#counters">counters</a></td>
<td>counter-reset</td>
</tr>
<tr>
<td>counter-increment</td>
</tr>
<tr>
<td colspan="2"><a href="">content</a></td>
</tr>
<tr>
<td colspan="2"><a href="/TR/CSS21/colors.html#propdef-color">color</a></td>
</tr>
<tr>
<td rowspan="6"><a href="/TR/CSS21/fonts.html">font properties</a></td>
<td>font-family</td>
</tr>
<tr>
<td>font-style</td>
</tr>
<tr>
<td>font-variant</td>
</tr>
<tr>
<td>font-weight</td>
</tr>
<tr>
<td>font-size</td>
</tr>
<tr>
<td>font</td>
</tr>
<tr>
<td colspan="2"><a href="/TR/CSS21/visudet.html#the-height-property">height</a></td>
</tr>
<tr>
<td colspan="2"><a href="/TR/CSS21/visudet.html#line-height">line-height</a></td>
</tr>
<tr>
<td rowspan="5"><a href="/TR/CSS21/box.html#margin-properties">margin properties</a></td>
<td>margin-top</td>
</tr>
<tr>
<td>margin-right</td>
</tr>
<tr>
<td>margin-bottom</td>
</tr>
<tr>
<td>margin-left</td>
</tr>
<tr>
<td>margin</td>
</tr>
<tr>
<td rowspan="5"><a href="/TR/CSS21/box.html#padding-properties">padding properties</a></td>
<td>padding-top</td>
</tr>
<tr>
<td>padding-right</td>
</tr>
<tr>
<td>padding-bottom</td>
</tr>
<tr>
<td>padding-left</td>
</tr>
<tr>
<td>padding</td>
</tr>
<tr>
<td rowspan="7"><a href="/TR/CSS21/text.html">text properties</a></td>
<td>text-indent</td>
</tr>
<tr>
<td>text-align</td>
</tr>
<tr>
<td>text-decoration</td>
</tr>
<tr>
<td>letter-spacing</td>
</tr>
<tr>
<td>word-spacing</td>
</tr>
<tr>
<td>text-transform</td>
</tr>
<tr>
<td>white-space</td>
</tr>
<tr>
<td colspan="2"><a href="/TR/CSS21/visufx.html#visibility">visibility</a></td>
</tr>
<tr>
<td colspan="2"><a href="/TR/CSS21/visudet.html#the-width-property">width</a></td>
</tr>
</table>

<h2 class="no-num" id="references">References</h2>

<h3 class="no-num" id="normative-references">Normative References</h3><!--normative-->

<h3 class="no-num" id="informative-references">Informative References</h3><!--informative-->
</div>
</div>
</body>
</html>
