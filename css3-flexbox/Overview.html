<!DOCTYPE html>

<html lang=en>
 <head><meta content="text/html; charset=utf-8" http-equiv=Content-Type>

  <title>CSS Flexible Box Layout Module</title>
  <link href="http://dev.w3.org/csswg/css-module/default.css" rel=stylesheet
  type="text/css">
  <link href="http://www.w3.org/StyleSheets/TR/W3C-ED" rel=stylesheet
  type="text/css">

 <body>
  <div class=head> <!--begin-logo-->
   <p><a href="http://www.w3.org/"><img alt=W3C height=48
    src="http://www.w3.org/Icons/w3c_home" width=72></a> <!--end-logo-->

   <h1 id=head-box-flexible>CSS Flexible Box Layout Module</h1>

   <h2 class="no-num no-toc" id=w3c-working>Editor's Draft, 27 August 2011</h2>

   <dl>
    <dt>This version:

    <dd><!-- <a href="http://www.w3.org/TR/2011/WD-css3-flexbox-20110827/">http://www.w3.org/TR/2011/WD-css3-flexbox-20110827/</a></dd> -->
     <a
     href="http://dev.w3.org/csswg/css3-flexbox/">http://dev.w3.org/csswg/css3-flexbox/</a>
     

    <dt>Latest version:

    <dd><a
     href="http://www.w3.org/TR/css3-flexbox/">http://www.w3.org/TR/css3-flexbox/</a>
     

    <dt>Previous version:

    <dd><a
     href="http://www.w3.org/TR/2009/WD-css3-flexbox-20090723/">http://www.w3.org/TR/2009/WD-css3-flexbox-20090723/</a>
     

    <dt>Editors:

    <dd><a href="http://www.xanthir.com/contact">Tab Atkins Jr.</a>, Google
     Inc.

    <dd>Alex Mogilevsky, Microsoft Corporation, <a
     href="mailto:alexmog@microsoft.com">alexmog@microsoft.com</a>

    <dd>L. David Baron, Mozilla Corporation, <a
     href="mailto:dbaron@dbaron.org">dbaron@dbaron.org</a>

    <dt>Authors and former editors:

    <dd>Neil Deakin, Mozilla Corporation, <a
     href="mailto:enndeakin@gmail.com">enndeakin@gmail.com</a>

    <dd>Ian Hickson, formerly of Opera Software, <a
     href="mailto:ian@hixie.ch">ian@hixie.ch</a>

    <dd>David Hyatt, formerly of Netscape Corporation, <a
     href="mailto:hyatt@apple.com">hyatt@apple.com</a>
   </dl>
   <!--begin-copyright-->
   <p class=copyright><a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright"
    rel=license>Copyright</a> &copy; 2011 <a
    href="http://www.w3.org/"><acronym title="World Wide Web
    Consortium">W3C</acronym></a><sup>&reg;</sup> (<a
    href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute
    of Technology">MIT</acronym></a>, <a href="http://www.ercim.eu/"><acronym
    title="European Research Consortium for Informatics and
    Mathematics">ERCIM</acronym></a>, <a
    href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>
    and <a
    href="http://www.w3.org/Consortium/Legal/copyright-documents">document
    use</a> rules apply.</p>
   <!--end-copyright-->
   <hr title="Separator for header">
  </div>

  <p style="border: thick solid red; background: #fdd; color: red;
   font-weight: bold; padding: .5em; position: fixed; bottom: 0; left: 0;
   right: 0; z-index: 100; margin: 1em;">This draft is in heavy flux right
   now while I perform a major editorial rewrite and fix issues that were
   raised in the past few months. Do not rely on any detail in this draft
   while this notice is present. I expect to finish the rewrite by Sep 2
   2011.

  <h2 class="no-num no-toc" id=abstract> Abstract</h2>

  <p>The specification describes a CSS box model optimized for user interface
   design. In flexbox layout model, the children of a box are laid out either
   horizontally or vertically, and unused space can be assigned to a
   particular child or distributed among the children by assignment of "flex"
   to the children that should expand. Nesting of these boxes (horizontal
   inside vertical, or vertical inside horizontal) can be used to build
   layouts in two dimensions.

  <h2 class="no-num no-toc" id=status>Status of this document</h2>
  <!--begin-status-->

  <p>This is a public copy of the editors' draft. It is provided for
   discussion only and may change at any moment. Its publication here does
   not imply endorsement of its contents by W3C. Don't cite this document
   other than as work in progress.

  <p>The (<a
   href="http://lists.w3.org/Archives/Public/www-style/">archived</a>) public
   mailing list <a
   href="mailto:www-style@w3.org?Subject=%5Bcss3-flexbox%5D%20PUT%20SUBJECT%20HERE">
   www-style@w3.org</a> (see <a
   href="http://www.w3.org/Mail/Request">instructions</a>) is preferred for
   discussion of this specification. When sending e-mail, please put the text
   &#8220;css3-flexbox&#8221; in the subject, preferably like this:
   &#8220;[<!---->css3-flexbox<!---->] <em>&hellip;summary of
   comment&hellip;</em>&#8221;

  <p>This document was produced by the <a href="/Style/CSS/members">CSS
   Working Group</a> (part of the <a href="/Style/">Style Activity</a>).

  <p>This document was produced by a group operating under the <a
   href="/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent
   Policy</a>. W3C maintains a <a href="/2004/01/pp-impl/32061/status"
   rel=disclosure>public list of any patent disclosures</a> made in
   connection with the deliverables of the group; that page also includes
   instructions for disclosing a patent. An individual who has actual
   knowledge of a patent which the individual believes contains <a
   href="/Consortium/Patent-Policy-20040205/#def-essential">Essential
   Claim(s)</a> must disclose the information in accordance with <a
   href="/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the
   W3C Patent Policy</a>.</p>
  <!--end-status-->

  <h2 class="no-num no-toc" id=table>Table of contents</h2>
  <!--begin-toc-->

  <ul class=toc>
   <li><a href="#intro"><span class=secno>1. </span> Introduction</a>

   <li><a href="#box-model"><span class=secno>2. </span> The Flexbox Box
    Model</a>
    <ul class=toc>
     <li><a href="#display-flexbox"><span class=secno>2.1. </span> New values
      for &lsquo;<code class=property>display</code>&rsquo; property</a>

     <li><a href="#flex-items"><span class=secno>2.2. </span> Flexbox
      Items</a>
    </ul>

   <li><a href="#ordering-orientation"><span class=secno>3. </span> Ordering
    and Orientation</a>
    <ul class=toc>
     <li><a href="#flex-flow"><span class=secno>3.1. </span> Flexbox Flow
      Direction: the &lsquo;<code class=property>flex-flow</code>&rsquo;
      property</a>

     <li><a href="#flex-order"><span class=secno>3.2. </span> Display Order:
      the &lsquo;<code class=property>flex-order</code>&rsquo; property</a>
    </ul>

   <li><a href="#flexibility"><span class=secno>4. </span> Flexibility</a>
    <ul class=toc>
     <li><a href="#flex-function"><span class=secno>4.1. </span> The
      &lsquo;<code class=css>flex()</code>&rsquo; function</a>

     <li><a href="#resolving-flexible-lengths"><span class=secno>4.2. </span>
      Resolving Flexible Lengths</a>
    </ul>

   <li><a href="#alignment"><span class=secno>5. </span> Alignment</a>
    <ul class=toc>
     <li><a href="#flex-pack"><span class=secno>5.1. </span> Main Axis
      Alignment: the &lsquo;<code class=property>flex-pack</code>&rsquo;
      property</a>

     <li><a href="#flex-align"><span class=secno>5.2. </span> Cross Axis
      Alignment: the &lsquo;<code class=property>flex-align</code>&rsquo;
      property</a>
    </ul>

   <li><a href="#multiline"><span class=secno>6. </span> Multi-line
    flexbox</a>
    <ul class=toc>
     <li><a href="#flex-line-pack"><span class=secno>6.1. </span>
      &lsquo;<code class=property>flex-line-pack</code>&rsquo; property</a>
    </ul>

   <li><a href="#free-space-algorithm"><span class=secno>7. </span> Free
    Space Calculation and Distribution</a>
    <ul class=toc>
     <li><a href="#free-space-algorithm-initial"><span class=secno>7.1.
      </span> Initial Computation</a>

     <li><a href="#first-distribution-round"><span class=secno>7.2. </span>
      First Distribution Round</a>

     <li><a href="#second-distribution-round"><span class=secno>7.3. </span>
      Second Distribution Round</a>

     <li><a href="#intermediate-computation"><span class=secno>7.4. </span>
      Intermediate Computation</a>

     <li><a href="#third-distribution-round"><span class=secno>7.5. </span>
      Third Distribution Round</a>

     <li><a href="#free-space-allocation-algorithm"><span class=secno>7.6.
      </span> Free Space Allocation Algorithm</a>
    </ul>

   <li><a href="#pagination"><span class=secno>8. </span> Page breaks in
    flexbox</a>

   <li><a href="#layout-interface"><span class=secno>9. </span> Box
    Properties and Sizing</a>

   <li><a href="#changes"><span class=secno>10. </span>Changes</a>
    <ul class=toc>
     <li><a href="#changes-from-ed-16-june-2011"><span class=secno>10.1.
      </span>Changes from ED 16-June-2011</a>
    </ul>

   <li class=no-num><a href="#acknowledgments">Acknowledgments</a>

   <li class=no-num><a href="#references">References</a>
    <ul class=toc>
     <li class=no-num><a href="#normative">Normative references</a>

     <li class=no-num><a href="#informative">Other references</a>
    </ul>

   <li class=no-num><a href="#property">Property index</a>

   <li class=no-num><a href="#index">Index</a>
  </ul>
  <!--end-toc-->

  <h2 id=intro><span class=secno>1. </span> Introduction</h2>

  <p>CSS 2.1 defined four layout modes &mdash; algorithms which determine the
   size and position of boxes based on their relationships with their sibling
   and ancestor boxes: block layout, designed for laying out documents and
   simple applications; inline layout, designed for laying out text; table
   layout, designed for laying out information in a tabular format; and
   positioned layout, designed for very explicit positioning without much
   regard for other elements in the document. This module introduces a new
   layout mode, flexbox layout, which is designed for laying out more complex
   applications and webpages.

  <p>Flexbox layout is superficially similar to block layout. It lacks many
   of the more complex text or document-formatting properties that can be
   used in block layout, such as &lsquo;<code
   class=property>float</code>&rsquo; and &lsquo;<code
   class=property>columns</code>&rsquo;, but in return it gains more simple
   and powerful tools for aligning its contents in ways that webapps and
   complex web pages often need.

  <p>The contents of a flexbox can be laid out in any direction, can have
   their order swapped around dynamically, and can "flex" their sizes and
   positions to respond to the available space. If a flexbox is
   <i>multi-line</i>, the flexbox items flow in two dimensions, wrapping into
   separate lines in a fashion similar to how text is wrapped into multiple
   lines. The direction that these lines are stacked in can also be
   controlled explicitly, relative either to the current writing mode
   (logical directions) or explicit physical directions.

  <h2 id=box-model><span class=secno>2. </span> The Flexbox Box Model</h2>

  <p>An element with &lsquo;<code class=css>display:flexbox</code>&rsquo; or
   &lsquo;<code class=css>display:inline-flexbox</code>&rsquo; is a <dfn
   id=flexbox>flexbox</dfn>. Block-level children of a flexbox, and some
   other types of children, are called <dfn id=flexbox-item title="flexbox
   item|flexbox items|flexbox item's">flexbox items</dfn> and are laid out
   using the flexbox box model. <span class=note>(See the <a
   href="#flex-items">Flexbox Items</a> chapter, below, for specifics on
   which children are <a href="#flexbox-item"><i>flexbox items</i></a>
   directly and which children are instead wrapped in anonymous boxes which
   are then <a href="#flexbox-item"><i>flexbox items</i></a>)</span>

  <p>The flexbox layout algorithm works is agnostic as to the physical
   direction the flexbox happens to be laid out in, so we will define several
   direction-agnostic terms here to make the rest of the spec easier to read
   and understand. The <dfn id=main-axis>main axis</dfn> of a flexbox is the
   axis on which <a href="#flexbox-item"><i>flexbox items</i></a> are laid
   out along. The <a href="#flexbox-item"><i>flexbox items</i></a> are
   ordered such that they start on the <dfn id=main-start>main-start</dfn>
   side of the flexbox, and go toward the <dfn id=main-end>main-end</dfn>
   side. A <a href="#flexbox-item"><i>flexbox item's</i></a> width or height,
   whichever is in the <a href="#main-axis"><i>main axis</i></a>, is the
   item's <dfn id=main-size>main size</dfn>. The <a
   href="#flexbox-item"><i>flexbox item's</i></a> &lsquo;<code
   class=property>width</code>&rsquo; or &lsquo;<code
   class=property>height</code>&rsquo; property, specifically, that is in the
   <a href="#main-axis"><i>main axis</i></a> is the item's <dfn
   id=main-size-property>main size property</dfn>. These terms are mapped to
   physical directions based on the first keyword in the &lsquo;<a
   href="#flex-flow0"><code class=property>flex-flow</code></a>&rsquo;
   property.

  <p>The axis perpendicular to the <a href="#main-axis"><i>main axis</i></a>
   is called the <dfn id=cross-axis>cross axis</dfn>, and similarly has <dfn
   id=cross-start>cross-start</dfn> and <dfn id=cross-end>cross-end</dfn>
   directions and sides defined. The width or height of a <a
   href="#flexbox-item"><i>flexbox item</i></a>, whichever is in the <a
   href="#cross-axis"><i>cross axis</i></a>, is the item's <dfn
   id=cross-size>cross size</dfn>, and similarly the actual &lsquo;<code
   class=property>width</code>&rsquo; or &lsquo;<code
   class=property>height</code>&rsquo; property, whichever is in the <a
   href="#cross-axis"><i>cross axis</i></a>, is the item's <dfn
   id=cross-size-property>cross size property</dfn>. These terms are mapped
   to physical directions based on the orientation of the <a
   href="#main-axis"><i>main axis</i></a> and the second keyword in the
   &lsquo;<a href="#flex-flow0"><code
   class=property>flex-flow</code></a>&rsquo; property.

  <p>The contents of a flexbox can be easily and powerfully manipulated with
   a handful of properties. Most significantly, <a
   href="#flexbox-item"><i>flexbox items</i></a> can "flex" their <a
   href="#main-size"><i>main size</i></a> by using the &lsquo;<code
   class=css>flex()</code>&rsquo; function in the &lsquo;<code
   class=property>width</code>&rsquo; or &lsquo;<code
   class=property>height</code>&rsquo; property. This "flexing" allows the
   items to get bigger or smaller based on the available space in the page.
   If there is leftover space in the flexbox after all of the <a
   href="#flexbox-item"><i>flexbox items</i></a> have finished flexing, the
   items can be aligned, centered, or distributed with the &lsquo;<a
   href="#flex-pack0"><code class=property>flex-pack</code></a>&rsquo;
   property. <a href="#flexbox-item"><i>Flexbox items</i></a> can also be
   completely rearranged within the flexbox with the &lsquo;<a
   href="#flex-order0"><code class=property>flex-order</code></a>&rsquo;
   property.

  <p>In the <a href="#cross-axis"><i>cross axis</i></a>, <a
   href="#flexbox-item"><i>flexbox items</i></a> can either "flex" to fill
   the available space or be aligned within the space with the &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
   property. If a flexbox is <i>multi-line</i>, new lines are added in the <a
   href="#cross-end"><i>cross-end</i></a> direction, and can similarly be
   aligned, centered, or distributed within the flexbox with the &lsquo;<a
   href="#propdef-flex-line-pack"><code
   class=property>flex-line-pack</code></a>&rsquo; property.

  <p>Similar to other layout modes such as table layout, a flexbox acts like
   a block when placed into elements using other layout modes. Inline
   flexboxes act like inline-blocks.

  <div class=example>
   <p>For example, the following HTML snippet declares a flexbox with a few
    children. The flexbox is horizontal, and the children's widths don't fill
    the flexbox's width, so the additional space is distributed between the
    children. The flexbox's height isn't explicitly specified, so it shrinks
    to the height of its tallest child and centers the other children within
    it:</p>

   <pre>
&lt;p style="width: 500px; padding: 5px; display: flexbox; flex-pack: distribute; flex-align: middle;">
	&lt;button style="width: 200px;">Child 1&lt;br>Another Line&lt;/button>
	&lt;button style="width: 100px;">Child 2&lt;/button>
	&lt;button style="width: 100px;">Child 3&lt;/button>
&lt;/p></pre>

   <p>This will render approximately like the following:</p>

   <p style="border: thin solid black; background: white; width: 500px;
    padding: 5px; overflow: hidden;">
    <button style="float: left; width: 200px; height: 40px; margin-right:
     50px;">Child 1<br>
     Another Line</button>

    <button style="float: left; width: 100px; height: 22px; margin-top:
     9px;">Child 2</button>

    <button style="float: right; width: 100px; height: 22px; margin-top:
     9px;">Child 3</button>
   </p>
  </div>

  <h3 id=display-flexbox><span class=secno>2.1. </span> New values for
   &lsquo;<code class=property>display</code>&rsquo; property</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td>display

    <tr>
     <th>New value:

     <td>flexbox | inline-flexbox
  </table>

  <p>You can declare that an element is a flexbox, and thus should use
   flexbox layout for its contents, by setting the &lsquo;<code
   class=property>display</code>&rsquo; property on the element to the value
   &lsquo;<a href="#flexbox"><code class=property>flexbox</code></a>&rsquo;
   or &lsquo;<code class=property>inline-flexbox</code>&rsquo;.

  <p>The &lsquo;<a href="#flexbox"><code class=css>flexbox</code></a>&rsquo;
   value makes the flexbox act like a block in other layout modes. The
   &lsquo;<code class=css>inline-flexbox</code>&rsquo; value makes the
   flexbox act like an inline-block in other layout modes.

  <p>Setting &lsquo;<code class=css>display:flexbox</code>&rsquo; on an
   element forces it to use a new layout algorithm, and so some properties
   that were designed with the assumption of block layout don't make sense in
   a flexbox context. In particular:

  <ul>
   <li>all of the &lsquo;<code class=css>column-*</code>&rsquo; properties in
    the Multicol module compute to their initial values on a flexbox
    (&lsquo;<code class=property>break-before</code>&rsquo;, &lsquo;<code
    class=property>break-inside</code>&rsquo;, and &lsquo;<code
    class=property>break-after</code>&rsquo; are still valid on a flexbox).

   <li>&lsquo;<code class=property>float</code>&rsquo; and &lsquo;<code
    class=property>clear</code>&rsquo; compute to their initial values on a
    flexbox item

   <li>&lsquo;<code class=property>vertical-align</code>&rsquo; has no effect
    on a flexbox item
  </ul>

  <p>A flexbox item creates a new flexbox formatting context for its
   contents. This is similar to a block formatting context: floats must not
   intrude into the flexbox, and the flexbox's margins do not collapse with
   any other margin. Additionally, all of the <a
   href="#flexbox-item"><i>flexbox items</i></a> establish new block
   formatting contexts for their contents.

  <p class=issue>Figure out the right terms to use here.

  <h3 id=flex-items><span class=secno>2.2. </span> Flexbox Items</h3>

  <p>Flexbox layout algorithm operates on <a href="#flexbox-item"><i>flexbox
   items</i></a>, which are boxes that satisfy at least one of the following
   criteria:

  <ol>
   <li>Immediate block-level children of flexbox

   <li>Atomic inline-level children of flexbox

   <li>Contiguous run of non-replaced inline children, wrapped into an
    anonymous block
  </ol>

  <div class=example>
   <p>Examples of flexbox items:</p>

   <pre>
&lt;div style="display:flexbox">

    &lt;!-- flexbox item: block-level child -->
    &lt;div id="item1">block&lt;/div>

    &lt;!-- not a flexbox item, because it's out-of-flow -->
    &lt;div id="not-an-item1.5" style="position: absolute;">block&lt;/div>
    
    &lt;!-- flexbox item: block-level child -->
    &lt;div id="item2" style="display:table">table&lt;/div>
    
    &lt;!-- flexbox item: anonymous table wrapped around table-cell -->
    &lt;div id="item3" style="display:table-cell">table-cell&lt;/div> 

    &lt;!-- flexbox item: anonymous block around inline content -->
    anonymous item 4

    &lt;!-- flexbox item: block-level child -->
    &lt;div id="item5">block&lt;/div>

    &lt;!-- flexbox item: anonymous block around inline content -->
    anonymous item 6.1
    &lt;span id="item6.1">
        text 6.2
        &lt;div id="not-an-item6.3">block&lt;/div>
        text 6.4
    &lt;/span>

    &lt;!-- flexbox item: block-level replaced element -->
    &lt;iframe id="item7">

    &lt;!-- flexbox item: inline-level replaced element -->
    &lt;img id="item7" style="display:inline">

    &lt;!-- flexbox item: inline-level replaced element -->
    &lt;button id="item8">button&lt;/button>

    &lt;!-- flexbox item: inline-table -->
    &lt;div id="item9" style="display:inline-table">table&lt;/div>
&lt;/div></pre>

   <p>Notice that block element "not-an-item6.3" is not a separate flexbox
    item, because it is contained inside an inline element which is being
    wrapped into an anonymous flex item. Similarly, the block element
    "not-an-item1.5" is not a flexbox item, because it's absolutely
    positioned and thus out of flow.</p>
  </div>

  <p>Absolutely positioned children of a flexbox are not <a
   href="#flexbox-item"><i>flexbox items</i></a>, but their "static position"
   (their position when the &lsquo;<code
   class=property>top</code>&rsquo;/&lsquo;<code
   class=property>right</code>&rsquo;/&lsquo;<code
   class=property>bottom</code>&rsquo;/&lsquo;<code
   class=property>left</code>&rsquo; properties are &lsquo;<code
   class=css>auto</code>&rsquo;) responds somewhat to the flexbox's various
   properties. The element's static position in the flexbox's <a
   href="#cross-axis"><i>cross axis</i></a> is on the <a
   href="#cross-start"><i>cross-start</i></a> edge of the flexbox's content
   box. The static position in the flexbox's <a href="#main-axis"><i>main
   axis</i></a> is slightly more complex to compute:

  <p>First, find the element's <dfn id=hypothetical-neighbors>hypothetical
   neighbors</dfn> by assuming that the element is a normal <a
   href="#flexbox-item"><i>flexbox item</i></a> with &lsquo;<code
   class=css>flex-order:1</code>&rsquo;, and reorder the flexbox's contents
   as mandated by &lsquo;<a href="#flex-order0"><code
   class=property>flex-order</code></a>&rsquo;. The <a
   href="#flexbox-item"><i>flexbox items</i></a> immediately preceding and
   following (in the flexbox's direction) the element (if any) are the
   element's <a href="#hypothetical-neighbors"><i>hypothetical
   neighbors</i></a>.

  <p>If the element has two neighbors, its static position in the <a
   href="#main-axis"><i>main axis</i></a> is exactly in the center of the
   packing space between them when the flexbox is actually laid out. If the
   element has only a preceding neighbor, its static position in the <a
   href="#main-axis"><i>main axis</i></a> is flush with the <a
   href="#main-end"><i>main-end</i></a> edge of the margin box of the
   neighbor. If the element has only a following neighbor, its static
   position in the <a href="#main-axis"><i>main axis</i></a> is flush with
   the <a href="#main-start"><i>main-start</i></a> edge of the margin box of
   the neighbor. Finally, if the element has no neighbors (the flexbox has no
   in-flow children at all), the static position in the <a
   href="#main-axis"><i>main axis</i></a> is based on the value of &lsquo;<a
   href="#flex-pack0"><code class=property>flex-pack</code></a>&rsquo;: if
   the value is &lsquo;<a href="#flex-pack-start"><code
   class=css>start</code></a>&rsquo; or &lsquo;<a
   href="#flex-line-pack-distribute"><code
   class=css>distribute</code></a>&rsquo;, it's flush with the <a
   href="#main-start"><i>main-start</i></a> edge of the flexbox's content
   box; if the value is &lsquo;<a href="#flex-pack-end"><code
   class=css>end</code></a>&rsquo;, it's flush with the <a
   href="#main-end"><i>main-end</i></a> edge of the flexbox's content box; if
   the value is &lsquo;<a href="#flex-pack-center"><code
   class=css>center</code></a>&rsquo;, it's centered within the flexbox's
   content box.

  <h2 id=ordering-orientation><span class=secno>3. </span> Ordering and
   Orientation</h2>

  <p>The first level of flexbox functionality is the ability to lay out a
   flexbox's contents in any direction and in any order. This allows an
   author to trivially achieve effects that would previously have required
   complex or fragile methods, such as using the &lsquo;<code
   class=property>float</code>&rsquo; property to lay out a horizontal
   navigation bar (which then requires further effort with the &lsquo;<code
   class=property>clear</code>&rsquo; property or others to make the elements
   interact nicely with the rest of the page). This functionality is exposed
   through the &lsquo;<a href="#flex-flow0"><code
   class=property>flex-flow</code></a>&rsquo; and &lsquo;<a
   href="#flex-order0"><code class=property>flex-order</code></a>&rsquo;
   properties.

  <h3 id=flex-flow><span class=secno>3.1. </span> Flexbox Flow Direction: the
   &lsquo;<a href="#flex-flow0"><code
   class=property>flex-flow</code></a>&rsquo; property</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=flex-flow0>flex-flow</dfn>

    <tr>
     <th>Values:

     <td>
      <pre>  [ row | row-reverse | column | column-reverse ]
  [ wrap | wrap-reverse ]?
|
  [ horizontal | horizontal-reverse | horizontal-ltr | horizontal-rtl ] 
  [ wrap | wrap-reverse | wrap-down | wrap-up ]?
|
  [ vertical | vertical-reverse | vertical-ttb | vertical-btt ] 
  [ wrap | wrap-reverse | wrap-left | wrap-right ]?</pre>

    <tr>
     <th>Initial:

     <td>row

    <tr>
     <th>Applies To:

     <td>flexboxes

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Computed Value:

     <td>specified value

    <tr>
     <th>Media:

     <td>visual
  </table>

  <p>The &lsquo;<code class=property>flexbox-flow</code>&rsquo; property
   specifies how <a href="#flexbox-item"><i>flexbox items</i></a> are placed
   in the flexbox. The value consists of one or two keywords: the first sets
   the orientation and direction of the flexbox's <a
   href="#main-axis"><i>main axis</i></a>, while the second, if specified,
   marks the flexbox as being multiline and sets the direction in which new
   lines are stacked.

  <p>The main directions affect how <a href="#flexbox-item"><i>flexbox
   items</i></a> are arranged, and how they respond to the &lsquo;<a
   href="#flex-pack0"><code class=property>flex-pack</code></a>&rsquo;
   property. They can be set with either logical directions (relative to the
   writing mode) or physical directions:

  <dl>
   <dt>Logical Directions

   <dd>
    <dl>
     <dt><dfn id=flex-flow-row>row</dfn>

     <dd>The flexbox's <a href="#main-axis"><i>main axis</i></a> has the same
      orientation as the inline axis of the current writing mode (the
      direction that text is laid out in). The <a
      href="#main-start"><i>main-start</i></a> and <a
      href="#main-end"><i>main-end</i></a> directions are equivalent to the
      "start" and "end" directions, respectively, of the current writing
      mode.

     <dt><dfn id=flex-flow-row-reverse>row-reverse</dfn>

     <dd>Same as <a href="#flex-flow-row"><i>row</i></a>, except the <a
      href="#main-start"><i>main-start</i></a> and <a
      href="#main-end"><i>main-end</i></a> directions are swapped.

     <dt><dfn id=flex-flow-column>column</dfn>

     <dd>The flexbox's <a href="#main-axis"><i>main axis</i></a> has the same
      orientation as the block axis of the current writing mode (the
      direction that blocks are laid out in). The <a
      href="#main-start"><i>main-start</i></a> and <a
      href="#main-end"><i>main-end</i></a> directions are equivalent to the
      "before" and "after" directions, respectively, of the current writing
      mode.

     <dt><dfn id=flex-flow-column-reverse>column-reverse</dfn>

     <dd>Same as <a href="#flex-flow-column"><i>column</i></a>, except the <a
      href="#main-start"><i>main-start</i></a> and <a
      href="#main-end"><i>main-end</i></a> directions are swapped.
    </dl>

   <dt>Physical Directions

   <dd>
    <dl>
     <dt><dfn id=flex-flow-horizontal>horizontal</dfn>

     <dd>The flexbox's <a href="#main-axis"><i>main axis</i></a> is
      horizontal. The <a href="#main-start"><i>main-start</i></a> direction
      is equivalent to either the "start" or "before" direction of the
      current writing mode, whichever is vertical, and the <a
      href="#main-end"><i>main-end</i></a> direction is the opposite
      direction of <a href="#main-start"><i>main-start</i></a>.

     <dt><dfn id=flex-flow-horizontal-reverse>horizontal-reverse</dfn>

     <dd>Same as <a href="#flex-flow-horizontal"><i>horizontal</i></a>,
      except the <a href="#main-start"><i>main-start</i></a> and <a
      href="#main-end"><i>main-end</i></a> directions are swapped.

     <dt><dfn id=flex-flow-horizontal-ltr>horizontal-ltr</dfn>

     <dd>Same as <a href="#flex-flow-horizontal"><i>horizontal</i></a>,
      except the <a href="#main-start"><i>main-start</i></a> direction is to
      the left and the <a href="#main-end"><i>main-end</i></a> direction is
      to the right.

     <dt><dfn id=flex-flow-horizontal-rtl>horizontal-rtl</dfn>

     <dd>Same as <a href="#flex-flow-horizontal"><i>horizontal</i></a>,
      except the <a href="#main-start"><i>main-start</i></a> direction is to
      the right and the <a href="#main-end"><i>main-end</i></a> direction is
      to the left.

     <dt><dfn id=flex-flow-vertical>vertical</dfn>

     <dd>The flexbox's <a href="#main-axis"><i>main axis</i></a> is vertical.
      The <a href="#main-start"><i>main-start</i></a> direction is equivalent
      to either the "start" or "before" direction of the current writing
      mode, whichever is horizontal, and the <a
      href="#main-end"><i>main-end</i></a> direction is the opposite
      direction of <a href="#main-start"><i>main-start</i></a>.

     <dt><dfn id=flex-flow-vertical-reverse>vertical-reverse</dfn>

     <dd>Same as <a href="#flex-flow-vertical"><i>vertical</i></a>, except
      the <a href="#main-start"><i>main-start</i></a> and <a
      href="#main-end"><i>main-end</i></a> directions are swapped.

     <dt><dfn id=flex-flow-vertical-ttb>vertical-ttb</dfn>

     <dd>Same as <a href="#flex-flow-vertical"><i>vertical</i></a>, except
      the <a href="#main-start"><i>main-start</i></a> direction is upwards
      and the <a href="#main-end"><i>main-end</i></a> direction is downwards.

     <dt><dfn id=flex-flow-row-vertical-btt>vertical-btt</dfn>

     <dd>Same as <a href="#flex-flow-vertical"><i>vertical</i></a>, except
      the <a href="#main-start"><i>main-start</i></a> direction is downwards
      and the <a href="#main-end"><i>main-end</i></a> direction is upwards.
    </dl>
  </dl>

  <p class=note>Usually, the logical keywords are sufficient, which is why
   their names are purposely short. For example, if the page's writing mode
   is lr-tb, like it is when the primary language is English, the &lsquo;<a
   href="#flex-flow-row"><code class=css>row</code></a>&rsquo; value makes
   the flexbox horizontal and going from left to right, while the &lsquo;<a
   href="#flex-flow-column"><code class=css>column</code></a>&rsquo; value
   makes the flexbox vertical and going from top to bottom. If this were
   specified as part of a page template, and the page as a whole was switched
   to a tb-rl writing-mode like what Japanese uses, the flexboxes would
   automatically shift to vertical and horizontal, respectively, which is
   often what is desired.

  <p>The <a href="#cross-axis"><i>cross axis</i></a> is always perpendicular
   to the <a href="#main-axis"><i>main axis</i></a>. The second keyword, or
   the lack of it, sets the cross directions (<a
   href="#cross-start"><i>cross-start</i></a> and <a
   href="#cross-end"><i>cross-end</i></a>), and dictates whether the flexbox
   is single-line or multi-line. The cross directions affect how individual
   <a href="#flexbox-item"><i>flexbox items</i></a> respond to the &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
   property, and the direction in which multiple lines are stacked and
   aligned by the &lsquo;<a href="#propdef-flex-line-pack"><code
   class=property>flex-line-pack</code></a>&rsquo; property.

  <p>If the second keyword is omitted, the flexbox is single-line, the <a
   href="#cross-start"><i>cross-start</i></a> direction is equivalent to
   either the "start" or "before" direction of the current writing mode,
   whichever is in the <i>cross-axis</i>, and the <a
   href="#cross-end"><i>cross-end</i></a> direction is the opposite direction
   of <a href="#cross-start"><i>cross-start</i></a>.

  <p>If the second keyword is provided, the flexbox is <a
   href="#multiline">multi-line</a>. The <a
   href="#cross-start"><i>cross-start</i></a> and <a
   href="#cross-end"><i>cross-end</i></a> directions are set as follows:

  <dl>
   <dt><dfn id=flex-flow-wrap>wrap</dfn>

   <dd>The <a href="#cross-start"><i>cross-start</i></a> direction is
    equivalent to either the "start" or "before" direction of the current
    writing mode, whichever is in the <i>cross-axis</i>, and the <a
    href="#cross-end"><i>cross-end</i></a> direction is the opposite
    direction of <a href="#cross-start"><i>cross-start</i></a>.

   <dt><dfn id=flex-flow-wrap-reverse>wrap-reverse</dfn>

   <dd>Same as <a href="#flex-flow-wrap"><i>wrap</i></a>, except the <a
    href="#cross-start"><i>cross-start</i></a> and <a
    href="#cross-end"><i>cross-end</i></a> directions are swapped.

   <dt><dfn id=flex-flow-wrap-up>wrap-up</dfn>

   <dd>The <a href="#cross-start"><i>cross-start</i></a> direction is
    downwards and the <a href="#cross-end"><i>cross-end</i></a> direction is
    upwards.

   <dt><dfn id=flex-flow-wrap-right>wrap-right</dfn>

   <dd>The <a href="#cross-start"><i>cross-start</i></a> direction is to the
    left and the <a href="#cross-end"><i>cross-end</i></a> direction is to
    the right.

   <dt><dfn id=flex-flow-wrap-down>wrap-down</dfn>

   <dd>The <a href="#cross-start"><i>cross-start</i></a> direction is upwards
    and the <a href="#cross-end"><i>cross-end</i></a> direction is downwards.

   <dt><dfn id=flex-flow-wrap-left>wrap-left</dfn>

   <dd>The <a href="#cross-start"><i>cross-start</i></a> direction is to the
    right and the <a href="#cross-end"><i>cross-end</i></a> direction is to
    the left.
  </dl>

  <p class=note>Note that not all combinations of first and second keyword
   are allowed by the property's syntax, as they don't all make sense. For
   example, &lsquo;<code class=css>flex-flow: horizontal
   wrap-right</code>&rsquo; is an invalid declaration.

  <div class=example>
   <p>Some examples of valid flows:</p>

   <pre>
div { flex-flow:row }                      /* initial value. Main axis is inline,
                                              no wrap. */
div { flex-flow:horizontal-ltr wrap-down } /* main axis is horizontal, flow left-to-right, 
                                              wrap down */
div { writing-mode:tb-rl;                  /* main axis is vertical top-to-bottom (as line direction),
      flex-flow:vertical wrap-reverse }    /* cross axis is left-to-right (opposite to block direction) */</pre>
  </div>

  <h3 id=flex-order><span class=secno>3.2. </span> Display Order: the
   &lsquo;<a href="#flex-order0"><code
   class=property>flex-order</code></a>&rsquo; property</h3>

  <p><a href="#flexbox-item"><i>Flexbox items</i></a> are, by default,
   displayed and laid out in the same order as they appear in the source
   document. The &lsquo;<a href="#flex-order0"><code
   class=property>flex-order</code></a>&rsquo; property may be used to change
   this ordering.

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=flex-order0>flex-order</dfn>

    <tr>
     <th>Value:

     <td>&lt;integer>

    <tr>
     <th>Initial:

     <td>1

    <tr>
     <th>Applies to:

     <td><a href="#flexbox-item"><i>flexbox items</i></a>

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Computed value:

     <td>specified value

    <tr>
     <th>Media:

     <td>visual
  </table>

  <p>The &lsquo;<a href="#flex-order0"><code
   class=property>flex-order</code></a>&rsquo; property assigns <a
   href="#flexbox-item"><i>flexbox items</i></a> to ordinal groups.

  <p>Ordinal groups control the order in which <a
   href="#flexbox-item"><i>flexbox items</i></a> appear. A flexbox will lay
   out its content starting from the lowest numbered ordinal group and going
   up. Items with the same ordinal group are laid out in the order they
   appear in the source document.

  <div class=example>
   <p>This example shows how ordinal groups might be used.</p>

   <pre><code>	div { display: flexbox; }
#item1 { flex-order: 2; }
#item3 { flex-order: 2; }
#item4 { flex-order: 1; }

&lt;div>
	&lt;div id="item1">item1&lt;/div>
	&lt;div id="item2">item2&lt;/div>
	&lt;div id="item3">item3&lt;/div>
	&lt;div id="item4">item4&lt;/div>
&lt;/div></code></pre>

   <p>The first ordinal group, 1, contains item2 and item4. As item2 does not
    specify an ordinal group, it will default to 1. The elements will be
    displayed in document order, so item2 will be displayed before item4. The
    second ordinal group, 2, contains the remaining two items. The resulting
    display order will be:</p>

   <pre><code>item2 item4 item1 item3</code></pre>
  </div>

  <p class=issue>Add a realistic example of tab reordering.

  <p class=issue>Add an example of reordering columns in a page.

  <h2 id=flexibility><span class=secno>4. </span> Flexibility</h2>

  <p>The defining aspect of flexbox layout is the ability to make the <a
   href="#flexbox-item"><i>flexbox items</i></a> "flex", altering their width
   or height to fill the available space. This is done by declaring a <dfn
   id=flexible-length>flexible length</dfn> with the &lsquo;<code
   class=css>flex()</code>&rsquo; function, defined below.

  <p>Flexible lengths are composed of a (non-flexible) preferred size and a
   positive and negative flexibility. If there's free space left over in the
   flexbox after subtracting the preferred sizes of all the <a
   href="#flexbox-item"><i>flexbox items</i></a>, it is divided up among the
   <a href="#flexbox-item"><i>flexbox items</i></a> proportionally to their
   positive flexibility, making their width larger so they fill the space.
   Conversely, if the flexbox's size is <em>less</em> than the sum of the
   preferred sizes, so that the items would overflow normally, the <a
   href="#flexbox-item"><i>flexbox items</i></a> are shrunk proportionally to
   their negative flexibility, again so they exactly fit in the space.

  <div class=example>
   <p class=issue>TODO: Examples!</p>
  </div>

  <h3 id=flex-function><span class=secno>4.1. </span> The &lsquo;<code
   class=css>flex()</code>&rsquo; function</h3>

  <p>The &lsquo;<code class=css>flex()</code>&rsquo; function is used to
   specify the parameters of a <dfn id=flexible-length0 title="flexible
   length|flexible lengths|flexible length's">flexible length</dfn>: the <dfn
   id=positive-flexibility title="positive flexibility">positive</dfn> and
   <dfn id=negative-flexibility>negative flexibility</dfn>, and the <dfn
   id=preferred-size>preferred size</dfn>. The syntax of the &lsquo;<code
   class=css>flex()</code>&rsquo; function is:

  <pre
   class=prod>flex( [ &lt;pos-flex> &lt;neg-flex>? ]? || &lt;preferred-size>? )</pre>

  <p><code>&lt;pos-flex></code> and <code>&lt;neg-flex></code> are
   non-negative <code>&lt;numbers>s</code>, while
   <code>&lt;preferred-size></code> is any value (other than another
   &lsquo;<code class=css>flex()</code>&rsquo; function) that would be valid
   in the &lsquo;<code class=property>width</code>&rsquo; or &lsquo;<code
   class=property>height</code>&rsquo; property in which the function is
   used, except that zero lengths must not omit their unit.

  <p>The <code>&lt;pos-flex></code> component sets the length's <a
   href="#positive-flexibility"><i>positive flexibility</i></a>; if omitted,
   the <a href="#positive-flexibility"><i>positive flexibility</i></a>
   defaults to &lsquo;<code class=css>1</code>&rsquo;. The
   <code>&lt;neg-flex></code> component sets the length's <a
   href="#negative-flexibility"><i>negative flexibility</i></a>; if omitted,
   it defaults to &lsquo;<code class=css>0</code>&rsquo;. The
   <code>&lt;preferred-size></code> component sets the length's <a
   href="#preferred-size"><i>preferred size</i></a>; if omitted, it defaults
   to &lsquo;<code class=css>0px</code>&rsquo;.

  <p class=issue>Examples!

  <h3 id=resolving-flexible-lengths><span class=secno>4.2. </span> Resolving
   Flexible Lengths</h3>

  <p><a href="#flexible-length0"><i>Flexible lengths</i></a> are resolved
   into normal, inflexible lengths by figuring out how large all of the <a
   href="#flexible-length0"><i>flexible lengths</i></a> in the flexbox
   <em>want</em> to be, then either adding or subtracting space from that
   preferred size. The following algorithm normatively describes how to do
   this conversion:

  <p>First, determine the width and height of the flexbox itself, as
   described by the <a href="#layout-interface">Box Properties</a> chapter.
   The <a href="#main-size"><i>main size</i></a> of the flexbox's content box
   is the <i>available space</i>.

  <p>Second, if the flexbox is <i>multi-line</i>, break the contents across
   multiple lines, as described by the <a href=multiline>Multiline</a>
   chapter.

  <p>Then, for each line in the flexbox, do the following:

  <ol>
   <li>Subtract the sum of the <i>pre-flex sizes</i> of the <a
    href="#flexbox-item"><i>flexbox items</i></a> on the line from the
    <i>available space</i>. This is the <dfn id=free-space>free space</dfn>.
    This number may be negative, if the flexbox is single-line or a single <a
    href="#flexbox-item"><i>flexbox item</i></a> is larger than the entire
    flexbox.

   <li>
    <dl>
     <dt>If the <a href="#free-space"><i>free space</i></a> is zero:

     <dd>All <a href="#flexible-length0"><i>flexible lengths</i></a> resolve
      to their <a href="#preferred-size"><i>preferred size</i></a>.

     <dt>If the <a href="#free-space"><i>free space</i></a> is positive:

     <dd>
      <p>Sum the <a href="#positive-flexibility"><i>positive
       flexibility</i></a> of every <a href="#flexible-length0"><i>flexible
       length</i></a> on the line. This is the <dfn
       id=total-positive-flexibility>total positive flexibility</dfn>.</p>

      <p>For each <a href="#flexible-length0"><i>flexible length</i></a>,
       increment its <a href="#preferred-size"><i>preferred size</i></a> by
       <code><a href="#free-space"><i>free space</i></a> * &lt;pos-flex> / <a
       href="#total-positive-flexibility"><i>total positive
       flexibility</i></a></code>.</p>

     <dt>If the <a href="#free-space"><i>free space</i></a> is negative:

     <dd>
      <p>Sum the <a href="#negative-flexibility"><i>negative
       flexibility</i></a> of every <a href="#flexible-length0"><i>flexible
       length</i></a> on the line. This is the <dfn
       id=total-negative-flexibility>total negative flexibility</dfn>.</p>

      <p>For each <a href="#flexible-length0"><i>flexible length</i></a>,
       increment its <a href="#preferred-size"><i>preferred size</i></a> by
       <code><a href="#free-space"><i>free space</i></a> * &lt;neg-flex> / <a
       href="#total-negative-flexibility"><i>total negative
       flexibility</i></a></code>. <span class=note>Note: since the free
       space is negative, incrementing the preferred size by this number
       makes the preferred size smaller.</span></p>
    </dl>

   <li>
    <p>Verify that min/max constraints aren't violated: for each <a
     href="#flexbox-item"><i>flexbox item</i></a> on the line with
     &lsquo;<code class=property>width</code>&rsquo;/&lsquo;<code
     class=property>height</code>&rsquo; specified as a <a
     href="#flexible-length0"><i>flexible length</i></a>, if instead
     specifying the &lsquo;<code
     class=property>width</code>&rsquo;/&lsquo;<code
     class=property>height</code>&rsquo; as the <a
     href="#preferred-size"><i>preferred size</i></a> would cause the item to
     be in violation of its &lsquo;<code
     class=css>min/max-width/height</code>&rsquo; properties, resolve the <a
     href="#flexible-length0"><i>flexible length</i></a> to the
     smallest/largest length that would make it no longer in violation of
     those properties, as defined by <a
     href="http://www.w3.org/TR/CSS2/visudet.html#propdef-min-width">the
     algorithm in CSS2.1</a>.</p>

    <p>If any <a href="#flexbox-item"><i>flexbox item</i></a> was found to be
     in violation by this step and resolved into an inflexible length, reset
     the <a href="#preferred-size"><i>preferred size</i></a> of any remaining
     <a href="#flexible-length0"><i>flexible lengths</i></a> to their
     original values and restart this sub-algorithm.</p>

   <li>Any remaining <a href="#flexible-length0"><i>flexible lengths</i></a>
    resolve to their <a href="#preferred-size"><i>preferred size</i></a>.
  </ol>

  <p>Once all <a href="#flexible-length0"><i>flexible lengths</i></a> have
   been resolved, the &lsquo;<a href="#flex-pack0"><code
   class=property>flex-pack</code></a>&rsquo;, &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;, and
   &lsquo;<a href="#propdef-flex-line-pack"><code
   class=property>flex-line-pack</code></a>&rsquo; properties align the <a
   href="#flexbox-item"><i>flexbox items</i></a> and the flexbox's lines
   within the flexbox.

  <h2 id=alignment><span class=secno>5. </span> Alignment</h2>

  <p>After a flexbox's contents have finished their flexing, they can be
   aligned in both the <a href="#main-axis"><i>main axis</i></a> with
   &lsquo;<a href="#flex-pack0"><code
   class=property>flex-pack</code></a>&rsquo; and the <a
   href="#cross-axis"><i>cross axis</i></a> with &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;.
   These properties make many common types of alignment trivial, including
   some things that were very difficult in CSS 2.1, like horizontal and
   vertical centering.

  <h3 id=flex-pack><span class=secno>5.1. </span> Main Axis Alignment: the
   &lsquo;<a href="#flex-pack0"><code
   class=property>flex-pack</code></a>&rsquo; property</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=flex-pack0>flex-pack</dfn>

    <tr>
     <th>Value:

     <td>start | end | center | distribute

    <tr>
     <th>Initial:

     <td>start

    <tr>
     <th>Applies to:

     <td>flexboxes

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Computed Value:

     <td>specified value

    <tr>
     <th>Media:

     <td>visual
  </table>

  <p>The &lsquo;<a href="#flex-pack0"><code
   class=property>flex-pack</code></a>&rsquo; property aligns <a
   href="#flexbox-item"><i>flexbox items</i></a> in the <a
   href="#main-axis"><i>main axis</i></a> of the current line of the flexbox.
   This is done <a href="#flex-line-pack-after"><em>after</em></a> any
   flexible lengths have been resolved. Typically it helps distribute extra
   free space leftover when either all the <a href="#flexbox-item"><i>flexbox
   items</i></a> on a line are inflexible, or are flexible but have reach
   their maximum size, but it also exerts some control over the alignment of
   items when they overflow the line.

  <dl>
   <dt><dfn id=flex-pack-start>start</dfn>

   <dd><a href="#flexbox-item"><i>Flexbox items</i></a> are packed toward the
    start of the line. The <a href="#main-start"><i>main-start</i></a> margin
    edge of the first <a href="#flexbox-item"><i>flexbox item</i></a> on the
    line is placed flush with the <a href="#main-start"><i>main-start</i></a>
    edge of the line, and each subsequent <a href="#flexbox-item"><i>flexbox
    item</i></a> is placed flush with the preceding item.

   <dt><dfn id=flex-pack-end>end</dfn>

   <dd><a href="#flexbox-item"><i>Flexbox items</i></a> are packed toward the
    end of the line. The <a href="#main-end"><i>main-end</i></a> margin edge
    of the last <a href="#flexbox-item"><i>flexbox item</i></a> is placed
    flush with the <a href="#main-end"><i>main-end</i></a> edge of the line,
    and each preceding <a href="#flexbox-item"><i>flexbox item</i></a> is
    placed flush with the subsequent item.

   <dt><dfn id=flex-pack-center>center</dfn>

   <dd><a href="#flexbox-item"><i>Flexbox items</i></a> are packed toward the
    center of the line. If the leftover free-space is negative, this value is
    identical to &lsquo;<a href="#flex-pack-start"><code
    class=css>start</code></a>&rsquo;. Otherwise, the <a
    href="#flexbox-item"><i>flexbox items</i></a> on the line are placed
    flush with each other and aligned in the center of the line, with equal
    amounts of empty space between the <a
    href="#main-start"><i>main-start</i></a> edge of the line and the first
    item on the line and between the <a href="#main-end"><i>main-end</i></a>
    edge of the line and the last item on the line.

   <dt><dfn id=flex-pack-distribute>distribute</dfn>

   <dd><a href="#flexbox-item"><i>Flexbox items</i></a> are evenly
    distributed in the line. If the leftover free-space is negative or there
    is only a single <a href="#flexbox-item"><i>flexbox item</i></a> on the
    line, this value is identical to &lsquo;<a href="#flex-pack-start"><code
    class=css>start</code></a>&rsquo;. Otherwise, the <a
    href="#main-start"><i>main-start</i></a> margin edge of the first <a
    href="#flexbox-item"><i>flexbox item</i></a> on the line is placed flush
    with the <a href="#main-start"><i>main-start</i></a> edge of the line,
    the <a href="#main-end"><i>main-end</i></a> margin edge of the last <a
    href="#flexbox-item"><i>flexbox item</i></a> on the line is placed flush
    with the <a href="#main-end"><i>main-end</i></a> edge of the line, and
    the remaining <a href="#flexbox-item"><i>flexbox items</i></a> on the
    line are distributed so that the empty space between any two adjacent
    items is the same.
  </dl>

  <div class=example>
   <p class=issue>TODO: Examples showing the four values.</p>
  </div>

  <h3 id=flex-align><span class=secno>5.2. </span> Cross Axis Alignment: the
   &lsquo;<a href="#flex-align0"><code
   class=property>flex-align</code></a>&rsquo; property</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=flex-align0>flex-align</dfn>

    <tr>
     <th>Value:

     <td>start | end | center | baseline | stretch

    <tr>
     <th>Initial:

     <td>stretch

    <tr>
     <th>Applies to:

     <td><a href="#flexbox-item"><i>flexbox items</i></a>

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Computed Value:

     <td>specified value

    <tr>
     <th>Media:

     <td>visual
  </table>

  <p>The &lsquo;<a href="#flex-align0"><code
   class=property>flex-align</code></a>&rsquo; property aligns <a
   href="#flexbox-item"><i>flexbox items</i></a> in the <a
   href="#cross-axis"><i>cross axis</i></a> of the current line of the
   flexbox, similar to &lsquo;<a href="#flex-pack0"><code
   class=property>flex-pack</code></a>&rsquo; but in the perpendicular axis.
   Note that &lsquo;<a href="#flex-align0"><code
   class=property>flex-align</code></a>&rsquo; applies to individual <a
   href="#flexbox-item"><i>flexbox items</i></a>, while &lsquo;<a
   href="#flex-pack0"><code class=property>flex-pack</code></a>&rsquo;
   applies to the flexbox itself.

  <dl>
   <dt><dfn id=flex-align-before>before</dfn>

   <dd>The <a href="#cross-start"><i>cross-start</i></a> margin edge of the
    <a href="#flexbox-item"><i>flexbox item</i></a> is placed flush with the
    <a href="#cross-start"><i>cross-start</i></a> edge of the line.

   <dt><dfn id=flex-align-after>after</dfn>

   <dd>The <a href="#cross-end"><i>cross-end</i></a> margin edge of the <a
    href="#flexbox-item"><i>flexbox item</i></a> is placed flush with the <a
    href="#cross-end"><i>cross-end</i></a> edge of the line.

   <dt><dfn id=flex-align-middle>middle</dfn>

   <dd>The <a href="#flexbox-item"><i>flexbox item's</i></a> margin box is
    centered in the <a href="#cross-axis"><i>cross axis</i></a> within the
    line.

   <dt><dfn id=flex-align-baseline>baseline</dfn>

   <dd>
    <p>If the <a href="#flexbox-item"><i>flexbox item's</i></a> inline axis
     is the same as the <a href="#cross-axis"><i>cross axis</i></a>, this
     value is identical to &lsquo;<a href="#flex-pack-start"><code
     class=css>start</code></a>&rsquo;.</p>

    <p>Otherwise, all <a href="#flexbox-item"><i>flexbox items</i></a> on the
     line with &lsquo;<code class=css>flex-align:baseline</code>&rsquo; that
     don't run afoul of the previous paragraph are aligned such that their
     baselines align, and the item with the largest distance between its
     baseline and its <a href="#cross-start"><i>cross-start</i></a> margin
     edge is placed flush against the <a
     href="#cross-start"><i>cross-start</i></a> edge of the line.</p>

   <dt><dfn id=flex-align-stretch>stretch</dfn>

   <dd>
    <p>If the <a href="#cross-size-property"><i>cross size property</i></a>
     of the <a href="#flexbox-item"><i>flexbox item</i></a> is anything other
     than &lsquo;<code class=css>auto</code>&rsquo;, this value is identical
     to &lsquo;<a href="#flex-pack-start"><code
     class=css>start</code></a>&rsquo;.</p>

    <p>Otherwise, this value causes the <a
     href="#cross-size-property"><i>cross size property</i></a> of the <a
     href="#flexbox-item"><i>flexbox item</i></a> to resolve to the length
     necessary to make the <a href="#cross-size"><i>cross size</i></a> of the
     item's margin box the same size as the line.</p>
  </dl>

  <div class=example>
   <p>By using a vertical flexbox and &lsquo;<a href="#flex-align0"><code
    class=property>flex-align</code></a>&rsquo;, we can emulate the
    functionality of HTML's <code>&lt;center></code> element:</p>

   <pre>&lt;div>
	&lt;div>foo foo foo foo&lt;/div>
	&lt;div>bar bar&lt;br>bar bar&lt;/div>
	&lt;div>foo foo foo foo foo foo foo foo foo foo foo foo&lt;/div>
&lt;/div>
&lt;style>
	div {
		display: flexbox;
		flex-flow: column;
		width: 200px;
	}
	div > div {
		flex-align: center;
	}
&lt;/style></pre>

   <p><img alt="" src="images/basic-vertical-flexbox.png"></p>
  </div>

  <p class=issue>More examples for the other alignment values!

  <p>The precise effects of this property are articulated in the <a
   href="#layout-algorithm">Layout Algorithm</a> section.

  <h2 id=multiline><span class=secno>6. </span> Multi-line flexbox</h2>

  <p>If no &lsquo;<code class=property>wrap-</code>&rsquo; keyword is
   included in &lsquo;<a href="#flex-flow0"><code
   class=property>flex-flow</code></a>&rsquo;, flexbox lays out its items in
   a single row or column; any items that don't fit will simply be considered
   overflow.

  <p>Adding any of the &lsquo;<code class=property>wrap-</code>&rsquo;
   keywords to &lsquo;<a href="#flex-flow0"><code
   class=property>flex-flow</code></a>&rsquo; enables multi-line mode. Then
   flexbox is allowed to expand to multiple lines (that is, multiple rows or
   columns) in order to accommodate all of its items. Flexbox must attempt to
   fit its items on as few lines as possible by shrinking all items down to
   their minimum widths or heights if necessary.

  <p>If the items still do not fit on a line after being reduced to their
   minimum widths or heights, then items are moved one by one onto a new
   line, until the items remaining on the previous line fit. This process can
   repeat to an arbitrary number of lines. If a line contains only a single
   item that doesn't fit, then the item should stay on that line and overflow
   out of the box. The later lines are placed according to wrap direction
   specified in &lsquo;<a href="#flex-flow0"><code
   class=property>flex-flow</code></a>&rsquo;.

  <p>The cross-axis size of a line is the cross-axis size of the largest item
   in that line. No additional space appears between the lines apart from the
   margins on the largest items in each line. For calculating the cross-axis
   size of a line, margins with a computed value of auto should be treated as
   having a value of 0.

  <p>Once the number of lines has been determined, items with non-zero
   flexibility stretch as necessary in an attempt to fill the remaining space
   on the lines. Each line computes flexes independently, so only elements on
   that line are considered when evaluating flex. The packing of elements in
   a line, as specified by the flex-pack property, is also computed
   independently for each line.

  <div class=example>
   <p>This example shows four buttons that do not fit horizontally.</p>

   <pre>&lt;style>
#div1 {
	display: flexbox;
	flex-flow: wrap;
	width: 300px;
}
button {
	width: flex(80px 1.0);
}
&lt;style>

&lt;div id="div1">
	&lt;button id="button1">Elephant&lt;/button>
	&lt;button id="button2">Tiger&lt;/button>
	&lt;button id="button3">Antelope&lt;/button>
	&lt;button id="button4">Wildebeest&lt;/button>
&lt;/div></pre>

   <p>The buttons are shrunk to their minimum widths, in this case 80 pixels.
    This will allow the first three buttons to fit in 240 pixels with 60
    pixels left over of remaining space. Because the box-lines property has a
    specified value of multiple, the fourth button may be moved onto a second
    line.</p>

   <p>Flexibility is applied to each element, separately for each line. The
    first line has 60 pixels of remaining space, so each of the three buttons
    on that line will receive 20 pixels of extra width. The remaining button
    on a line of its own will stretch to the entire width of the containing
    box, or 300 pixels.</p>

   <div style="width:300px; border:medium solid green">
    <button style="width:100px">Elephant</button>

    <button style="width:100px">Tiger</button>

    <button style="width:100px">Antelope</button>

    <button style="width:300px">Wildebeest</button>
   </div>

   <p>If the box was resized, the buttons may rearrange onto different lines
    as necessary. If the style rules in the example above were changed to the
    following:</p>

   <pre>
#div1 {
	display: flexbox;
	flex-flow: wrap;
	flex-pack: center;
	width: 300px;
}
button {
	width: flex(80px 1.0);
	max-width: 90px;
}</pre>

   <p>Now, each of the buttons will only stretch to include an additional 10
    pixels of width, as the maximum width of 90 pixels is only 10 pixels
    larger than the minimum intrinsic width of the buttons. The remaining 30
    pixels of space left over is divided up and placed inside the box outside
    of the buttons, as the value of box-pack is center. The fourth button
    will also appear at 90 pixels wide, centered within the box.</p>

   <div style="width:300px; border:medium solid green; text-align:center;">
    <button style="width:90px">Elephant</button>

    <button style="width:90px">Tiger</button>

    <button style="width:90px">Antelope</button>

    <button style="width:90px">Wildebeest</button>
   </div>
  </div>

  <h3 id=flex-line-pack><span class=secno>6.1. </span> &lsquo;<a
   href="#propdef-flex-line-pack"><code
   class=property>flex-line-pack</code></a>&rsquo; property</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=propdef-flex-line-pack>flex-line-pack</dfn>

    <tr>
     <th>Value:

     <td>before | after | middle | distribute

    <tr>
     <th>Initial:

     <td>before

    <tr>
     <th>Applies to:

     <td>flexboxes

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Computed Value:

     <td>specified value

    <tr>
     <th>Media:

     <td>visual
  </table>

  <p>The flex-line-pack property may be used to control the alignment of
   lines in multi-line flexboxes. The values of this property have the
   following meanings:

  <dl>
   <dt><dfn id=flex-line-pack-before>before</dfn>

   <dd>The first line of child boxes is placed along the &lsquo;<a
    href="#flex-line-pack-before"><code
    class=property>before</code></a>&rsquo; edge of the content box (as
    determined by direction of <a href="#cross-axis"><i>cross axis</i></a>),
    and additional lines are placed afterward with no extra spacing between
    them.

   <dt><dfn id=flex-line-pack-after>after</dfn>

   <dd>Lines of child boxes are placed with no extra spacing between and
    &lsquo;<a href="#flex-line-pack-after"><code
    class=property>after</code></a>&rsquo; edge of the last line is aligned
    with &lsquo;<a href="#flex-line-pack-after"><code
    class=property>after</code></a>&rsquo; edge of the content box.

   <dt><dfn id=flex-line-pack-middle>middle</dfn>

   <dd>Lines of child boxes are placed with no space between them and equal
    amount of extra space left before first line and after last line.

   <dt><dfn id=flex-line-pack-distribute>distribute</dfn>

   <dd>The first line of child boxes is aligned with &lsquo;<a
    href="#flex-line-pack-before"><code
    class=property>before</code></a>&rsquo; edge of containing box. Lines of
    child boxes are spread with equal amout of empty spaces between each two
    lines, and so that &lsquo;<a href="#flex-line-pack-after"><code
    class=property>after</code></a>&rsquo; edge of last line of child boxes
    is aligned with &lsquo;<a href="#flex-line-pack-after"><code
    class=property>after</code></a>&rsquo; edge of conaining box.
  </dl>

  <p class=issue>TODO: examples

  <h2 id=free-space-algorithm><span class=secno>7. </span> Free Space
   Calculation and Distribution</h2>

  <p class=issue>IS THIS SECTION NECESSARY? It may be useful for implementors
   as guidance, but it is not normative. The spec describes the result, this
   describes the process - one should be enough, and the description of the
   result is not specific enough, it needs to be fixed.

  <p>The following algorithms detail precisely how to determine the
   dimensions and positions of a flexbox and its contents, and how to resolve
   flexible lengths used on <a href="#flexbox-item"><i>flexbox items</i></a>
   into definite lengths.

  <p>The algorithm described here is designed to be clear, but not
   necessarily efficient. Implementations may use different algorithms, but
   they must generate the same results as this algorithm.

  <p>This section defines several terms to clarify the operation of the
   algorithms described within:

  <dl>
   <dt><dfn id=relevant-length>relevant length</dfn>

   <dd>The width, height, margin, border, or padding of a flexbox item. Also,
    the <i>packing space</i>s of a flexbox.

   <dt><dfn id=flex-tuple>flex tuple</dfn>

   <dd>A 5-tuple of information about a flexible length, containing a minimum
    size, a maximum size, a preferred size, a positive flexibility, and a
    negative flexibility.

   <dt><dfn id=total-free-space>total free space</dfn>

   <dd>The inner width or height of the flexbox (depending on the
    distribution round), which will be used to calculate the sizes of the <a
    href="#flexbox-item"><i>flexbox items</i></a>.

   <dt><dfn id=available-free-space>available free space</dfn>

   <dd>The <a href="#total-free-space"><i>total free space</i></a> minus the
    sum of the preferred sizes of all the relevant lengths, which is used to
    resolve <a href="#flex-tuple"><i>flex tuple</i></a>s into inflexible
    lengths.
  </dl>

  <p>Similarly, the <dfn id=inner-measure>inner measure</dfn> is the width of
   the flexbox item in a horizontal flexbox, or the height in a vertical
   flexbox. The <dfn id=inner-length>inner length</dfn> is the height of the
   flexbox item in a horizontal flexbox, or the width in a vertical flexbox.

  <div class=issue>
   <p>Definition of "inner measure" and "inner length" is not used anywhere,
    or is it? Promote to general-use vocabulary or replace with existing
    terms.</p>

   <p class=issue>Suggestion: "inner measure" == "extent along main axis",
    "inner length" == "extent along cross axis"</p>
  </div>

  <h3 id=free-space-algorithm-initial><span class=secno>7.1. </span> Initial
   Computation</h3>

  <p>This step computes necessary information required to run the free-space
   distribution algorithms.

  <ol>
   <li>Determine the measure of the flexbox. Flexboxes are sized like
    shrinkwrapped blocks (if &lsquo;<code
    class=css>display:flexbox</code>&rsquo; is used) or inline-blocks (if
    &lsquo;<code class=css>display:inline-flexbox</code>&rsquo; is used). A
    horizontal flexbox's measure is its width, while a vertical flexbox's
    measure is its height. <span class=issue>This is wrong. In vertical
    flexbox with auto sizing, height can't be calculated before width
    (assuming horizontal flow). Calculation has to be width-then-height, not
    measure-then-length.</span>

   <li>
    <p>Resolve all <a href="#relevant-length"><i>relevant length</i></a>s on
     the flexbox and its <a href="#flexbox-item"><i>flexbox items</i></a>
     into <dfn id=flex-tuples>flex tuples</dfn> of [minimum size, maximum
     size, preferred size, positive flex, negative flex].</p>

    <dl>
     <dt>For margins and padding:

     <dd>
      <p>Set the minimum size to 0 and the maximum size to infinity.</p>

      <p>If the length is inflexible, set the preferred size to the length
       itself and both positive and negative flexibility to 0.</p>

      <p>If the length is a margin with the value &lsquo;<code
       class=css>auto</code>&rsquo;, set the preferred size to 0, the
       positive flexibility to 1, and the negative flexibility to 0.</p>

     <dt>For borders:

     <dd>Borders are always inflexible. Set the minimum size to 0, the
      maximum size to infinity, the preferred size to the border-width, and
      the positive and negative flexibility to 0.

     <dt>For width and height:

     <dd>
      <p>Set the minimum size to the value of the &lsquo;<code
       class=property>min-width</code>&rsquo; or &lsquo;<code
       class=property>min-height</code>&rsquo;, as appropriate. Set the
       maximum size to the value of the &lsquo;<code
       class=property>max-width</code>&rsquo; or &lsquo;<code
       class=property>max-height</code>&rsquo; property, as appropriate,
       unless the value is &lsquo;<code class=css>none</code>&rsquo;, in
       which case set the maximum size to infinity.</p>

      <p>If the length is inflexible, set the preferred size to the length
       itself and both positive and negative flexibility to 0.</p>

      <p>Otherwise, if the length was specified with the &lsquo;<code
       class=css>flex()</code>&rsquo; function, set the positive and negative
       flexibility to the values specified in the function. If the preferred
       size argument specified in the function is a &lt;length>, set the
       preferred size to that length. If the argment is a &lt;percentage>,
       resolve it relative to the width or height of the flexbox, as
       appropriate, and set the preferred size to the resultant length. If
       the argument is &lsquo;<code class=css>auto</code>&rsquo;, set the
       preferred size to the item's intrinsic dimension in the appropriate
       axis.</p>

      <p>Otherwise, if the length was &lsquo;<code
       class=css>auto</code>&rsquo;, set the preferred size to the item's
       intrinsic dimension in the appropriate axis, the positive flexibility
       to 1, and the negative flexibility to 0.</p>

      <p>If the preferred size is now less than the minimum size, set it
       equal to the minimum size. If the preferred size is now greater than
       the maximum size, set it equal to the maximum size.</p>

     <dt>For <i>packing space</i>s:

     <dd>
      <p>If the flexbox's &lsquo;<a href="#flex-pack0"><code
       class=property>flex-pack</code></a>&rsquo; is <i
       title=flex-pack-start>start</i>,the last <i>packing space</i> (between
       the final <a href="#flexbox-item"><i>flexbox item</i></a>, after
       reordering by &lsquo;<a href="#flex-order0"><code
       class=property>flex-order</code></a>&rsquo;, and the end of the
       flexbox) has a minimum size of 0, a maximum size of infinity, a
       preferred size of 0, a positive flexibility of 1, and a negative
       flexibility of 0. All other <i>packing space</i>s have minimum size,
       maximum size, preferred size, positive flexibility, and negative
       flexibility of 0.</p>

      <p>If the flexbox's &lsquo;<a href="#flex-pack0"><code
       class=property>flex-pack</code></a>&rsquo; is <i
       title=flex-pack-end>end</i>, the first <i>packing space</i> (between
       the first <a href="#flexbox-item"><i>flexbox item</i></a>, after
       reordering by &lsquo;<a href="#flex-order0"><code
       class=property>flex-order</code></a>&rsquo;, and the start of the
       flexbox) has a minimum size of 0, a maximum size of infinity, a
       preferred size of 0, a positive flexibility of 1, and a negative
       flexibility of 0. All other <i>packing space</i>s have minimum size,
       maximum size, preferred size, positive flexibility, and negative
       flexibility of 0.</p>

      <p>If the flexbox's &lsquo;<a href="#flex-pack0"><code
       class=property>flex-pack</code></a>&rsquo; is <i
       title=flex-pack-center>center</i>, the first and last <i>packing
       space</i>s (as defined above) have a minimum size of 0, a maximum size
       of infinity, a preferred size of 0, a positive flexibility of 1, and a
       negative flexibility of 0. All other <i>packing space</i>s have
       minimum size, maximum size, preferred size, positive flexibility, and
       negative flexibility of 0.</p>

      <p>If the flexbox's &lsquo;<a href="#flex-pack0"><code
       class=property>flex-pack</code></a>&rsquo; is <i
       title=flex-pack-justify>justify</i>, the first and last <i>packing
       space</i>s (as defined above) have a minimum size, maximum size,
       preferred size, positive flexibility, and negative flexibility of 0.
       All other <i>packing space</i>s have a minimum size of 0, a maximum
       size of infinity, a preferred size of 0, a positive flexibility of 1,
       and a negative flexibility of 0.</p>
    </dl>
  </ol>

  <h3 id=first-distribution-round><span class=secno>7.2. </span> First
   Distribution Round</h3>

  <p>This step distributes free space to the flexible lengths of the flexbox
   in the <i>measure axis</i>.

  <p>Collect the set of <a href="#flex-tuple"><i>flex tuple</i></a>s that can
   participate in this step:

  <ol>
   <li>If the flexbox is horizontal, collect the widths of every <a
    href="#flexbox-item"><i>flexbox item</i></a>. If the flexbox is vertical,
    instead collect the heights of every <a href="#flexbox-item"><i>flexbox
    item</i></a>.

   <li>Collect the margins of every <a href="#flexbox-item"><i>flexbox
    item</i></a> that are in the flexbox's measure axis.

   <li>Collect the borders of every <a href="#flexbox-item"><i>flexbox
    item</i></a> that are in the flexbox's measure axis, if the <a
    href="#flexbox-item"><i>flexbox item</i></a> has a &lsquo;<code
    class=property>box-sizing</code>&rsquo; value of &lsquo;<code
    class=css>content-box</code>&rsquo; or &lsquo;<code
    class=css>padding-box</code>&rsquo;.

   <li>Collect the paddings of every <a href="#flexbox-item"><i>flexbox
    item</i></a> that are in the flexbox's measure axis, if the <a
    href="#flexbox-item"><i>flexbox item</i></a> has a &lsquo;<code
    class=property>box-sizing</code>&rsquo; value of &lsquo;<code
    class=css>content-box</code>&rsquo;.
  </ol>

  <p>Invoke the <i>free space allocation algorithm</i> with the set of <a
   href="#flex-tuple"><i>flex tuple</i></a>s collected above, and an <a
   href="#available-free-space"><i>available free space</i></a> equal to the
   flexbox's inner measure.

  <h3 id=second-distribution-round><span class=secno>7.3. </span> Second
   Distribution Round</h3>

  <p>This step distributes any leftover available space to the <i>packing
   space</i>, so that the flexbox items are arranged within the flexbox as
   desired.

  <p>Collect the same set of <a href="#flex-tuple"><i>flex tuple</i></a>s as
   in the first distribution round (now inflexible lengths), and additionally
   collect the flexbox's <i>packing space</i>s.

  <p>Invoke the <i>free space allocation algorithm</i> with the set of <a
   href="#flex-tuple"><i>flex tuple</i></a>s collected above, and an <a
   href="#available-free-space"><i>available free space</i></a> equal to the
   flexbox's inner measure.

  <h3 id=intermediate-computation><span class=secno>7.4. </span> Intermediate
   Computation</h3>

  <p>Determine the length of the flexbox, given the sizes that have already
   been determined.

  <h3 id=third-distribution-round><span class=secno>7.5. </span> Third
   Distribution Round</h3>

  <p>This step distributes free space to the flexible lengths of each flexbox
   item in the <i>length axis</i>. <strong>It is run for each <a
   href="#flexbox-item"><i>flexbox item</i></a> independently.</strong>

  <p class=issue>ISSUE: This step doesn't yet take &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo; into
   account. I need to decide whether to always default to stretching or
   shrinking when doing baseline-alignment, or coming up with some heuristic
   for it. Perhaps specify the behavior in the &lsquo;<a
   href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
   values instead? Once this decision is made, the behavior is relatively
   simple - either adjust margin (if shrunk) or padding (if stretched)

  <p>Collect the set of <a href="#flex-tuple"><i>flex tuple</i></a>s from the
   current <a href="#flexbox-item"><i>flexbox item</i></a> that can
   participate in this step:

  <ol>
   <li>If the flexbox is horizontal, collect the height of the <a
    href="#flexbox-item"><i>flexbox item</i></a>. If the flexbox is vertical,
    instead collect the width of the <a href="#flexbox-item"><i>flexbox
    item</i></a>.

   <li>Collect the margins of the <a href="#flexbox-item"><i>flexbox
    item</i></a> that are in the flexbox's length axis.

   <li>Collect the borders of the <a href="#flexbox-item"><i>flexbox
    item</i></a> that are in the flexbox's length axis, if the <a
    href="#flexbox-item"><i>flexbox item</i></a> has a &lsquo;<code
    class=property>box-sizing</code>&rsquo; value of &lsquo;<code
    class=css>content-box</code>&rsquo; or &lsquo;<code
    class=css>padding-box</code>&rsquo;.

   <li>Collect the padding lengths of the <a href="#flexbox-item"><i>flexbox
    item</i></a> that are in the flexbox's length axis, if the <a
    href="#flexbox-item"><i>flexbox item</i></a> has a &lsquo;<code
    class=property>box-sizing</code>&rsquo; value of &lsquo;<code
    class=css>content-box</code>&rsquo;.
  </ol>

  <p>Invoke the <i>free space allocation algorithm</i> with the set of <a
   href="#flex-tuple"><i>flex tuple</i></a>s collected above, and an <a
   href="#available-free-space"><i>available free space</i></a> equal to the
   flexbox's inner length.

  <h3 id=free-space-allocation-algorithm><span class=secno>7.6. </span> Free
   Space Allocation Algorithm</h3>

  <p>This section describes the algorithm used to allocate free space to a
   set of flexible lengths. The inputs to this algorithm are a set of <a
   href="#flex-tuple"><i>flex tuple</i></a>s and a length representing the <a
   href="#total-free-space"><i>total free space</i></a>. The output is a set
   of inflexible lengths.

  <p>Calculate the <a href="#available-free-space"><i>available free
   space</i></a> by summing the preferred size of all the <a
   href="#flex-tuple"><i>flex tuple</i></a>s and subtracting that value from
   the <a href="#total-free-space"><i>total free space</i></a>.

  <p>If the <a href="#available-free-space"><i>available free space</i></a>
   is 0, transform all the <a href="#flex-tuple"><i>flex tuple</i></a>s into
   inflexible lengths equal to their preferred size and return them.

  <p>If the <a href="#available-free-space"><i>available free space</i></a>
   is a positive length, it will be distributed between all the <a
   href="#flex-tuple"><i>flex tuple</i></a>s with positive flexibility:

  <ol>
   <li>Sum the <a href="#positive-flexibility"><i>positive
    flexibility</i></a> of all the <a href="#flex-tuple"><i>flex
    tuple</i></a>s. This is the <i>total flexibility</i>.

   <li>If the <i>total flexibility</i> is 0, transform all the <a
    href="#flex-tuple"><i>flex tuple</i></a>s into inflexible lengths equal
    to their preferred size and return them.

   <li>
    <p>For each <a href="#flex-tuple"><i>flex tuple</i></a> with non-zero <a
     href="#positive-flexibility"><i>positive flexibility</i></a>, set its
     preferred size to:</p>

    <pre><code>[preferred size] + ( [available free space] * [positive flexibility] / [total flexibility] )</code></pre>

   <li>If any <a href="#flex-tuple"><i>flex tuple</i></a>s now have a
    preferred size greater than their maximum size, set their preferred size
    to their maximum size, set their positive flexibility to 0, and restart
    this algorithm.

   <li>Transform all the <a href="#flex-tuple"><i>flex tuple</i></a>s into
    inflexible lengths equal to their preferred size, and return them.
  </ol>

  <p>If the <a href="#available-free-space"><i>available free space</i></a>
   is a negative length, all the <a href="#flex-tuple"><i>flex tuple</i></a>s
   with negative flexibility will shrink to attemp to fit the set of <a
   href="#flex-tuple"><i>flex tuple</i></a>s into the available space:

  <ol>
   <li>Sum the <a href="#negative-flexibility"><i>negative
    flexibility</i></a> of all the <a href="#flex-tuple"><i>flex
    tuple</i></a>s. This is the <i>total flexibility</i>.

   <li>If the <i>total flexibility</i> is 0, transform all the <a
    href="#flex-tuple"><i>flex tuple</i></a>s into inflexible lengths equal
    to their preferred size and return them.

   <li>
    <p>For each <a href="#flex-tuple"><i>flex tuple</i></a> with non-zero <a
     href="#negative-flexibility"><i>negative flexibility</i></a>, set its
     preferred size to:</p>

    <pre><code>[preferred size] + ( [available free space] * [negative flexibility] / [total flexibility] )</code></pre>

    <p class=note>Note that the <a href="#available-free-space"><i>available
     free space</i></a> is a negative length here, so the sum will result in
     a smaller length.</p>

   <li>If any <a href="#flex-tuple"><i>flex tuple</i></a>s now have a
    preferred size lesser than their minimum size, set their preferred size
    to their minimum size, set their negative flexibility to 0, and restart
    this algorithm.

   <li>Transform all the <a href="#flex-tuple"><i>flex tuple</i></a>s into
    inflexible lengths equal to their preferred size, and return them.
  </ol>

  <h2 id=pagination><span class=secno>8. </span> Page breaks in flexbox</h2>

  <p class=issue>TODO: define how flexbox should break on pages, columns,
   etc. This may or may not be normative until there is more than one
   implementation.

  <p>Very roughly:

  <ul>
   <li>Flexboxes can beak across pages between items, between rows of items
    (in multi-line mode) and inside items, as long as &lsquo;<code
    class=property>break-</code>&rsquo; property allow that. All &lsquo;<code
    class=property>break-</code>&rsquo; properties are supported on flexbox,
    on flexbox items and inside flexbox items.

   <li>Breaking behavior of a single-line vertical flexbox should be
    identical to a block in normal flow where children have same sizes and
    positions (e.g. explicitly set to match computed values in flexbox), same
    content and same breaking properties. <span class=issue>This is good goal
    or guidance, but not necessarily good normative definition. Get
    specific.</span>

   <li>Breaking behavior of a horizontal single-line flexbox should be
    similar (not necessarily identical) to that of a single-row table with
    same sizing.

   <li>In horizontal flexbox, a forced break within an items causes
    subsequent content of that item to go to next container, but it doesn't
    affect sibling items or their content.

   <li>In horizontal multi-line flexbox, values of &lsquo;<code
    class=property>break-before</code>&rsquo; and &lsquo;<code
    class=property>break-after</code>&rsquo; for each line are computed from
    combinatoin of properties on children that fit in that line (or would
    have fit, given available width and infinite height)
  </ul>

  <p class=issue>TODO: define breaking of vertical multi-line flexbox

  <p class=issue>TODO: add more detail: how breaking affect sizing (for
   broken boxes and boxes after the break) and alignment

  <h2 id=layout-interface><span class=secno>9. </span> Box Properties and
   Sizing</h2>

  <p class=issue>Define how flexboxes are sized, paying attention to
   width/height keywords on both the flexbox and flexbox items, the writing
   modes of both the flexbox and flexbox items, and the flexbox direction.

  <hr title="Separator from footer">

  <h2 id=changes><span class=secno>10. </span>Changes</h2>

  <h3 id=changes-from-ed-16-june-2011><span class=secno>10.1. </span>Changes
   from ED 16-June-2011</h3>

  <ul>
   <li>Intro
    <ul>
     <li>Added definitions for main axis and cross axis

     <li>Added a pargraph on multiline
    </ul>

   <li>&lsquo;<code class=property>display</code>&rsquo; property
    <ul>
     <li>Removed issue for "display-inside" (now ACTION-342)
    </ul>

   <li>Flex-item
    <ul>
     <li>New section, adds detail for flex item fixup

     <li>Removed issue for "other ignored properties"

     <li>Added issue on applicability of &lsquo;<code
      class=property>vertical-align</code>&rsquo;
    </ul>

   <li>&lsquo;<a href="#flex-flow0"><code
    class=property>flex-flow</code></a>&rsquo; property
    <ul>
     <li>Renamed (was &lsquo;<code
      class=property>flex-direction</code>&rsquo;)

     <li>Values as in "option 8" <a
      href="http://wiki.csswg.org/spec/css3-flexbox#issue-2">http://wiki.csswg.org/spec/css3-flexbox#issue-2</a>

     <li>Computed value: specified value (was lr/rl/tb/bt)

     <li>Prose describing how the pair of values work
    </ul>

   <li>&lsquo;<a href="#flex-order0"><code
    class=property>flex-order</code></a>&rsquo;
    <ul>
     <li>Removed "flex-order vs. flex-index" issue. There is an issue at Wiki
      to finalize that, proposal to not change: <a
      href="http://wiki.csswg.org/spec/css3-flexbox#issue-8">http://wiki.csswg.org/spec/css3-flexbox#issue-8</a>
    </ul>

   <li>Flexibility
    <ul>
     <li>Removed &lsquo;<code class=property>fr</code>&rsquo; unit

     <li>Changed default/unspecified values to &lsquo;<code
      class=css>initial</code>&rsquo;, removed references to specifically
      &lsquo;<code class=property>width</code>&rsquo; and &lsquo;<code
      class=property>height</code>&rsquo;. No changes to what it applies to,
      but this way it is more general, in case it does need to apply to
      something else (for example to be part of grid rows/columns
      declarations)

     <li>Added a paragraph allowing (but not requiring) accepting unitless
      non-zero length in quirks mode, only when three values are specified.
    </ul>

   <li>Flexible margins
    <ul>
     <li>Added issue 15: &lsquo;<code class=css>margin:auto</code>&rsquo; as
      flex of 1 is not as powerful as &lsquo;<code class=css>margin:flex(2,
      20, 5)</code>&rsquo;. Is it enough? A good use case would help (issue
      16)
    </ul>

   <li>&lsquo;<a href="#flex-align0"><code
    class=property>flex-align</code></a>&rsquo; property
    <ul>
     <li>Adapted most of the definition of &lsquo;<a
      href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
      from 2009 spec

     <li>Note difference from 2009 spec remains – &lsquo;<a
      href="#flex-align0"><code class=property>flex-align</code></a>&rsquo;
      applies to flexbox items, while &lsquo;<code
      class=property>box-align</code>&rsquo; of the old spec applied to
      flexbox.

     <li>Added definition for where is &lsquo;<a
      href="#flex-line-pack-before"><code
      class=property>before</code></a>&rsquo; and where is &lsquo;<a
      href="#flex-line-pack-after"><code
      class=property>after</code></a>&rsquo;

     <li>Open issue 14 for before/after to validate the definition.

     <li>Included definition of how flexbox cross-axis size is determined in
      case of baseline-aligned children or mixed.

     <li>Note: the core alignment algorithm copied from 2009 spec describes
      how auto margins work together with &lsquo;<a href="#flex-align0"><code
      class=property>flex-align</code></a>&rsquo;. That algorithm is copied
      unchanged, proposed to adopt. It gives priority to margins over align
      (if I am reading it correctly): "flex-align:before; margin-top:auto"
      will end up being bottom-aligned in a horizontal flexbox.
    </ul>

   <li>Multiline flexbox
    <ul>
     <li>Copied the section on multiline flexbox from 2009 spec, adapted to
      fit into the current draft
    </ul>

   <li>&lsquo;<a href="#propdef-flex-line-pack"><code
    class=property>Flex-line-pack</code></a>&rsquo; property

   <li>Other
    <ul>
     <li>Replaced "measure axis" with "main axis"

     <li>Removed commented out intro draft
    </ul>
  </ul>

  <h2 class=no-num id=acknowledgments>Acknowledgments</h2>

  <p>[This section will contain further acknowledgments.]

  <p>Thanks for feedback from James Elmore and Shinichiro Hamaji.

  <h2 class=no-num id=references>References</h2>

  <h3 class=no-num id=normative>Normative references</h3>
  <!--begin-normative-->
  <!-- Sorted by label -->

  <dl class=bibliography>
   <dt style="display: none"><!-- keeps the doc valid if the DL is empty -->
    <!---->
  </dl>
  <!--end-normative-->

  <h3 class=no-num id=informative>Other references</h3>
  <!--begin-informative-->
  <!-- Sorted by label -->

  <dl class=bibliography>
   <dt style="display: none"><!-- keeps the doc valid if the DL is empty -->
    <!---->
  </dl>
  <!--end-informative-->

  <h2 class=no-num id=property>Property index</h2>
  <!--begin-properties-->

  <table class=proptable>
   <thead>
    <tr>
     <th>Property

     <th>Values

     <th>Initial

     <th>Applies&nbsp;to

     <th>Inh.

     <th>Percentages

     <th>Media

   <tbody>
    <tr>
     <th><span class=property>display</span>

     <td>flexbox | inline-flexbox

    <tr>
     <th><a class=property href="#flex-align0">flex-align</a>

     <td>start | end | center | baseline | stretch

     <td>stretch

     <td>flexbox items

     <td>no

     <td>specified value

     <td>visual

    <tr>
     <th><a class=property href="#flex-flow0">flex-flow</a>

     <td>[ row | row-reverse | column | column-reverse ] [ wrap |
      wrap-reverse ]? | [ horizontal | horizontal-reverse | horizontal-ltr |
      horizontal-rtl ] [ wrap | wrap-reverse | wrap-down | wrap-up ]? | [
      vertical | vertical-reverse | vertical-ttb | vertical-btt ] [ wrap |
      wrap-reverse | wrap-left | wrap-right ]?

     <td>row

     <td>flexboxes

     <td>no

     <td>specified value

     <td>visual

    <tr>
     <th><a class=property href="#propdef-flex-line-pack">flex-line-pack</a>

     <td>before | after | middle | distribute

     <td>before

     <td>flexboxes

     <td>no

     <td>specified value

     <td>visual

    <tr>
     <th><a class=property href="#flex-order0">flex-order</a>

     <td>&lt;integer>

     <td>1

     <td>flexbox items

     <td>no

     <td>specified value

     <td>visual

    <tr>
     <th><a class=property href="#flex-pack0">flex-pack</a>

     <td>start | end | center | distribute

     <td>start

     <td>flexboxes

     <td>no

     <td>specified value

     <td>visual
  </table>
  <!--end-properties-->

  <h2 class=no-num id=index>Index</h2>
  <!--begin-index-->

  <ul class=indexlist>
   <li>after, <a href="#flex-align-after"
    title=after><strong>5.2.</strong></a>, <a href="#flex-line-pack-after"
    title=after><strong>6.1.</strong></a>

   <li>available free space, <a href="#available-free-space" title="available
    free space"><strong>7.</strong></a>

   <li>baseline, <a href="#flex-align-baseline"
    title=baseline><strong>5.2.</strong></a>

   <li>before, <a href="#flex-align-before"
    title=before><strong>5.2.</strong></a>, <a href="#flex-line-pack-before"
    title=before><strong>6.1.</strong></a>

   <li>center, <a href="#flex-pack-center"
    title=center><strong>5.1.</strong></a>

   <li>column, <a href="#flex-flow-column"
    title=column><strong>3.1.</strong></a>

   <li>column-reverse, <a href="#flex-flow-column-reverse"
    title=column-reverse><strong>3.1.</strong></a>

   <li>cross axis, <a href="#cross-axis" title="cross
    axis"><strong>2.</strong></a>

   <li>cross-end, <a href="#cross-end"
    title=cross-end><strong>2.</strong></a>

   <li>cross size, <a href="#cross-size" title="cross
    size"><strong>2.</strong></a>

   <li>cross size property, <a href="#cross-size-property" title="cross size
    property"><strong>2.</strong></a>

   <li>cross-start, <a href="#cross-start"
    title=cross-start><strong>2.</strong></a>

   <li>distribute, <a href="#flex-line-pack-distribute"
    title=distribute><strong>6.1.</strong></a>, <a
    href="#flex-pack-distribute" title=distribute><strong>5.1.</strong></a>

   <li>end, <a href="#flex-pack-end" title=end><strong>5.1.</strong></a>

   <li>flex-align, <a href="#flex-align0"
    title=flex-align><strong>5.2.</strong></a>

   <li>flexbox, <a href="#flexbox" title=flexbox><strong>2.</strong></a>

   <li>flexbox item, <a href="#flexbox-item" title="flexbox
    item"><strong>2.</strong></a>

   <li>flexbox items, <a href="#flexbox-item" title="flexbox
    items"><strong>2.</strong></a>

   <li>flexbox item's, <a href="#flexbox-item" title="flexbox
    item's"><strong>2.</strong></a>

   <li>flex-flow, <a href="#flex-flow0"
    title=flex-flow><strong>3.1.</strong></a>

   <li>flexible length, <a href="#flexible-length" title="flexible
    length"><strong>4.</strong></a>, <a href="#flexible-length0"
    title="flexible length"><strong>4.1.</strong></a>

   <li>flexible lengths, <a href="#flexible-length0" title="flexible
    lengths"><strong>4.1.</strong></a>

   <li>flexible length's, <a href="#flexible-length0" title="flexible
    length's"><strong>4.1.</strong></a>

   <li>flex-line-pack, <a href="#propdef-flex-line-pack"
    title=flex-line-pack><strong>6.1.</strong></a>

   <li>flex-order, <a href="#flex-order0"
    title=flex-order><strong>3.2.</strong></a>

   <li>flex-pack, <a href="#flex-pack0"
    title=flex-pack><strong>5.1.</strong></a>

   <li>flex tuple, <a href="#flex-tuple" title="flex
    tuple"><strong>7.</strong></a>

   <li>flex tuples, <a href="#flex-tuples" title="flex
    tuples"><strong>7.1.</strong></a>

   <li>free space, <a href="#free-space" title="free
    space"><strong>4.2.</strong></a>

   <li>horizontal, <a href="#flex-flow-horizontal"
    title=horizontal><strong>3.1.</strong></a>

   <li>horizontal-ltr, <a href="#flex-flow-horizontal-ltr"
    title=horizontal-ltr><strong>3.1.</strong></a>

   <li>horizontal-reverse, <a href="#flex-flow-horizontal-reverse"
    title=horizontal-reverse><strong>3.1.</strong></a>

   <li>horizontal-rtl, <a href="#flex-flow-horizontal-rtl"
    title=horizontal-rtl><strong>3.1.</strong></a>

   <li>hypothetical neighbors, <a href="#hypothetical-neighbors"
    title="hypothetical neighbors"><strong>2.2.</strong></a>

   <li>inner length, <a href="#inner-length" title="inner
    length"><strong>7.</strong></a>

   <li>inner measure, <a href="#inner-measure" title="inner
    measure"><strong>7.</strong></a>

   <li>main axis, <a href="#main-axis" title="main
    axis"><strong>2.</strong></a>

   <li>main-end, <a href="#main-end" title=main-end><strong>2.</strong></a>

   <li>main size, <a href="#main-size" title="main
    size"><strong>2.</strong></a>

   <li>main size property, <a href="#main-size-property" title="main size
    property"><strong>2.</strong></a>

   <li>main-start, <a href="#main-start"
    title=main-start><strong>2.</strong></a>

   <li>middle, <a href="#flex-align-middle"
    title=middle><strong>5.2.</strong></a>, <a href="#flex-line-pack-middle"
    title=middle><strong>6.1.</strong></a>

   <li>negative flexibility, <a href="#negative-flexibility" title="negative
    flexibility"><strong>4.1.</strong></a>

   <li>positive flexibility, <a href="#positive-flexibility" title="positive
    flexibility"><strong>4.1.</strong></a>

   <li>preferred size, <a href="#preferred-size" title="preferred
    size"><strong>4.1.</strong></a>

   <li>relevant length, <a href="#relevant-length" title="relevant
    length"><strong>7.</strong></a>

   <li>row, <a href="#flex-flow-row" title=row><strong>3.1.</strong></a>

   <li>row-reverse, <a href="#flex-flow-row-reverse"
    title=row-reverse><strong>3.1.</strong></a>

   <li>start, <a href="#flex-pack-start"
    title=start><strong>5.1.</strong></a>

   <li>stretch, <a href="#flex-align-stretch"
    title=stretch><strong>5.2.</strong></a>

   <li>total free space, <a href="#total-free-space" title="total free
    space"><strong>7.</strong></a>

   <li>total negative flexibility, <a href="#total-negative-flexibility"
    title="total negative flexibility"><strong>4.2.</strong></a>

   <li>total positive flexibility, <a href="#total-positive-flexibility"
    title="total positive flexibility"><strong>4.2.</strong></a>

   <li>vertical, <a href="#flex-flow-vertical"
    title=vertical><strong>3.1.</strong></a>

   <li>vertical-btt, <a href="#flex-flow-row-vertical-btt"
    title=vertical-btt><strong>3.1.</strong></a>

   <li>vertical-reverse, <a href="#flex-flow-vertical-reverse"
    title=vertical-reverse><strong>3.1.</strong></a>

   <li>vertical-ttb, <a href="#flex-flow-vertical-ttb"
    title=vertical-ttb><strong>3.1.</strong></a>

   <li>wrap, <a href="#flex-flow-wrap" title=wrap><strong>3.1.</strong></a>

   <li>wrap-down, <a href="#flex-flow-wrap-down"
    title=wrap-down><strong>3.1.</strong></a>

   <li>wrap-left, <a href="#flex-flow-wrap-left"
    title=wrap-left><strong>3.1.</strong></a>

   <li>wrap-reverse, <a href="#flex-flow-wrap-reverse"
    title=wrap-reverse><strong>3.1.</strong></a>

   <li>wrap-right, <a href="#flex-flow-wrap-right"
    title=wrap-right><strong>3.1.</strong></a>

   <li>wrap-up, <a href="#flex-flow-wrap-up"
    title=wrap-up><strong>3.1.</strong></a>
  </ul>
  <!--end-index-->
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
