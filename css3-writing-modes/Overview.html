<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html lang=en>
 <head><meta content="text/html; charset=utf-8" http-equiv=Content-Type>

  <title>CSS Text Layout Module Level 3</title>
  <link href="../default.css" rel=stylesheet type="text/css">
  <link href="http://www.w3.org/StyleSheets/tr/W3C-ED.css" rel=stylesheet
  type="text/css">

  <style type="text/css">
    .data, .proptable {
      margin: 1em auto;
      border-collapse: collapse;
      border: solid #005A9B;
    }
    .data caption {
      width: 100%;
      text-align: center;
    }
    .data td, .data th,
    .proptable td, .proptable th {
      border: thin solid;
      padding: 0.2em;
      text-align: center;
    }
    .data thead th[scope="row"],
    .proptable thead th[scope="row"] {
      text-align: right;
      background: #A4C8E2;
      color: inherit;
    }
    .data thead,
    .proptable thead {
      background: #EEEEEE;
      color: inherit;
    }
    .data tbody th:first-child,
    .proptable tbody th:first-child {
      text-align: right;
      background: #EEEEEE;
      color: inherit;
    }
    .data thead,
    .data tbody,
    .data tfoot,
    .data colgroup {
      border: solid;
    }

    table.propdef {
      table-layout: auto;
    }
    .propdef th {
      font-style: italic;
      font-weight: normal;
      text-align: left;
      width: 3em;
    }
    dt dfn code {
      font-size: inherit;
    }
    .egbidiwsaA,.egbidiwsbB,.egbidiwsaB,.egbidiwsbC
      { white-space:pre;font-size:80%;font-family:monospace; vertical-align:2px; margin:1px }
    .egbidiwsaA { background:lime;padding:2px; }
    .egbidiwsbB { border:2px solid blue }
    .egbidiwsaB { background:yellow;border:2px dotted white }
    .egbidiwsbC { border:2px dotted red }
  </style>

 <body>
  <div class=head> <!--begin-logo-->
   <p><a href="http://www.w3.org/"><img alt=W3C height=48
    src="http://www.w3.org/Icons/w3c_home" width=72></a> <!--end-logo-->

   <h1>CSS Text Layout Module Level 3</h1>

   <h2 class="no-num no-toc" id=longstatus-date>Editor's Draft 9 June 2010</h2>

   <dl>
    <dt>This version:

    <dd><a
     href="http://dev.w3.org/csswg/css3-text-layout/">http://dev.w3.org/csswg/css3-text-layout/</a>
     

    <dt>Latest version:

    <dd><a
     href="http://www.w3.org/TR/css3-text-layout/">http://www.w3.org/TR/css3-text-layout/</a>

    <dt>Previous version:

    <dd><a
     href="http://www.w3.org/tr/2003/CR-css3-text-20030514/">http://www.w3.org/tr/2003/CR-css3-text-20030514/</a>

    <dt>Editors:

    <dd><a href="http://fantasai.inkedblade.net/contact">Elika J. Etemad</a>

    <dd><a href="mailto:murakami@antenna.co.jp">Shinyu Murakami</a> (<a
     href="http://www.antennahouse.com/">Antenna House</a>)

    <dt>Previous Editors:

    <dd><a href="mailto:paulnel@microsoft.com">Paul Nelson</a> (<a
     href="http://www.microsoft.com/">Microsoft</a>)

    <dd><a href="mailto:michelsu@microsoft.com">Michel Suignard</a> (<a
     href="http://www.microsoft.com/">Microsoft</a>)
   </dl>
   <!--begin-copyright-->
   <p class=copyright><a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright"
    rel=license>Copyright</a> &copy; 2010 <a
    href="http://www.w3.org/"><acronym title="World Wide Web
    Consortium">W3C</acronym></a><sup>&reg;</sup> (<a
    href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute
    of Technology">MIT</acronym></a>, <a href="http://www.ercim.eu/"><acronym
    title="European Research Consortium for Informatics and
    Mathematics">ERCIM</acronym></a>, <a
    href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>
    and <a
    href="http://www.w3.org/Consortium/Legal/copyright-documents">document
    use</a> rules apply.</p>
   <!--end-copyright-->
   <hr title="Separator for header">
  </div>

  <h2 class="no-num no-toc" id=abstract>Abstract</h2>

  <p>This module specifies the text layout model in CSS and the properties
   that control it. It covers bidirectionality and vertical text.

  <h2 class="no-num no-toc" id=status>Status of this document</h2>
  <!--begin-status-->

  <p>This is a public copy of the editors' draft. It is provided for
   discussion only and may change at any moment. Its publication here does
   not imply endorsement of its contents by W3C. Don't cite this document
   other than as work in progress.

  <p>The (<a
   href="http://lists.w3.org/Archives/Public/www-style/">archived</a>) public
   mailing list <a
   href="mailto:www-style@w3.org?Subject=%5Bcss3-text-layout%5D%20PUT%20SUBJECT%20HERE">
   www-style@w3.org</a> (see <a
   href="http://www.w3.org/Mail/Request">instructions</a>) is preferred for
   discussion of this specification. When sending e-mail, please put the text
   &#8220;css3-text-layout&#8221; in the subject, preferably like this:
   &#8220;[<!---->css3-text-layout<!---->] <em>&hellip;summary of
   comment&hellip;</em>&#8221;

  <p>This document was produced by the <a href="/Style/CSS/members">CSS
   Working Group</a> (part of the <a href="/Style/">Style Activity</a>).

  <p>This document was produced by a group operating under the <a
   href="/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent
   Policy</a>. W3C maintains a <a href="/2004/01/pp-impl/32061/status"
   rel=disclosure>public list of any patent disclosures</a> made in
   connection with the deliverables of the group; that page also includes
   instructions for disclosing a patent. An individual who has actual
   knowledge of a patent which the individual believes contains <a
   href="/Consortium/Patent-Policy-20040205/#def-essential">Essential
   Claim(s)</a> must disclose the information in accordance with <a
   href="/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the
   W3C Patent Policy</a>.</p>
  <!--end-status-->

  <h2 class="no-num no-toc" id=Contents>Contents</h2>
  <!--begin-toc-->

  <ul class=toc>
   <li><a href="#intro"><span class=secno>1. </span>Introduction</a>

   <li><a href="#text-flow"><span class=secno>2. </span>Writing Modes and
    Terminology</a>

   <li><a href="#text-direction"><span class=secno>3. </span>Inline Direction
    and Bidirectionality</a>
    <ul class=toc>
     <li><a href="#direction"><span class=secno>3.1. </span>Specifying
      Directionality: the &lsquo;<code class=property>direction</code>&rsquo;
      property</a>

     <li><a href="#unicode-bidi"><span class=secno>3.2. </span>Embeddings and
      Overrides: the &lsquo;<code class=property>uncode-bidi</code>&rsquo;
      property</a>

     <li><a href="#bidi-example"><span class=secno>3.3. </span>Example of
      Bidirectional Text</a>
    </ul>

   <li><a href="#block-flow"><span class=secno>4. </span>Block Flow
    Direction: the &lsquo;<code class=property>block-flow</code>&rsquo;
    property</a>
    <ul class=toc>
     <li><a href="#details"><span class=secno>4.1. </span>Details</a>

     <li><a href="#example"><span class=secno>4.2. </span>Example</a>

     <li><a href="#writing-mode"><span class=secno>4.3. </span>The
      &lsquo;<code class=property>writing-mode</code>&rsquo; shorthand
      property</a>

     <li><a href="#writing-mode-mixed"><span class=secno>4.4. </span>Mixing
      the &lsquo;<code class=property>writing-mode</code>&rsquo; in normal
      usage</a>
    </ul>

   <li><a href="#logical-directional"><span class=secno>5. </span>Logical
    directional properties and values</a>
    <ul class=toc>
     <li><a href="#logical-terminology"><span class=secno>5.1.
      </span>Terminology</a>

     <li><a href="#logical-prop"><span class=secno>5.2. </span>Logical
      properties: &lsquo;<code class=property>margin-before</code>&rsquo;,
      &lsquo;<code class=property>logical-width</code>&rsquo;, etc.</a>

     <li><a href="#logical-value"><span class=secno>5.3. </span>Logical
      property values: before, after, start, end</a>
    </ul>
  </ul>
  <!--end-toc-->

  <h2 id=intro><span class=secno>1. </span>Introduction</h2>

  <p>This module describes the text layout features supported by CSS, which
   includes support for various international writing directions, such as
   left-to-right (e.g., Latin scripts), right-to-left (e.g., Hebrew or
   Arabic), bidirectional (e.g., mixing Latin with Arabic) and vertical
   (e.g., Asian scripts). In addition, this module defines a set of
   writing-mode relative (logical) properties, such as
   margin-before/after/start/end.

  <h2 id=text-flow><span class=secno>2. </span>Writing Modes and Terminology</h2>

  <p>A <dfn id=writing-mode0>writing mode</dfn> is defined in terms of its
   <dfn id=inline-direction>inline direction</dfn> (<dfn
   id=inline-progression>inline progression</dfn>) and its block flow (<dfn
   id=block-progression>block progression</dfn>). The <dfn
   id=inline-direction0>inline direction</dfn> is the primary direction in
   which content is ordered on a line and defines on which sides of a box the
   "start" and "end" are. The &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; and &lsquo;<a
   href="#unicode-bidi0"><code class=property>unicode-bidi</code></a>&rsquo;
   properties determine the direction of inline flow. The <dfn
   id=block-flow0>block flow</dfn> direction is the direction in which
   block-level boxes stack and the direction in which line boxes stack within
   a block box. The &lsquo;<a href="#block-flow1"><code
   class=property>block-flow</code></a>&rsquo; property determines the block
   flow direction. The term "writing mode" is chosen because these properties
   are strongly associated with the layout of text.

  <p>Writing systems typically have one or two standard writing modes. Some
   examples are:

  <ul>
   <li>Latin scripts are typically written using a left-to-right inline
    direction with a downward (top-to-bottom) block flow.

   <li>Mongolian script languages are typically written using a top-to-bottom
    inline direction with a rightward (left-to-right) block flow.

   <li>Japanese is commonly written using both a left-to-right inline
    direction with a downard (top-to-bottom) block flow, <strong>and</strong>
    a top-to-bottom inline progression with a leftward (right-to-left) block
    flow. Many magazines and newspapers will mix these two writing modes on
    the same page.
  </ul>

  <p>A <dfn id=horizontal-writing-mode>horizontal writing mode</dfn> is one
   with horizontal lines of text, i.e. a downward or upward block flow. A
   <dfn id=vertical-writing-mode>vertical writing mode</dfn> is one with
   vertical lines of text, i.e. a leftward or rightward block flow. <span
   class=note>These terms should not be confused with <dfn
   id=vertical-block-flow>vertical block flow</dfn> (which is a downard or
   upward block flow) and <dfn id=horizontal-block-flow>horizontal block
   flow</dfn> (which is leftward or rightward block flow). To avoid
   confusion, this specification avoids the latter set. </span>

  <h2 id=text-direction><span class=secno>3. </span>Inline Direction and
   Bidirectionality</h2>

  <p>While the characters in most scripts are written from left to right,
   certain scripts are written from right to left. In some documents, in
   particular those written with the Arabic or Hebrew script, and in some
   mixed-language contexts, text in a single (visually displayed) block may
   appear with mixed directionality. This phenomenon is called <span
   class=index-def id=bidirectionality title="bidirectionality (bidi)"><dfn
   id=bidirectionality0>bidirectionality</dfn></span>, or "bidi" for short.

  <p>The Unicode standard (<a
   href="http://www.unicode.org/reports/tr9/">Unicode Standard Annex #9</a>)
   defines a complex algorithm for determining the proper directionality of
   text. The algorithm consists of an implicit part based on character
   properties, as well as explicit controls for embeddings and overrides. CSS
   relies on this algorithm to achieve proper bidirectional rendering. The
   <span class=propinst-direction>&lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo;</span> and <span
   class=propinst-unicode-bidi>&lsquo;<a href="#unicode-bidi0"><code
   class=property>unicode-bidi</code></a>&rsquo;</span> properties allow
   authors to specify how the elements and attributes of a document language
   map to this algorithm.

  <p>User agents that support bidirectional text must apply the Unicode
   bidirectional algorithm to every sequence of inline boxes uninterrupted by
   a forced line break or block boundary. This sequence forms the "paragraph"
   unit in the bidirectional algorithm. The paragraph embedding level is set
   according to the value of the <span class=propinst-direction>&lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;</span>
   property of the containing block rather than by the heuristic given in
   steps P2 and P3 of the Unicode algorithm.

  <p>Because the directionality of a text depends on the structure and
   semantics of the document language, these properties should in most cases
   be used only by designers of document type descriptions (Dtds), or authors
   of special documents. If a default style sheet specifies these properties,
   authors and users should not specify rules to override them.

  <p>The HTML 4 specification (<a href="#HTML401"
   rel=biblioentry>[HTML401]<!--{{HTML401}}--></a>, section 8.2) defines
   bidirectionality behavior for HTML elements. The style sheet rules that
   would achieve the bidi behaviors specified in <a href="#HTML401"
   rel=biblioentry>[HTML401]<!--{{HTML401}}--></a> are given below. The HTML
   4 specification also contains more information on bidirectionality issues.

  <pre>
*[dir="ltr"]    { direction: ltr; unicode-bidi: embed; }
*[dir="rtl"]    { direction: rtl; unicode-bidi: embed; }

bdo[dir="ltr"]  { direction: ltr; unicode-bidi: bidi-override; }
bdo[dir="rtl"]  { direction: rtl; unicode-bidi: bidi-override; }
  </pre>

  <p class=note>Because HTML UAs can turn off CSS styling, we advise HTML
   authors to use the HTML &lsquo;<code class=property>dir</code>&rsquo;
   property and &lt;bdo&gt; element to ensure correct bidirectional layout in
   the absence of a style sheet.

  <h3 id=direction><span class=secno>3.1. </span>Specifying Directionality:
   the &lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo; property</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=direction0>direction</dfn>

    <tr>
     <th>Value:

     <td>ltr | rtl

    <tr>
     <th>Initial:

     <td>ltr

    <tr>
     <th>Applies to:

     <td>all elements

    <tr>
     <th>Inherited:

     <td>yes

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>specified value
  </table>

  <p>This property specifies the inline progression of text and elements on a
   line, and the direction of embeddings and overrides (see <span
   class=propinst-unicode-bidi>&lsquo;<a href="#unicode-bidi0"><code
   class=property>unicode-bidi</code></a>&rsquo;</span>) for the Unicode
   bidirectional algorithm. In addition, it specifies the direction of <a
   href="http://www.w3.org/TR/CSS21/tables.html">table</a> column layout, the
   direction of horizontal <a
   href="http://www.w3.org/TR/CSS21/visufx.html#overflow">overflow</a>, and
   the position of an incomplete last line in a block in case of &lsquo;<code
   class=css>text-align: justify</code>&rsquo;.

  <p>Values for this property have the following meanings:

  <dl>
   <dt><strong>ltr</strong>

   <dd>Left-to-right direction.

   <dt><strong>rtl</strong>

   <dd> Right-to-left direction.
  </dl>

  <p>For the <span class=propinst-direction>&lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;</span>
   property to affect reordering in inline-level elements, the <span
   class=propinst-unicode-bidi>&lsquo;<a href="#unicode-bidi0"><code
   class=property>unicode-bidi</code></a>&rsquo;</span> property's value must
   be &lsquo;<code class=property>embed</code>&rsquo; or &lsquo;<code
   class=property>override</code>&rsquo;.

  <p class=note>The <span class=propinst-direction>&lsquo;<a
   href="#direction0"><code class=property>direction</code></a>&rsquo;</span>
   property, when specified for table column elements, is not inherited by
   cells in the column since columns are not the ancestors of the cells in
   the document tree. Thus, CSS cannot easily capture the "dir" attribute
   inheritance rules described in <a href="#HTML401"
   rel=biblioentry>[HTML401]<!--{{HTML401}}--></a>, section 11.3.2.1.

  <h3 id=unicode-bidi><span class=secno>3.2. </span>Embeddings and Overrides:
   the &lsquo;<code class=property>uncode-bidi</code>&rsquo; property</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=unicode-bidi0>unicode-bidi</dfn>

    <tr>
     <th>Value:

     <td>normal | embed | ( isolate || ( plaintext | override )

    <tr>
     <th>Initial:

     <td>normal

    <tr>
     <th>Applies to:

     <td>all elements, but see prose

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>specified value
  </table>

  <p>Values for this property have the following meanings:

  <dl>
   <dt><strong>normal</strong>

   <dd>The element does not open an additional level of embedding with
    respect to the bidirectional algorithm. For inline-level elements,
    implicit reordering works across element boundaries.

   <dt><strong>embed</strong>

   <dd>If the element is inline-level, this value opens an additional level
    of embedding with respect to the bidirectional algorithm. The direction
    of this embedding level is given by the <span
    class=propinst-direction>&lsquo;<a href="#direction0"><code
    class=property>direction</code></a>&rsquo;</span> property. Inside the
    element, reordering is done implicitly. This corresponds to adding a LRE
    (U+202A; for &lsquo;<code class=css>direction: ltr</code>&rsquo;) or RLE
    (U+202B; for &lsquo;<code class=css>direction: rtl</code>&rsquo;) at the
    start of the element and a PDF (U+202C) at the end of the element.

   <dt><strong>bidi-override</strong>

   <dd>For inline-level elements this creates an override. For block-level,
    table-cell, table-caption, or inline-block elements this creates an
    override for inline-level descendants not within another block-level,
    table-cell, table-caption, or inline-block element. This means that
    inside the element, reordering is strictly in sequence according to the
    <span class=propinst-direction>&lsquo;<a href="#direction0"><code
    class=property>direction</code></a>&rsquo;</span> property; the implicit
    part of the bidirectional algorithm is ignored. This corresponds to
    adding a LRO (U+202D; for &lsquo;<code class=css>direction:
    ltr</code>&rsquo;) or RLO (U+202E; for &lsquo;<code class=css>direction:
    rtl</code>&rsquo;) at the start of the element and a PDF (U+202C) at the
    end of the element.

   <dt><strong>isolate</strong>

   <dd>For the purposes of the Unicode bidirectional algorithm, the contents
    of the element are considered to be inside a separate, independent
    paragraph, and for the purpose of bidi resolution in its containing
    paragraph (if any), the element itself is treated as if it were an Object
    Replacement Character (U+FFFC). (If the element is broken across multiple
    lines, then each box of the element is treated as an Object Replacement
    Character.)

   <dt><strong>plaintext</strong>

   <dd>For the purposes of the Unicode bidirectional algorithm, the base
    directionality of each "paragraph" for which the element is the
    containing block element is determined not by the element's computed
    &lsquo;<a href="#direction0"><code
    class=property>direction</code></a>&rsquo; as usual, but by following
    rules P1, P2, and P3 of the Unicode bidirectional algorithm.
  </dl>

  <p>The final order of characters in each block-level element is the same as
   if the bidi control codes had been added as described above, markup had
   been stripped, and the resulting character sequence had been passed to an
   implementation of the Unicode bidirectional algorithm for plain text that
   produced the same line-breaks as the styled text. In this process,
   non-textual entities such as images are treated as neutral characters,
   unless their <span class=propinst-unicode-bidi>&lsquo;<a
   href="#unicode-bidi0"><code
   class=property>unicode-bidi</code></a>&rsquo;</span> property has a value
   other than &lsquo;<code class=property>normal</code>&rsquo;, in which case
   they are treated as strong characters in the <span
   class=propinst-direction>&lsquo;<a href="#direction0"><code
   class=property>direction</code></a>&rsquo;</span> specified for the
   element.

  <p>Please note that in order to be able to flow inline boxes in a uniform
   direction (either entirely left-to-right or entirely right-to-left), more
   inline boxes (including anonymous inline boxes) may have to be created,
   and some inline boxes may have to be split up and reordered before
   flowing.

  <p>Because the Unicode algorithm has a limit of <em title="According to
   unicode 3.0, chapter 3, section 12, definition BD2. Specifically, page 58
   here: http://www.unicode.org/unicode/uni2book/ch03.pdf"> 61 levels</em> of
   embedding, care should be taken not to use <span
   class=propinst-unicode-bidi>&lsquo;<a href="#unicode-bidi0"><code
   class=property>unicode-bidi</code></a>&rsquo;</span> with a value other
   than &lsquo;<code class=property>normal</code>&rsquo; unless appropriate.
   In particular, a value of &lsquo;<code
   class=property>inherit</code>&rsquo; should be used with extreme caution.
   However, for elements that are, in general, intended to be displayed as
   blocks, a setting of &lsquo;<code class=css>unicode-bidi:
   embed</code>&rsquo; is preferred to keep the element together in case
   display is changed to inline (see example below).

  <p>The following example shows an XML document with bidirectional text. It
   illustrates an important design principle: <span class=index-inst id=dtd
   title=Dtd>Dtd</span> designers should take bidi into account both in the
   language proper (elements and attributes) and in any accompanying style
   sheets. The style sheets should be designed so that bidi rules are
   separate from other style rules. The bidi rules should not be overridden
   by other style sheets so that the document language's or Dtd's bidi
   behavior is preserved.

  <h3 id=bidi-example><span class=secno>3.3. </span>Example of Bidirectional
   Text</h3>

  <div class=example>
   <p>In this example, lowercase letters stand for inherently left-to-right
    characters and uppercase letters represent inherently right-to-left
    characters. The text stream is shown in logical backing store order.</p>

   <pre class=xml-example><code class=xml>
&lt;HEBREW&gt;
  &lt;PAR&gt;HEBREW1 HEBREW2 english3 HEBREW4 HEBREW5&lt;/PAR&gt;
  &lt;PAR&gt;HEBREW6 &lt;EMPH&gt;HEBREW7&lt;/EMPH&gt; HEBREW8&lt;/PAR&gt;
&lt;/HEBREW&gt;
&lt;ENGLISH&gt;
  &lt;PAR&gt;english9 english10 english11 HEBREW12 HEBREW13&lt;/PAR&gt;
  &lt;PAR&gt;english14 english15 english16&lt;/PAR&gt;
  &lt;PAR&gt;english17 &lt;HE-QUO&gt;HEBREW18 english19 HEBREW20&lt;/HE-QUO&gt;&lt;/PAR&gt;
&lt;/ENGLISH&gt;
    </code></pre>

   <p>Since this is XML, the style sheet is responsible for setting the
    writing direction. This is the style sheet:</p>

   <pre class=example>
/* Rules for bidi */
HEBREW, HE-QUO  {direction: rtl; unicode-bidi: embed;}
ENGLISH         {direction: ltr; unicode-bidi: embed;} 

/* Rules for presentation */
HEBREW, ENGLISH, PAR  {display: block;}
EMPH                  {font-weight: bold;}
    </pre>

   <p>The HEBREW element is a block with a right-to-left base direction, the
    ENGLISH element is a block with a left-to-right base direction. The PARs
    are blocks that inherit the base direction from their parents. Thus, the
    first two PARs are read starting at the top right, the final three are
    read starting at the top left. Please note that HEBREW and ENGLISH are
    chosen as element names for explicitness only; in general, element names
    should convey structure without reference to language.</p>

   <p>The EMPH element is inline-level, and since its value for <span
    class=propinst-unicode-bidi>&lsquo;<a href="#unicode-bidi0"><code
    class=property>unicode-bidi</code></a>&rsquo;</span> is &lsquo;<code
    class=property>normal</code>&rsquo; (the initial value), it has no effect
    on the ordering of the text. The HE-QUO element, on the other hand,
    creates an embedding.</p>

   <p>The formatting of this text might look like this if the line length is
    long:</p>

   <pre class=ascii-art>
               5WERBEH 4WERBEH english3 2WERBEH 1WERBEH

                                8WERBEH <b>7WERBEH</b> 6WERBEH

english9 english10 english11 13WERBEH 12WERBEH

english14 english15 english16

english17 20WERBEH english19 18WERBEH
    </pre>

   <p>Note that the HE-QUO embedding causes HEBREW18 to be to the right of
    english19.</p>

   <p>If lines have to be broken, it might be more like this:</p>

   <pre class=ascii-art>
       2WERBEH 1WERBEH
  -EH 4WERBEH english3
                 5WERB

   -EH <b>7WERBEH</b> 6WERBEH
                 8WERB

english9 english10 en-
glish11 12WERBEH
13WERBEH

english14 english15
english16

english17 18WERBEH
20WERBEH english19
    </pre>

   <p>Because HEBREW18 must be read before english19, it is on the line above
    english19. Just breaking the long line from the earlier formatting would
    not have worked. Note also that the first syllable from english19 might
    have fit on the previous line, but hyphenation of left-to-right words in
    a right-to-left context, and vice versa, is usually suppressed to avoid
    having to display a hyphen in the middle of a line.</p>
  </div>
  <!-- example -->

  <h2 id=block-flow><span class=secno>4. </span>Block Flow Direction: the
   &lsquo;<a href="#block-flow1"><code
   class=property>block-flow</code></a>&rsquo; property</h2>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=block-flow1>block-flow</dfn>

    <tr>
     <th>Value:

     <td>tb | rl | lr | bt

    <tr>
     <th>Initial:

     <td>tb

    <tr>
     <th>Applies to:

     <td><span class=issue>??</span>

    <tr>
     <th>Inherited:

     <td>yes

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>specified value
  </table>
  <!--<p class="issue">Should we change the name to something more understandable?
    "block-flow"? "block-direction"? We need to make sure terminology for
    inline progression and block progression ("layout" vs "flow" vs "orientation"
    vs "direction", "horizontal" vs "vertical") is consistent throughout the
    document as well.)</p>-->

  <p>This property sets the block-flow direction. Possible values:

  <dl>
   <dt>tb

   <dd>Top-to-bottom block flow. The writing mode is horizontal.

   <dt>rl

   <dd>Right-to-left block flow. The writing mode is vertical.

   <dt>lr

   <dd>Left-to-right block flow. The writing mode is vertical.

   <dt>bt

   <dd>Bottom-to-top block flow. The writing mode is horizontal.
  </dl>

  <p class=issue>Would
   <code>downward</code>/<code>leftward</code>/<code>rightward</code>/<code>upward</code>
   be better value names?

  <p>An inline element that has a different &lsquo;<a
   href="#block-flow1"><code class=property>block-flow</code></a>&rsquo; from
   its containing block becomes an &lsquo;<code
   class=property>inline-block</code>&rsquo; element <a href="#CSS3-box"
   rel=biblioentry>[CSS3-box]</a>. <span class=issue>switch to CSS2.1</span>

  <h3 id=details><span class=secno>4.1. </span>Details</h3>

  <p>Box layout in vertical writing modes is exactly analogous to layout in
   the horizontal writing modes.

  <ul>
   <li>Calculations that refer to &lsquo;<code
    class=property>width</code>&rsquo; use &lsquo;<code
    class=property>height</code>&rsquo; instead, and vice versa.

   <li>Calculations that refer to the &lsquo;<code
    class=css>*-left</code>&rsquo; and &lsquo;<code
    class=css>*-right</code>&rsquo; box properties (border, margin, padding,
    outline) use &lsquo;<code class=css>*-top</code>&rsquo; and &lsquo;<code
    class=css>*-bottom</code>&rsquo; instead, and vice versa. In RL layout
    &lsquo;<code class=css>*-right</code>&rsquo; is analogous to TB's
    &lsquo;<code class=css>*-top</code>&rsquo;; in LR layout &lsquo;<code
    class=css>*-left</code>&rsquo; is analogous to TB's &lsquo;<code
    class=css>*-top</code>&rsquo;. The logic for this is clear if you lock an
    arrow representing the TB block flow to a compass of the four directions
    and rotate it to represent RL and LR flow.

   <li>Layout effects that depend on the directionality to choose between
    left and right (e.g. overflow, overconstraint resolution, &lsquo;<code
    class=property>start</code>&rsquo; values for &lsquo;<code
    class=property>text-align</code>&rsquo; and other properties, table
    column ordering) depend instead on the effective physical directionality
    (top-to-bottom or bottom-to-top) to choose between top and bottom.
  </ul>

  <p>When an element has a different &lsquo;<a href="#block-flow1"><code
   class=property>block-flow</code></a>&rsquo; from its containing block two
   cases are possible: <em class=issue>These descriptions need work</em>

  <ul>
   <li>The two block flows are perpendicular to each other. (For example,
    &lsquo;<code class=property>tb</code>&rsquo; and &lsquo;<code
    class=property>lr</code>&rsquo;). In such cases, <span class=issue>detail
    calculation of width/height and determination of containing block
    dim</span>

   <li>The two block-flows are parallel to each other. (For example,
    &lsquo;<code class=property>rl</code>&rsquo; and &lsquo;<code
    class=property>lr</code>&rsquo;).
  </ul>

  <h3 id=example><span class=secno>4.2. </span>Example</h3>

  <div class=example>
   <p>In the following example, two blocks elements (1 and 3) separated by an
    image (2) are presented in various flow writing modes.</p>

   <p>Here is a diagram of horizontal writing mode (<code>block-flow:
    tb</code>):</p>

   <p><img alt="Diagram of horizontal layout: blocks 1, 2, and 3 are stacked
    top-to-bottom" height=300 src=horizontal.png width=219></p>

   <p>Here is a diagram for the right-to-left vertical writing mode commonly
    used in East Asia (<code>block-flow: rl</code>):</p>

   <p><img alt="Diagram of a right-to-left vertical layout: blocks 1, 2, and
    3 are arranged side by side from right to left" height=191
    src=vertical-rl.png width=297></p>

   <p>And finally, here is a diagram for the left-to-right vertical writing
    mode used for Uighur and Mongolian (<code>block-flow: lr</code>):</p>

   <p><img alt="Diagram of left-to-right vertical layout: blocks 1, 2, and 3
    are arranged side by side from left to right" height=191
    src=vertical-lr.png width=300></p>
  </div>

  <h3 id=writing-mode><span class=secno>4.3. </span>The &lsquo;<a
   href="#writing-mode1"><code class=property>writing-mode</code></a>&rsquo;
   shorthand property</h3>

  <table class=propdef id=name->
   <tbody>
    <tr>
     <td><em>Name:</em>

     <td><dfn id=writing-mode1>writing-mode</dfn>

    <tr>
     <td><em>Value:</em>

     <td>lr-tb | rl-tb | tb-rl | bt-rl | tb-lr | bt-lr

    <tr>
     <td><em>Initial:</em>

     <td>not defined for shorthand properties

    <tr>
     <td><em>Applies to:</em>

     <td>all elements and generated content

    <tr>
     <td><em>Inherited:</em>

     <td>yes

    <tr>
     <td><em>Percentages:</em>

     <td>N/A

    <tr>
     <td><em>Media:</em>

     <td>visual

    <tr>
     <td><em>Computed value:</em>

     <td>see individual properties
  </table>

  <p>The <span class=property><a href="#writing-mode">&lsquo;<code
   class=property>writing-mode</code>&rsquo;</a></span> property is a
   shorthand property for the <span class=property><a
   href="#direction">&lsquo;<code
   class=property>direction</code>&rsquo;</a></span> property and the <span
   class=property> <a href="#block-flow">&lsquo;<code
   class=property>block-flow</code>&rsquo;</a></span> property. Although
   strictly speaking, the property has no initial value, it is equivalent to
   &lsquo;<code class=property>lr-tb</code>&rsquo;. The definition of the
   property values are established by the following table, which shows the
   setting of the constituent properties and example of common usage.

  <div class=figure>
   <table border=1 cellpadding=0 cellspacing=0 style="border-collapse:
    collapse" width="100%">
    <tbody>
     <tr>
      <th>writing-mode:

      <th>direction:

      <th>block-flow:

      <th>Common Usage:

     <tr>
      <td>lr-tb

      <td>ltr

      <td>tb

      <td>Latin-based, Greek, Cyrillic writing systems (and many others)

     <tr>
      <td>rl-tb

      <td>rtl

      <td>tb

      <td>Arabic, Hebrew writing systems

     <tr>
      <td>tb-rl

      <td>ltr

      <td>rl

      <td>East Asian writing systems in vertical mode

     <tr>
      <td>bt-rl

      <td>rtl

      <td>rl

      <td>Arabic script block quote embedded in East Asian vertical text

     <tr>
      <td>tb-lr

      <td>ltr

      <td>lr

      <td>Mongolian script writing system

     <tr>
      <td>bt-lr

      <td>rtl

      <td>lr

      <td>Arabic script block quote embedded in Mongolian script document
   </table>
  </div>

  <h3 id=writing-mode-mixed><span class=secno>4.4. </span>Mixing the
   &lsquo;<a href="#writing-mode1"><code
   class=property>writing-mode</code></a>&rsquo; in normal usage</h3>

  <p>In East Asian documents, it is often preferred to display certain
   Latin-based strings, such as numerals in a year, always in a horizontal
   layout orientation regardless of the flow orientation of the line of text
   these strings appear in, as in:

  <div class=figure>
   <p><img alt="Diagram of Tate Naka Yoko, showing a group of glyphs
    appearing horizontally in a vertical column of text" class=example
    height=170 src=lf-tny.gif width=90> <img alt="Example of Tate Naka Yoko,
    showing the year 1996 appearing horizontally in a column of vertical
    text" class=example height=132 src=tny.gif width=37>

   <p>Horizontal in vertical ("<span lang=ja>Tate-chu-yoko</span>")
  </div>

  <p>In Japanese, this effect is known as <a href="#tatechuyoko"
   lang=ja>"Tate-chu-yoko"</a>. In order to achieve it in a CSS document, the
   Latin string should be enclosed in an inline element with a horizontal
   writing mode, as in:

  <pre>.date {block-flow: tb;}
<!--    -->&lt;span class=&quot;date&quot;&gt;1996&lt;/span&gt;</pre>

  <h2 id=logical-directional><span class=secno>5. </span>Logical directional
   properties and values</h2>

  <h3 id=logical-terminology><span class=secno>5.1. </span>Terminology</h3>

  <p>In this section we use the following terminology about directional
   properties:

  <dl>
   <dt>logical properties

   <dd>the properties regarding the direction relative to the writing-mode
    (e.g., margin-before)

   <dt>physical properties

   <dd>the properties regarding the physical direction (e.g., margin-top)

   <dt>corresponding properties

   <dd>the pair of a logical property and its corresponding physical
    property.
  </dl>

  <p>The sides of a box are designated as follows:

  <dl>
   <dt>before side

   <dd>the side occurring first in the block direction (=top side in lr-tb
    writing-mode)

   <dt>after side

   <dd>the side opposite the before side (=bottom side in lr-tb writing-mode)

   <dt>start side

   <dd>the side occurring first in the inline direction (=left side in lr-tb
    writing-mode)

   <dt>end side

   <dd>the side opposite the start side (=right side in lr-tb writing-mode)
  </dl>

  <p>The dimensions of a box are designated as follows:

  <dl>
   <dt>logical width

   <dt>

   <dd>the dimension in the inline direction (=width in horizontal
    writing-mode; height in vertical writing-mode)

   <dt>logical height

   <dt>

   <dd>the dimension in the block direction (=height in horizontal
    writing-mode; width in vertical writing-mode)
  </dl>

  <div class=example>
   <p>An English (LTR-TB) block:</p>

   <pre class=ascii-art>
                  &lt;---- width / logical width ---&gt;

                             top side/
                            before side
                  +------------------------------+                  A
      left side/  |   ---inline direction --->   |  right side/     |
      start side  |  |                           |  end side        |
                  |  | block      * horizontal * |                height/
                  |  | direction  *writing mode* |            logical height
                  |  V                           |                  |
                  +------------------------------+                  V
                             bottom side/
                              after side
    </pre>
  </div>

  <div class=example>
   <p>A vertical Japanese block (TTB-RL):</p>

   <pre class=ascii-art>
                  &lt;--- width / logical height ---&gt;

                             top side/
                            start side
                  +------------------------------+                  A
      left side/  |    &lt;---block direction---    |  right side/     |
      after side  |                           |  |  before side     |
                  |  *  vertical  *     inline|  |                height/
                  |  *writing mode*  direction|  |             logical width
                  |                           V  |                  |
                  +------------------------------+                  V
                            bottom side/
                             end side
    </pre>
  </div>

  <h3 id=logical-prop><span class=secno>5.2. </span>Logical properties:
   &lsquo;<a href="#margin-before"><code
   class=property>margin-before</code></a>&rsquo;, &lsquo;<a
   href="#logical-width"><code
   class=property>logical-width</code></a>&rsquo;, etc.</h3>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=margin-before>margin-before</dfn>, <dfn
      id=margin-after>margin-after</dfn>, <dfn
      id=margin-start>margin-start</dfn>, <dfn id=margin-end>margin-end</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;length&gt;</var> | <var>&lt;percentage&gt;</var> | auto

    <tr>
     <th>Initial:

     <td>0

    <tr>
     <th>Applies to:

     <td>same as &lsquo;<code class=property>margin</code>&rsquo;

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>logical-width of containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>the percentage as specified or the absolute length or &lsquo;<code
      class=property>auto</code>&rsquo; (see text)
  </table>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=padding-before>padding-before</dfn>, <dfn
      id=padding-after>padding-after</dfn>, <dfn
      id=padding-start>padding-start</dfn>, <dfn
      id=padding-end>padding-end</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;length&gt;</var> | <var>&lt;percentage&gt;</var>

    <tr>
     <th>Initial:

     <td>0

    <tr>
     <th>Applies to:

     <td>all elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>logical-width of containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>&lt;length&gt; (see text)
  </table>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=border-before-width>border-before-width</dfn>, <dfn
      id=border-after-width>border-after-width</dfn>, <dfn
      id=border-start-width>border-start-width</dfn>, <dfn
      id=border-end-width>border-end-width</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;border-width&gt;</var>

    <tr>
     <th>Initial:

     <td>medium

    <tr>
     <th>Applies to:

     <td>all elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>logical-width of containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>absolute length; &lsquo;<code class=css>0</code>&rsquo; if the
      border style is &lsquo;<code class=property>none</code>&rsquo; or
      &lsquo;<code class=property>hidden</code>&rsquo; (see text)
  </table>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=border-before-style>border-before-style</dfn>, <dfn
      id=border-after-style>border-after-style</dfn>, <dfn
      id=border-start-style>border-start-style</dfn>, <dfn
      id=border-end-style>border-end-style</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;border-style&gt;</var>

    <tr>
     <th>Initial:

     <td>none

    <tr>
     <th>Applies to:

     <td>all elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>specified value (see text)
  </table>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=border-before-color>border-before-color</dfn>, <dfn
      id=border-after-color>border-after-color</dfn>, <dfn
      id=border-start-color>border-start-color</dfn>, <dfn
      id=border-end-color>border-end-color</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;color&gt;</var>

    <tr>
     <th>Initial:

     <td>currentcolor

    <tr>
     <th>Applies to:

     <td>all elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>the computed color (see text)
  </table>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=border-before>border-before</dfn>, <dfn
      id=border-after>border-after</dfn>, <dfn
      id=border-start>border-start</dfn>, <dfn id=border-end>border-end</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;border-width&gt;</var> || <var>&lt;border-style&gt;</var>
      || <var>&lt;color&gt;</var>

    <tr>
     <th>Initial:

     <td>(see individual properties)

    <tr>
     <th>Applies to:

     <td>all elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>see individual properties

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>see individual properties
  </table>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=logical-width>logical-width</dfn>, <dfn
      id=logical-height>logical-height</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;length&gt;</var> | <var>&lt;percentage&gt;</var> | auto

    <tr>
     <th>Initial:

     <td>auto

    <tr>
     <th>Applies to:

     <td>same as &lsquo;<code class=property>width</code>&rsquo; and
      &lsquo;<code class=property>height</code>&rsquo;

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>logical-width, resp. logical-height of containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>the percentage as specified or the absolute length or &lsquo;<code
      class=property>auto</code>&rsquo; (see text)
  </table>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=min-logical-width>min-logical-width</dfn>, <dfn
      id=min-logical-height>min-logical-height</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;length&gt;</var> | <var>&lt;percentage&gt;</var>

    <tr>
     <th>Initial:

     <td>0

    <tr>
     <th>Applies to:

     <td>same as &lsquo;<code class=property>width</code>&rsquo; and
      &lsquo;<code class=property>height</code>&rsquo;

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>logical-width, resp. logical-height of containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>the percentage as specified or the absolute length (see text)
  </table>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=max-logical-width>max-logical-width</dfn>, <dfn
      id=max-logical-height>max-logical-height</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;length&gt;</var> | <var>&lt;percentage&gt;</var> | none

    <tr>
     <th>Initial:

     <td>none

    <tr>
     <th>Applies to:

     <td>same as &lsquo;<code class=property>width</code>&rsquo; and
      &lsquo;<code class=property>height</code>&rsquo;

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>logical-width, resp. logical-height of containing block

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&#160;value:

     <td>the percentage as specified or the absolute length or &lsquo;<code
      class=property>none</code>&rsquo; (see text)
  </table>

  <p>These properties are writing-mode relative (logical) equivalents of the
   corresponding physical properties.

  <p>The mappings of logical properties into physical properties are as
   follows:

  <p>

  <div class=figure>
   <table border=1 cellpadding=0 cellspacing=0 style="border-collapse:
    collapse" width="100%">
    <tbody>
     <tr>
      <th rowspan=2>logical properties

      <th colspan=6>corresponding physical properties for each writing-mode

     <tr>
      <th>lr-tb

      <th>rl-tb

      <th>tb-rl

      <th>bt-rl

      <th>tb-lr

      <th>bt-lr

     <tr>
      <td>margin-before

      <td>margin-top

      <td>margin-top

      <td>margin-right

      <td>margin-right

      <td>margin-left

      <td>margin-left

     <tr>
      <td>margin-after

      <td>margin-bottom

      <td>margin-bottom

      <td>margin-left

      <td>margin-left

      <td>margin-right

      <td>margin-right

     <tr>
      <td>margin-start

      <td>margin-left

      <td>margin-right

      <td>margin-top

      <td>margin-bottom

      <td>margin-top

      <td>margin-bottom

     <tr>
      <td>margin-end

      <td>margin-right

      <td>margin-left

      <td>margin-bottom

      <td>margin-top

      <td>margin-bottom

      <td>margin-top

     <tr>
      <td>padding-*, border-*

      <td colspan=6>(similar with margin-*)

     <tr>
      <td>logical-width

      <td colspan=2>width

      <td colspan=4>height

     <tr>
      <td>logical-height

      <td colspan=2>height

      <td colspan=4>width

     <tr>
      <td>min-logical-width

      <td colspan=2>min-width

      <td colspan=4>min-height

     <tr>
      <td>min-logical-height

      <td colspan=2>min-height

      <td colspan=4>min-width

     <tr>
      <td>max-logical-width

      <td colspan=2>max-width

      <td colspan=4>max-height

     <tr>
      <td>max-logical-height

      <td colspan=2>max-height

      <td colspan=4>max-width
   </table>
  </div>

  <p>The computed value of a logical property affects the computed value of
   the corresponding physical property, and vice versa.

  <p>For example, if the writing-mode of the element is lr-tb, the computed
   value of the &lsquo;<a href="#margin-before"><code
   class=property>margin-before</code></a>&rsquo; overrides the &lsquo;<code
   class=property>margin-top</code>&rsquo;.

  <p>If both logical and physical properties are specified on the same
   element, these corresponding properties are treated as same property and
   then normal cascading rules are applied.

  <p>The writing-mode value of the element is used for the mapping of
   corresponding properties and therefore must be evaluated first.

  <h3 id=logical-value><span class=secno>5.3. </span>Logical property values:
   before, after, start, end</h3>

  <p>Properties that accept physical directional values (top, bottom, left,
   right), should also accept logical directional values (before, after,
   start, end). In such case, the logical values are treated as corresponding
   physical values. The writing-mode value of the element is used for the the
   mapping of logical into physical values and therefore must be evaluated
   first.

  <p>The following properties (but not limited to) are applicable to this
   case:

  <ul>
   <li>&lsquo;<code class=property>float</code>&rsquo;

   <li>&lsquo;<code class=property>clear</code>&rsquo;

   <li>&lsquo;<code class=property>background-position</code>&rsquo;

   <li>&lsquo;<code class=property>text-align</code>&rsquo;
  </ul>
